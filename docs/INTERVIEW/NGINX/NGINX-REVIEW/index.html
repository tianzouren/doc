<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-NGINX/NGINX-REVIEW" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">NGINX-REVIEW | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/doc/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/doc/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/doc/docs/INTERVIEW/NGINX/NGINX-REVIEW"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="NGINX-REVIEW | My Site"><meta data-rh="true" name="description" content="NGINX-REVIEW"><meta data-rh="true" property="og:description" content="NGINX-REVIEW"><link data-rh="true" rel="icon" href="/doc/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/doc/docs/INTERVIEW/NGINX/NGINX-REVIEW"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/doc/docs/INTERVIEW/NGINX/NGINX-REVIEW" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/doc/docs/INTERVIEW/NGINX/NGINX-REVIEW" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"NGINX-REVIEW","item":"https://your-docusaurus-site.example.com/doc/docs/INTERVIEW/NGINX/NGINX-REVIEW"}]}</script><link rel="alternate" type="application/rss+xml" href="/doc/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/doc/blog/atom.xml" title="My Site Atom Feed"><link rel="stylesheet" href="/doc/assets/css/styles.8d5b4fe0.css">
<script src="/doc/assets/js/runtime~main.76c25152.js" defer="defer"></script>
<script src="/doc/assets/js/main.2ba6fd96.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/doc/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/doc/"><div class="navbar__logo"><img src="/doc/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/doc/img/logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/doc/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/doc/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/doc/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Expand sidebar category &#x27;Tutorial - Basics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/doc/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Expand sidebar category &#x27;Tutorial - Extras&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/doc/docs/JAVA/">java</a><button aria-label="Expand sidebar category &#x27;java&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/doc/docs/INTERVIEW/MQ">MQ</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/doc/docs/INTERVIEW/MYSQL/MYSQL-REVIEW">MYSQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/doc/docs/INTERVIEW/NGINX/NGINX-REVIEW">NGINX</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/doc/docs/INTERVIEW/NGINX/NGINX-REVIEW">NGINX-REVIEW</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/doc/docs/intereview/redis">REDIS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/doc/docs/INTERVIEW/SPRING/SPRING-REVIEW">SPRING</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/doc/docs/tmp">tmp</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/doc/docs/INTERVIEW/分布式/分布式-REVIEW">分布式</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/doc/docs/INTERVIEW/微服务/微服务-REVIEW">微服务</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/doc/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">NGINX</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">NGINX-REVIEW</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>NGINX-REVIEW</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="️-一基础用法">⚙️ 一、基础用法<a href="#️-一基础用法" class="hash-link" aria-label="Direct link to ⚙️ 一、基础用法" title="Direct link to ⚙️ 一、基础用法">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="安装与基本操作">安装与基本操作<a href="#安装与基本操作" class="hash-link" aria-label="Direct link to 安装与基本操作" title="Direct link to 安装与基本操作">​</a></h3>
<p>启动：sudo systemctl start nginx
停止：sudo systemctl stop nginx
重启：sudo systemctl restart nginx
重新加载配置（不中断服务）：sudo systemctl reload nginx或 nginx -s reload(
这个命令在面试中经常被问到，因为它允许在线更新配置而不重启服务)
检查配置语法：nginx -t(在修改配置文件后，务必先运行此命令检查语法是否正确，避免配置错误导致服务无法启动)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置文件结构">配置文件结构<a href="#配置文件结构" class="hash-link" aria-label="Direct link to 配置文件结构" title="Direct link to 配置文件结构">​</a></h3>
<p>Nginx 的配置文件通常位于 /etc/nginx/nginx.conf，其结构清晰，主要分为几个块：</p>
<ul>
<li>全局块 (main)：配置影响 Nginx 全局的指令，如用户、worker 进程数（worker_processes）、错误日志等。</li>
<li>事件块 (events)：配置网络连接相关的参数，如每个 worker 进程的最大连接数（worker_connections）、使用的网络模型（如 use
epoll;）。</li>
<li>HTTP 块 (http)：这是配置的主要部分，包含大多数 HTTP 相关配置，如 MIME 类型、日志格式、服务器块 (server) 等。</li>
<li>服务器块 (server)：用于配置虚拟主机，一个 HTTP 块中可以包含多个 server 块，每个 server 块可以理解为一个虚拟主机。</li>
<li>位置块 (location)：位于 server 块内部，用于匹配特定的 URI（请求路径），并定义如何处理匹配到的请求（如返回静态文件、代理到后端应用等）。这是
Nginx 配置中非常灵活和强大的部分。
一个简单的配置示例看起来是这样的：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">user nginx;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">worker_processes auto;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">error_log /var/log/nginx/error.log;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">worker_connections 1024;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">include /etc/nginx/mime.types;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_type application/octet-stream;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        server_name example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        root /var/www/html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="静态资源服务">静态资源服务<a href="#静态资源服务" class="hash-link" aria-label="Direct link to 静态资源服务" title="Direct link to 静态资源服务">​</a></h3>
<p>Nginx 非常适合处理静态文件（如 HTML、CSS、JS、图片），效率很高。基本配置就是在 location 块中指定 root（文件根目录）或
alias（目录别名）。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server_name example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#定义服务器根目录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    root / var / www / example.com / html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index index.html index.htm;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        #尝试按顺序访问文件、目录，否则返回404</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    try_files $uri $uri / = 404;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<ol start="4">
<li>虚拟主机 (Server Blocks)
通过配置多个 server块，可以在单台 Nginx 服务器上运行多个网站（虚拟主机），通过不同的 server_name（域名）来区分。</li>
</ol>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server_name site1.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    root / var / www / site1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    server_name site2.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    root / var / www / site2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="反向代理">反向代理<a href="#反向代理" class="hash-link" aria-label="Direct link to 反向代理" title="Direct link to 反向代理">​</a></h3>
<p>这是 Nginx 非常核心的功能，将客户端请求转发到后端应用服务器（如 Tomcat, Node.js, Django
等），并将响应返回给客户端。这样可以隐藏后端服务器信息、实现负载均衡等。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server_name proxy.example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # 代理到后端服务器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_pass http://localhost:3000;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # 设置传递给后端服务器的HTTP头信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header Host $host;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header X-Real-IP $remote_addr;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="进阶用法">进阶用法<a href="#进阶用法" class="hash-link" aria-label="Direct link to 进阶用法" title="Direct link to 进阶用法">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="负载均衡">负载均衡<a href="#负载均衡" class="hash-link" aria-label="Direct link to 负载均衡" title="Direct link to 负载均衡">​</a></h3>
<p>当你的应用有多个后端服务器时，Nginx 可以将请求分发到这些服务器上，避免单点压力过大，提高系统的可用性和处理能力。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 定义一组后端服务器，命名为backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">upstream backend {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 列出后端服务器，可以配置权重(weight)、备份(backup)等</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server backend1.example.com weight=5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server backend2.example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server backend3.example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server backup.backend.example.com backup;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 将请求代理到上面定义的backend组</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proxy_pass http://backend;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Nginx 支持多种负载均衡策略，如轮询（默认）、权重（weight）、IP 哈希（ip_hash，保证同一客户端访问同一后端）等。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="性能优化">性能优化<a href="#性能优化" class="hash-link" aria-label="Direct link to 性能优化" title="Direct link to 性能优化">​</a></h3>
<ul>
<li>启用零拷贝 (Zero-Copy)：使用 sendfile on;传输静态文件，减少内核态与用户态之间的数据拷贝，提升传输效率。
Gzip 压缩：压缩响应内容，减少网络传输量。</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gzip on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_types text/plain text/css application/json application/javascript;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ul>
<li>调整工作进程与连接数：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">worker_processes auto; # 通常设置为CPU核心数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">worker_rlimit_nofile 100000; # 提高每个worker进程可打开的文件描述符数量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">worker_connections 4096; # 每个worker进程的最大连接数</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">multi_accept on;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li>缓存静态资源：通过设置 expires头，让浏览器缓存静态资源。</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expires 365d; # 缓存一年</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">add_header Cache-Control &quot;public, no-transform&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">access_log off; # 关闭日志记录，减少磁盘IO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li>安全与访问控制:
隐藏 Nginx 版本号：防止泄露敏感信息，server_tokens off;。
基于 IP 的访问控制：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location /admin {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">allow 192.168.1.0/24;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">deny all;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li>基本身份验证：</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location /secure {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_basic &quot;Restricted Area&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_basic_user_file /etc/nginx/.htpasswd;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<ul>
<li>限制请求速率（限流）：防止恶意请求或DDoS攻击。</li>
</ul>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit_req_zone $binary_remote_addr zone=api_limit:10m rate=100r/s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">location /api/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit_req zone=api_limit burst=200 nodelay;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proxy_pass http://backend;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="https-配置">HTTPS 配置<a href="#https-配置" class="hash-link" aria-label="Direct link to HTTPS 配置" title="Direct link to HTTPS 配置">​</a></h3>
<p>为网站启用加密的 HTTPS 访问已成为标准做法。</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen 443 ssl;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server_name example.com;</span><br></span></code></pre></div></div>
<h1>指定SSL证书和密钥文件路径</h1>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssl_certificate /etc/ssl/certs/example.com.crt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_certificate_key /etc/ssl/private/example.com.key;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssl_protocols TLSv1.2 TLSv1.3; # 使用安全的TLS协议</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    location / {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        root /var/www/example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        index index.html;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h1>将HTTP请求重定向到HTTPS</h1>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">listen 80;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server_name example.com;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">return 301 https://$host$request_uri;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>高可用性 (High Availability)
为了保证 Nginx 本身不成为单点故障，通常会在多台服务器上部署 Nginx，并采用 Keepalived 等工具实现虚拟 IP (VIP) 漂移，当主
Nginx 宕机时，备用 Nginx 会自动接管 VIP，继续提供服务。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="review-基础概念">review-基础概念<a href="#review-基础概念" class="hash-link" aria-label="Direct link to review-基础概念" title="Direct link to review-基础概念">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nginx-是什么它有哪些优点">Nginx 是什么？它有哪些优点？<a href="#nginx-是什么它有哪些优点" class="hash-link" aria-label="Direct link to Nginx 是什么？它有哪些优点？" title="Direct link to Nginx 是什么？它有哪些优点？">​</a></h3>
<p>Nginx 是一个高性能的 HTTP 和反向代理服务器，以高并发、低内存消耗和高可靠性著称。它的优点包括：事件驱动的异步非阻塞模型（如
epoll）处理海量连接、轻量级、优秀的静态内容处理能力、强大的负载均衡和反向代理功能</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="正向代理和反向代理的区别">正向代理和反向代理的区别？<a href="#正向代理和反向代理的区别" class="hash-link" aria-label="Direct link to 正向代理和反向代理的区别？" title="Direct link to 正向代理和反向代理的区别？">​</a></h3>
<p>正向代理：代理客户端，代表客户端访问服务器（如 VPN、科学上网工具），服务器不知道客户端的真实存在。
反向代理：代理服务器，代表服务器接收客户端的请求，客户端不知道后端有哪些服务器。Nginx 通常作为反向代理</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nginx-的-master-worker-架构是怎样的有什么好处">Nginx 的 Master-Worker 架构是怎样的？有什么好处？<a href="#nginx-的-master-worker-架构是怎样的有什么好处" class="hash-link" aria-label="Direct link to Nginx 的 Master-Worker 架构是怎样的？有什么好处？" title="Direct link to Nginx 的 Master-Worker 架构是怎样的？有什么好处？">​</a></h3>
<p>Nginx 有一个 Master 进程（主进程）和多个 Worker 进程（工作进程）。
Master 进程：负责读取配置、管理 Worker 进程（如平滑重启、升级）。
Worker 进程：实际处理网络请求和业务逻辑。
好处：
高并发：多个 Worker 进程可同时处理请求，充分利用多核 CPU。
热升级：可以不中断服务的情况下更新 Nginx 二进制文件或配置。
健壮性：单个 Worker 进程崩溃不会影响整体服务，Master 进程可以快速重启一个新的 Worker。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="worker-进程如何获取请求任务">worker 进程如何获取请求任务？<a href="#worker-进程如何获取请求任务" class="hash-link" aria-label="Direct link to worker 进程如何获取请求任务？" title="Direct link to worker 进程如何获取请求任务？">​</a></h4>
<p>这意味着，当一个新的网络连接请求到来时，所有Worker进程会被通知，但只有一个Worker能成功“抢到”这个连接。这种设计避免了著名的“惊群效应”（Thundering
Herd Problem），即所有Worker都被同时唤醒去争抢一个资源，造成不必要的CPU竞争和性能损耗
⚙️ 影响分配的相关配置
虽然分配机制本身是自动的，但你可以通过调整一些参数来优化Nginx的性能和行为：</p>
<p>1.worker_processes:
这定义了Nginx启动的Worker进程数量。通常建议将其设置为与服务器CPU核心数相同，以充分利用多核性能。你可以设置为具体数字（如
worker_processes 4;）或使用 auto参数让Nginx自动检测。
配置示例：worker_processes auto;
2.worker_connections:
这个指令设置在events块中，定义了每个Worker进程能够同时处理的最大连接数。Nginx能处理的总最大连接数是 worker_processes和
worker_connections的乘积，但要注意这个值也受系统最大文件描述符限制的限制。
配置示例：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    worker_connections 10240; # 每个worker最多处理10240个连接</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>3.accept_mutex:
这个指令用于启用或禁用上面提到的互斥锁机制。在现代版本的Nginx中，它通常是默认启用的（on），一般不需要手动修改。
配置示例：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accept_mutex on; # 启用互斥锁</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>4.multi_accept:
当设置为 on时，一旦某个Worker进程获得互斥锁，它可以一次性接受多个等待中的连接，而不是一次只接受一个。这在高并发场景下可以稍微提升效率，但可能会使各个Worker的负载不太均匀。默认是
off。
配置示例：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">events {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multi_accept on; # 一次接受多个连接</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="review-配置与原理">review-配置与原理<a href="#review-配置与原理" class="hash-link" aria-label="Direct link to review-配置与原理" title="Direct link to review-配置与原理">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nginx-如何处理一个-http-请求">Nginx 如何处理一个 HTTP 请求？<a href="#nginx-如何处理一个-http-请求" class="hash-link" aria-label="Direct link to Nginx 如何处理一个 HTTP 请求？" title="Direct link to Nginx 如何处理一个 HTTP 请求？">​</a></h3>
<p>Nginx 通过监听端口接收到请求后，会根据 listen和 server_name找到匹配的 server 块，再根据请求的 URI 匹配 location 块，最后执行该
location 块中定义的指令（如返回静态文件或代理到后端）。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="location-块的匹配优先级是怎样的">location 块的匹配优先级是怎样的？<a href="#location-块的匹配优先级是怎样的" class="hash-link" aria-label="Direct link to location 块的匹配优先级是怎样的？" title="Direct link to location 块的匹配优先级是怎样的？">​</a></h3>
<p>优先级从高到低：
=精确匹配（如 location = /static/）
^~前缀匹配（一旦匹配，不再检查正则）
~和 ~*正则匹配（区分大小写和不区分大小写）
普通前缀匹配（最长匹配优先）</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何实现动静分离为什么要这么做">如何实现动静分离？为什么要这么做？<a href="#如何实现动静分离为什么要这么做" class="hash-link" aria-label="Direct link to 如何实现动静分离？为什么要这么做？" title="Direct link to 如何实现动静分离？为什么要这么做？">​</a></h3>
<p>实现：通过配置不同的 location 块，将静态资源（如图片、CSS、JS）的请求由 Nginx 直接处理，动态请求（如 JSP、PHP）则代理到后端应用服务器。
目的：减轻后端应用服务器的负载，让它专注于处理动态逻辑；充分利用 Nginx 高效的静态文件处理能力。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nginx-常用负载均衡策略有哪些">Nginx 常用负载均衡策略有哪些？<a href="#nginx-常用负载均衡策略有哪些" class="hash-link" aria-label="Direct link to Nginx 常用负载均衡策略有哪些？" title="Direct link to Nginx 常用负载均衡策略有哪些？">​</a></h3>
<p>轮询 (round-robin)：默认方式，按时间顺序逐一分配。
权重 (weight)：根据权重分配，权重越高的服务器接收的请求越多。
IP 哈希 (ip_hash)：根据客户端 IP 计算哈希，保证同一 IP 的请求总是落到同一台后端服务器，可用于解决会话保持问题。
最少连接 (least_conn)：将请求发给当前连接数最少的后端服务器。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="review-性能与排查">review-性能与排查<a href="#review-性能与排查" class="hash-link" aria-label="Direct link to review-性能与排查" title="Direct link to review-性能与排查">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何优化-nginx-性能">如何优化 Nginx 性能？<a href="#如何优化-nginx-性能" class="hash-link" aria-label="Direct link to 如何优化 Nginx 性能？" title="Direct link to 如何优化 Nginx 性能？">​</a></h3>
<p>调整 worker_processes和 worker_connections。
启用 sendfile, tcp_nopush, tcp_nodelay。
开启 Gzip 压缩。
为静态资源设置浏览器缓存。
使用负载均衡。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="出现-502504-错误可能是什么原因如何排查">出现 502/504 错误可能是什么原因？如何排查？<a href="#出现-502504-错误可能是什么原因如何排查" class="hash-link" aria-label="Direct link to 出现 502/504 错误可能是什么原因？如何排查？" title="Direct link to 出现 502/504 错误可能是什么原因？如何排查？">​</a></h3>
<p>502 Bad Gateway：Nginx 无法连接到上游（upstream）服务器或上游服务器返回无效响应。排查：检查后端服务是否启动、运行正常。
504 Gateway Timeout：Nginx 在配置的时间内没有收到上游服务器的响应。排查：检查后端服务是否处理过慢或挂起，适当调整
proxy_read_timeout等超时设置。
通用排查：查看 Nginx 的 error.log日志文件，通常会有更详细的错误信息。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nginx-如何做限流">Nginx 如何做限流？<a href="#nginx-如何做限流" class="hash-link" aria-label="Direct link to Nginx 如何做限流？" title="Direct link to Nginx 如何做限流？">​</a></h3>
<p>使用 limit_req_zone和 limit_req指令进行请求速率限制，防止突发流量打垮服务。例如：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">location /login/ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">limit_req zone=mylimit burst=20 nodelay;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">proxy_pass http://backend;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>这表示每秒允许最多10个请求，突发延迟处理最多20个请求。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/doc/docs/tags/interview">INTERVIEW</a></li><li class="tag_QGVx"><a rel="tag" class="tag_zVej tagRegular_sFm0" href="/doc/docs/tags/nginx">NGINX</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/NGINX/nginx-review.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/doc/docs/MYSQL/mysql常见命令查询"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">mysql常见命令查询</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/doc/docs/intereview/redis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">REDIS_REVIEW</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#️-一基础用法" class="table-of-contents__link toc-highlight">⚙️ 一、基础用法</a><ul><li><a href="#安装与基本操作" class="table-of-contents__link toc-highlight">安装与基本操作</a></li><li><a href="#配置文件结构" class="table-of-contents__link toc-highlight">配置文件结构</a></li><li><a href="#静态资源服务" class="table-of-contents__link toc-highlight">静态资源服务</a></li><li><a href="#反向代理" class="table-of-contents__link toc-highlight">反向代理</a></li></ul></li><li><a href="#进阶用法" class="table-of-contents__link toc-highlight">进阶用法</a><ul><li><a href="#负载均衡" class="table-of-contents__link toc-highlight">负载均衡</a></li><li><a href="#性能优化" class="table-of-contents__link toc-highlight">性能优化</a></li><li><a href="#https-配置" class="table-of-contents__link toc-highlight">HTTPS 配置</a></li></ul></li><li><a href="#review-基础概念" class="table-of-contents__link toc-highlight">review-基础概念</a><ul><li><a href="#nginx-是什么它有哪些优点" class="table-of-contents__link toc-highlight">Nginx 是什么？它有哪些优点？</a></li><li><a href="#正向代理和反向代理的区别" class="table-of-contents__link toc-highlight">正向代理和反向代理的区别？</a></li><li><a href="#nginx-的-master-worker-架构是怎样的有什么好处" class="table-of-contents__link toc-highlight">Nginx 的 Master-Worker 架构是怎样的？有什么好处？</a></li></ul></li><li><a href="#review-配置与原理" class="table-of-contents__link toc-highlight">review-配置与原理</a><ul><li><a href="#nginx-如何处理一个-http-请求" class="table-of-contents__link toc-highlight">Nginx 如何处理一个 HTTP 请求？</a></li><li><a href="#location-块的匹配优先级是怎样的" class="table-of-contents__link toc-highlight">location 块的匹配优先级是怎样的？</a></li><li><a href="#如何实现动静分离为什么要这么做" class="table-of-contents__link toc-highlight">如何实现动静分离？为什么要这么做？</a></li><li><a href="#nginx-常用负载均衡策略有哪些" class="table-of-contents__link toc-highlight">Nginx 常用负载均衡策略有哪些？</a></li></ul></li><li><a href="#review-性能与排查" class="table-of-contents__link toc-highlight">review-性能与排查</a><ul><li><a href="#如何优化-nginx-性能" class="table-of-contents__link toc-highlight">如何优化 Nginx 性能？</a></li><li><a href="#出现-502504-错误可能是什么原因如何排查" class="table-of-contents__link toc-highlight">出现 502/504 错误可能是什么原因？如何排查？</a></li><li><a href="#nginx-如何做限流" class="table-of-contents__link toc-highlight">Nginx 如何做限流？</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/doc/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/doc/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>