"use strict";(self.webpackChunkdoc=self.webpackChunkdoc||[]).push([[6150],{1646:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/JAVA\u5185\u5b58\u6a21\u578b1-710eda8cdee93a020458255063e9c861.png"},2891:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>s,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"JAVA/JAVA-JUC","title":"JAVA-JUC","description":"JAVA-JUC","source":"@site/docs/JAVA/java-concurrent.md","sourceDirName":"JAVA","slug":"/INTERVIEW/JAVA/JAVA-JUC","permalink":"/doc/docs/INTERVIEW/JAVA/JAVA-JUC","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/JAVA/java-concurrent.md","tags":[{"inline":true,"label":"INTERVIEW","permalink":"/doc/docs/tags/interview"},{"inline":true,"label":"JAVA","permalink":"/doc/docs/tags/java"},{"inline":true,"label":"JUC","permalink":"/doc/docs/tags/juc"}],"version":"current","frontMatter":{"id":"JAVA-JUC","title":"JAVA-JUC","description":"JAVA-JUC","slug":"/INTERVIEW/JAVA/JAVA-JUC","tags":["INTERVIEW","JAVA","JUC"]},"sidebar":"tutorialSidebar","previous":{"title":"JAVA-COLLECTION","permalink":"/doc/docs/INTERVIEW/JAVA/JAVA-COLLECTION"},"next":{"title":"JAVA-JVM","permalink":"/doc/docs/INTERVIEW/JAVA/JVM"}}');var t=r(74848),i=r(28453);const l={id:"JAVA-JUC",title:"JAVA-JUC",description:"JAVA-JUC",slug:"/INTERVIEW/JAVA/JAVA-JUC",tags:["INTERVIEW","JAVA","JUC"]},c=void 0,s={},d=[{value:"\u57fa\u7840",id:"\u57fa\u7840",level:2},{value:"\u4f60\u662f\u5982\u4f55\u7406\u89e3\u7ebf\u7a0b\u5b89\u5168\u7684\uff1f",id:"\u4f60\u662f\u5982\u4f55\u7406\u89e3\u7ebf\u7a0b\u5b89\u5168\u7684",level:3},{value:"\ud83c\udf1f\u8bf4\u8bf4\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u7684\u533a\u522b\uff1f",id:"\u8bf4\u8bf4\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u7684\u533a\u522b",level:3},{value:"\u5982\u4f55\u7406\u89e3\u534f\u7a0b\uff1f",id:"\u5982\u4f55\u7406\u89e3\u534f\u7a0b",level:3},{value:"\u7ebf\u7a0b\u95f4\u662f\u5982\u4f55\u8fdb\u884c\u901a\u4fe1\u7684\uff1f",id:"\u7ebf\u7a0b\u95f4\u662f\u5982\u4f55\u8fdb\u884c\u901a\u4fe1\u7684",level:3},{value:"\ud83c\udf1f\u8bf4\u8bf4\u7ebf\u7a0b\u6709\u51e0\u79cd\u521b\u5efa\u65b9\u5f0f\uff1f",id:"\u8bf4\u8bf4\u7ebf\u7a0b\u6709\u51e0\u79cd\u521b\u5efa\u65b9\u5f0f",level:3},{value:"\u4e00\u4e2a 8G \u5185\u5b58\u7684\u7cfb\u7edf\u6700\u591a\u80fd\u521b\u5efa\u591a\u5c11\u4e2a\u7ebf\u7a0b?",id:"\u4e00\u4e2a-8g-\u5185\u5b58\u7684\u7cfb\u7edf\u6700\u591a\u80fd\u521b\u5efa\u591a\u5c11\u4e2a\u7ebf\u7a0b",level:3},{value:"\u542f\u52a8\u4e00\u4e2a Java \u7a0b\u5e8f\uff0c\u4f60\u80fd\u8bf4\u8bf4\u91cc\u9762\u6709\u54ea\u4e9b\u7ebf\u7a0b\u5417\uff1f",id:"\u542f\u52a8\u4e00\u4e2a-java-\u7a0b\u5e8f\u4f60\u80fd\u8bf4\u8bf4\u91cc\u9762\u6709\u54ea\u4e9b\u7ebf\u7a0b\u5417",level:3},{value:"\ud83c\udf1f\u8c03\u7528 start \u65b9\u6cd5\u65f6\u4f1a\u6267\u884c run \u65b9\u6cd5\uff0c\u90a3\u600e\u4e48\u4e0d\u76f4\u63a5\u8c03\u7528 run\u65b9\u6cd5\uff1f",id:"\u8c03\u7528-start-\u65b9\u6cd5\u65f6\u4f1a\u6267\u884c-run-\u65b9\u6cd5\u90a3\u600e\u4e48\u4e0d\u76f4\u63a5\u8c03\u7528-run\u65b9\u6cd5",level:3},{value:"\u7ebf\u7a0b\u6709\u54ea\u4e9b\u5e38\u7528\u7684\u8c03\u5ea6\u65b9\u6cd5\uff1f",id:"\u7ebf\u7a0b\u6709\u54ea\u4e9b\u5e38\u7528\u7684\u8c03\u5ea6\u65b9\u6cd5",level:3},{value:"\u8bf4\u8bf4wait\u65b9\u6cd5\u548cnotify\u65b9\u6cd5\uff1f",id:"\u8bf4\u8bf4wait\u65b9\u6cd5\u548cnotify\u65b9\u6cd5",level:3},{value:"\u8bf4\u8bf4 sleep \u65b9\u6cd5\uff1f",id:"\u8bf4\u8bf4-sleep-\u65b9\u6cd5",level:3},{value:"\u8bf4\u8bf4yield\u65b9\u6cd5\uff1f",id:"\u8bf4\u8bf4yield\u65b9\u6cd5",level:3},{value:"\u8bf4\u8bf4interrupt\u65b9\u6cd5\uff1f",id:"\u8bf4\u8bf4interrupt\u65b9\u6cd5",level:3},{value:"\u8bf4\u8bf4 stop \u65b9\u6cd5\uff1f",id:"\u8bf4\u8bf4-stop-\u65b9\u6cd5",level:3},{value:"\ud83c\udf1f\u7ebf\u7a0b\u6709\u51e0\u79cd\u72b6\u6001\uff1f",id:"\u7ebf\u7a0b\u6709\u51e0\u79cd\u72b6\u6001",level:3},{value:"\u5982\u4f55\u5f3a\u5236\u7ec8\u6b62\u7ebf\u7a0b\uff1f",id:"\u5982\u4f55\u5f3a\u5236\u7ec8\u6b62\u7ebf\u7a0b",level:3},{value:"\u4ec0\u4e48\u662f\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\uff1f",id:"\u4ec0\u4e48\u662f\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362",level:3},{value:"\u7ebf\u7a0b\u53ef\u4ee5\u88ab\u591a\u6838\u8c03\u5ea6\u5417\uff1f",id:"\u7ebf\u7a0b\u53ef\u4ee5\u88ab\u591a\u6838\u8c03\u5ea6\u5417",level:3},{value:"\u5b88\u62a4\u7ebf\u7a0b\u4e86\u89e3\u5417\uff1f",id:"\u5b88\u62a4\u7ebf\u7a0b\u4e86\u89e3\u5417",level:3},{value:"\u5b88\u62a4\u7ebf\u7a0b\u548c\u7528\u6237\u7ebf\u7a0b\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f",id:"\u5b88\u62a4\u7ebf\u7a0b\u548c\u7528\u6237\u7ebf\u7a0b\u6709\u4ec0\u4e48\u533a\u522b\u5462",level:3},{value:"\u7ebf\u7a0b\u95f4\u6709\u54ea\u4e9b\u901a\u4fe1\u65b9\u5f0f\uff1f",id:"\u7ebf\u7a0b\u95f4\u6709\u54ea\u4e9b\u901a\u4fe1\u65b9\u5f0f",level:3},{value:"\u7b80\u5355\u8bf4\u8bf4 volatile \u548c synchronized \u7684\u4f7f\u7528\u65b9\u5f0f\uff1f",id:"\u7b80\u5355\u8bf4\u8bf4-volatile-\u548c-synchronized-\u7684\u4f7f\u7528\u65b9\u5f0f",level:3},{value:"wait() \u548c notify() \u65b9\u6cd5\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417\uff1f",id:"wait-\u548c-notify-\u65b9\u6cd5\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417",level:3},{value:"Exchanger \u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417\uff1f",id:"exchanger-\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417",level:3},{value:"CompletableFuture \u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417\uff1f",id:"completablefuture-\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417",level:3},{value:"\ud83c\udf1f\u8bf7\u8bf4\u8bf4 sleep \u548c wait \u7684\u533a\u522b\uff1f\uff08\u8865\u5145\uff09",id:"\u8bf7\u8bf4\u8bf4-sleep-\u548c-wait-\u7684\u533a\u522b\u8865\u5145",level:3},{value:"\ud83c\udf1f\u600e\u4e48\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\uff1f\uff08\u8865\u5145\uff09",id:"\u600e\u4e48\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u8865\u5145",level:3},{value:"\u573a\u666f:\u6709\u4e00\u4e2a key \u5bf9\u5e94\u7684 value \u662f\u4e00\u4e2ajson \u7ed3\u6784\uff0cjson \u5f53\u4e2d\u6709\u597d\u51e0\u4e2a\u5b50\u4efb\u52a1\uff0c\u8fd9\u4e9b\u5b50\u4efb\u52a1\u5982\u679c\u5bf9 key \u8fdb\u884c\u4fee\u6539\u7684\u8bdd\uff0c\u4f1a\u4e0d\u4f1a\u5b58\u5728\u7ebf\u7a0b\u5b89\u5168\u7684\u95ee\u9898\uff1f",id:"\u573a\u666f\u6709\u4e00\u4e2a-key-\u5bf9\u5e94\u7684-value-\u662f\u4e00\u4e2ajson-\u7ed3\u6784json-\u5f53\u4e2d\u6709\u597d\u51e0\u4e2a\u5b50\u4efb\u52a1\u8fd9\u4e9b\u5b50\u4efb\u52a1\u5982\u679c\u5bf9-key-\u8fdb\u884c\u4fee\u6539\u7684\u8bdd\u4f1a\u4e0d\u4f1a\u5b58\u5728\u7ebf\u7a0b\u5b89\u5168\u7684\u95ee\u9898",level:3},{value:"\u8bf4\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u4f7f\u7528\u573a\u666f\uff1f",id:"\u8bf4\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u4f7f\u7528\u573a\u666f",level:3},{value:"\u80fd\u8bf4\u4e00\u4e0b Hashtable \u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u5417\uff1f",id:"\u80fd\u8bf4\u4e00\u4e0b-hashtable-\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u5417",level:3},{value:"ThreadLocal",id:"threadlocal",level:2},{value:"\ud83c\udf1fThreadLocal \u662f\u4ec0\u4e48\uff1f",id:"threadlocal-\u662f\u4ec0\u4e48",level:3},{value:"ThreadLocal \u6709\u54ea\u4e9b\u4f18\u70b9\uff1f",id:"threadlocal-\u6709\u54ea\u4e9b\u4f18\u70b9",level:3},{value:"\u4f60\u5728\u5de5\u4f5c\u4e2d\u7528\u5230\u8fc7 ThreadLocal \u5417\uff1f",id:"\u4f60\u5728\u5de5\u4f5c\u4e2d\u7528\u5230\u8fc7-threadlocal-\u5417",level:3},{value:"\ud83c\udf1fThreadLocal \u600e\u4e48\u5b9e\u73b0\u7684\u5462\uff1f",id:"threadlocal-\u600e\u4e48\u5b9e\u73b0\u7684\u5462",level:3},{value:"\u4ec0\u4e48\u662f\u5f31\u5f15\u7528\uff0c\u4ec0\u4e48\u662f\u5f3a\u5f15\u7528\uff1f",id:"\u4ec0\u4e48\u662f\u5f31\u5f15\u7528\u4ec0\u4e48\u662f\u5f3a\u5f15\u7528",level:3},{value:"\ud83c\udf1fThreadLocal \u5185\u5b58\u6cc4\u9732\u662f\u600e\u4e48\u56de\u4e8b\uff1f",id:"threadlocal-\u5185\u5b58\u6cc4\u9732\u662f\u600e\u4e48\u56de\u4e8b",level:3},{value:"\u90a3\u4e3a\u4ec0\u4e48 key \u8981\u8bbe\u8ba1\u6210\u5f31\u5f15\u7528\uff1f",id:"\u90a3\u4e3a\u4ec0\u4e48-key-\u8981\u8bbe\u8ba1\u6210\u5f31\u5f15\u7528",level:3},{value:"\u4f60\u4e86\u89e3\u54ea\u4e9b ThreadLocal \u7684\u6539\u8fdb\u65b9\u6848\uff1f",id:"\u4f60\u4e86\u89e3\u54ea\u4e9b-threadlocal-\u7684\u6539\u8fdb\u65b9\u6848",level:3},{value:"ThreadLocalMap \u7684\u6e90\u7801\u770b\u8fc7\u5417\uff1f",id:"threadlocalmap-\u7684\u6e90\u7801\u770b\u8fc7\u5417",level:3},{value:"ThreadLocalMap \u600e\u4e48\u89e3\u51b3 Hash \u51b2\u7a81\u7684\uff1f",id:"threadlocalmap-\u600e\u4e48\u89e3\u51b3-hash-\u51b2\u7a81\u7684",level:3},{value:"\u5f00\u653e\u5730\u5740\u6cd5\u4e86\u89e3\u5417\uff1f",id:"\u5f00\u653e\u5730\u5740\u6cd5\u4e86\u89e3\u5417",level:3},{value:"ThreadLocalMap \u6269\u5bb9\u673a\u5236\u4e86\u89e3\u5417\uff1f",id:"threadlocalmap-\u6269\u5bb9\u673a\u5236\u4e86\u89e3\u5417",level:3},{value:"\u7236\u7ebf\u7a0b\u80fd\u7528 ThreadLocal \u7ed9\u5b50\u7ebf\u7a0b\u4f20\u503c\u5417\uff1f",id:"\u7236\u7ebf\u7a0b\u80fd\u7528-threadlocal-\u7ed9\u5b50\u7ebf\u7a0b\u4f20\u503c\u5417",level:3},{value:"Java \u5185\u5b58\u6a21\u578b",id:"java-\u5185\u5b58\u6a21\u578b",level:2},{value:"\ud83c\udf1f\u8bf4\u4e00\u4e0b\u4f60\u5bf9 Java \u5185\u5b58\u6a21\u578b\u7684\u7406\u89e3\uff1f",id:"\u8bf4\u4e00\u4e0b\u4f60\u5bf9-java-\u5185\u5b58\u6a21\u578b\u7684\u7406\u89e3",level:3},{value:"\u4e3a\u4ec0\u4e48\u7ebf\u7a0b\u8981\u7528\u81ea\u5df1\u7684\u5185\u5b58\uff1f",id:"\u4e3a\u4ec0\u4e48\u7ebf\u7a0b\u8981\u7528\u81ea\u5df1\u7684\u5185\u5b58",level:3},{value:"i++\u662f\u539f\u5b50\u64cd\u4f5c\u5417\uff1f",id:"i\u662f\u539f\u5b50\u64cd\u4f5c\u5417",level:3},{value:"\u8bf4\u8bf4\u4f60\u5bf9\u539f\u5b50\u6027\u3001\u53ef\u89c1\u6027\u3001\u6709\u5e8f\u6027\u7684\u7406\u89e3\uff1f",id:"\u8bf4\u8bf4\u4f60\u5bf9\u539f\u5b50\u6027\u53ef\u89c1\u6027\u6709\u5e8f\u6027\u7684\u7406\u89e3",level:4},{value:"\u8bf4\u8bf4\u4ec0\u4e48\u662f\u6307\u4ee4\u91cd\u6392\uff1f",id:"\u8bf4\u8bf4\u4ec0\u4e48\u662f\u6307\u4ee4\u91cd\u6392",level:3},{value:"happens-before \u4e86\u89e3\u5417\uff1f",id:"happens-before-\u4e86\u89e3\u5417",level:3},{value:"as-if-serial \u4e86\u89e3\u5417\uff1f",id:"as-if-serial-\u4e86\u89e3\u5417",level:3},{value:"\ud83c\udf1fvolatile \u4e86\u89e3\u5417\uff1f",id:"volatile-\u4e86\u89e3\u5417",level:3},{value:"volatile \u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\u7684\uff1f",id:"volatile-\u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\u7684",level:4},{value:"volatile \u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027\u7684\uff1f",id:"volatile-\u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027\u7684",level:3},{value:"volatile \u548c synchronized \u7684\u533a\u522b\uff1f",id:"volatile-\u548c-synchronized-\u7684\u533a\u522b",level:3},{value:"volatile \u52a0\u5728\u57fa\u672c\u7c7b\u578b\u548c\u5bf9\u8c61\u4e0a\u7684\u533a\u522b\uff1f",id:"volatile-\u52a0\u5728\u57fa\u672c\u7c7b\u578b\u548c\u5bf9\u8c61\u4e0a\u7684\u533a\u522b",level:3},{value:"\u9501",id:"\u9501",level:2},{value:"synchronized \u7528\u8fc7\u5417\uff1f",id:"synchronized-\u7528\u8fc7\u5417",level:3},{value:"synchronized \u7684\u5b9e\u73b0\u539f\u7406\u4e86\u89e3\u5417\uff1f",id:"synchronized-\u7684\u5b9e\u73b0\u539f\u7406\u4e86\u89e3\u5417",level:3},{value:"\u4f60\u5bf9 Monitor \u4e86\u89e3\u591a\u5c11\uff1f",id:"\u4f60\u5bf9-monitor-\u4e86\u89e3\u591a\u5c11",level:3},{value:"synchronized \u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\uff1f",id:"synchronized-\u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027",level:3},{value:"synchronized \u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027\uff1f",id:"synchronized-\u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027",level:3},{value:"synchronized \u600e\u4e48\u5b9e\u73b0\u53ef\u91cd\u5165\u7684\u5462\uff1f",id:"synchronized-\u600e\u4e48\u5b9e\u73b0\u53ef\u91cd\u5165\u7684\u5462",level:3},{value:"\ud83c\udf1fsynchronized \u9501\u5347\u7ea7\u4e86\u89e3\u5417\uff1f",id:"synchronized-\u9501\u5347\u7ea7\u4e86\u89e3\u5417",level:3},{value:"\ud83c\udf1fsynchronized \u548c ReentrantLock \u7684\u533a\u522b\u4e86\u89e3\u5417\uff1f",id:"synchronized-\u548c-reentrantlock-\u7684\u533a\u522b\u4e86\u89e3\u5417",level:3},{value:"Lock \u4e86\u89e3\u5417\uff1f",id:"lock-\u4e86\u89e3\u5417",level:3},{value:"ReentrantLock \u7684 lock() \u65b9\u6cd5\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417\uff1f",id:"reentrantlock-\u7684-lock-\u65b9\u6cd5\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417",level:3},{value:"AQS \u4e86\u89e3\u591a\u5c11\uff1f",id:"aqs-\u4e86\u89e3\u591a\u5c11",level:3},{value:"AQS \u7684\u6e90\u7801\u9605\u8bfb\u8fc7\u5417\uff1f",id:"aqs-\u7684\u6e90\u7801\u9605\u8bfb\u8fc7\u5417",level:3},{value:"\ud83c\udf1f\u8bf4\u8bf4 ReentrantLock \u7684\u5b9e\u73b0\u539f\u7406\uff1f",id:"\u8bf4\u8bf4-reentrantlock-\u7684\u5b9e\u73b0\u539f\u7406",level:3},{value:"ReentrantLock \u600e\u4e48\u521b\u5efa\u516c\u5e73\u9501\uff1f",id:"reentrantlock-\u600e\u4e48\u521b\u5efa\u516c\u5e73\u9501",level:3},{value:"\u600e\u4e48\u521b\u5efa\u4e00\u4e2a\u975e\u516c\u5e73\u9501\u5462\uff1f",id:"\u600e\u4e48\u521b\u5efa\u4e00\u4e2a\u975e\u516c\u5e73\u9501\u5462",level:3},{value:"\u516c\u5e73\u9501\u7684\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417\uff1f",id:"\u516c\u5e73\u9501\u7684\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417",level:3},{value:"\ud83c\udf1fCAS \u4e86\u89e3\u591a\u5c11\uff1f",id:"cas-\u4e86\u89e3\u591a\u5c11",level:3},{value:"\u600e\u4e48\u4fdd\u8bc1 CAS \u7684\u539f\u5b50\u6027\uff1f",id:"\u600e\u4e48\u4fdd\u8bc1-cas-\u7684\u539f\u5b50\u6027",level:3},{value:"\u4ec0\u4e48\u662f ABA \u95ee\u9898\uff1f",id:"\u4ec0\u4e48\u662f-aba-\u95ee\u9898",level:3},{value:"\u81ea\u65cb\u5f00\u9500\u5927\u600e\u4e48\u89e3\u51b3\uff1f",id:"\u81ea\u65cb\u5f00\u9500\u5927\u600e\u4e48\u89e3\u51b3",level:3},{value:"Java \u6709\u54ea\u4e9b\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u65b9\u6cd5\uff1f",id:"java-\u6709\u54ea\u4e9b\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u65b9\u6cd5",level:3},{value:"\u539f\u5b50\u64cd\u4f5c\u7c7b\u4e86\u89e3\u591a\u5c11\uff1f",id:"\u539f\u5b50\u64cd\u4f5c\u7c7b\u4e86\u89e3\u591a\u5c11",level:3},{value:"AtomicInteger \u7684\u6e90\u7801\u8bfb\u8fc7\u5417\uff1f",id:"atomicinteger-\u7684\u6e90\u7801\u8bfb\u8fc7\u5417",level:3},{value:"\u7ebf\u7a0b\u6b7b\u9501\u4e86\u89e3\u5417\uff1f",id:"\u7ebf\u7a0b\u6b7b\u9501\u4e86\u89e3\u5417",level:3},{value:"\u6b7b\u9501\u53d1\u751f\u7684\u56db\u4e2a\u6761\u4ef6\u4e86\u89e3\u5417\uff1f",id:"\u6b7b\u9501\u53d1\u751f\u7684\u56db\u4e2a\u6761\u4ef6\u4e86\u89e3\u5417",level:3},{value:"\u8be5\u5982\u4f55\u907f\u514d\u6b7b\u9501\u5462\uff1f",id:"\u8be5\u5982\u4f55\u907f\u514d\u6b7b\u9501\u5462",level:3},{value:"\ud83c\udf1f\u6b7b\u9501\u95ee\u9898\u600e\u4e48\u6392\u67e5\u5462\uff1f",id:"\u6b7b\u9501\u95ee\u9898\u600e\u4e48\u6392\u67e5\u5462",level:3},{value:"\u804a\u804a\u7ebf\u7a0b\u540c\u6b65\u548c\u4e92\u65a5\uff1f\uff08\u8865\u5145\uff09",id:"\u804a\u804a\u7ebf\u7a0b\u540c\u6b65\u548c\u4e92\u65a5\u8865\u5145",level:3},{value:"\u5982\u4f55\u5b9e\u73b0\u540c\u6b65\u548c\u4e92\u65a5\uff1f",id:"\u5982\u4f55\u5b9e\u73b0\u540c\u6b65\u548c\u4e92\u65a5",level:3},{value:"\u9501\u8981\u89e3\u51b3\u54ea\u4e9b\u95ee\u9898\uff1f",id:"\u9501\u8981\u89e3\u51b3\u54ea\u4e9b\u95ee\u9898",level:3},{value:"\u8bf4\u8bf4\u81ea\u65cb\u9501\uff1f",id:"\u8bf4\u8bf4\u81ea\u65cb\u9501",level:3},{value:"\ud83c\udf1f\u804a\u804a\u60b2\u89c2\u9501\u548c\u4e50\u89c2\u9501\uff1f\uff08\u8865\u5145\uff09",id:"\u804a\u804a\u60b2\u89c2\u9501\u548c\u4e50\u89c2\u9501\u8865\u5145",level:3},{value:"\u5e76\u53d1\u5de5\u5177\u7c7b",id:"\u5e76\u53d1\u5de5\u5177\u7c7b",level:2},{value:"CountDownLatch \u4e86\u89e3\u5417\uff1f",id:"countdownlatch-\u4e86\u89e3\u5417",level:3},{value:"\u573a\u666f\u9898\uff1a\u5047\u5982\u8981\u67e510\u4e07\u591a\u6761\u6570\u636e\uff0c\u7528\u7ebf\u7a0b\u6c60\u5206\u621020\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\uff0c\u600e\u4e48\u505a\u5230\u7b49\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u67e5\u627e\u5b8c\u4e4b\u540e\uff0c\u5373\u6700\u540e\u4e00\u6761\u7ed3\u679c\u67e5\u627e\u7ed3\u675f\u4e86\uff0c\u624d\u8f93\u51fa\u7ed3\u679c\uff1f",id:"\u573a\u666f\u9898\u5047\u5982\u8981\u67e510\u4e07\u591a\u6761\u6570\u636e\u7528\u7ebf\u7a0b\u6c60\u5206\u621020\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\u600e\u4e48\u505a\u5230\u7b49\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u67e5\u627e\u5b8c\u4e4b\u540e\u5373\u6700\u540e\u4e00\u6761\u7ed3\u679c\u67e5\u627e\u7ed3\u675f\u4e86\u624d\u8f93\u51fa\u7ed3\u679c",level:3},{value:"CyclicBarrier \u4e86\u89e3\u5417\uff1f",id:"cyclicbarrier-\u4e86\u89e3\u5417",level:3},{value:"CyclicBarrier \u548c CountDownLatch \u6709\u4ec0\u4e48\u533a\u522b\uff1f",id:"cyclicbarrier-\u548c-countdownlatch-\u6709\u4ec0\u4e48\u533a\u522b",level:3},{value:"Semaphore \u4e86\u89e3\u5417\uff1f",id:"semaphore-\u4e86\u89e3\u5417",level:3},{value:"Exchanger \u4e86\u89e3\u5417\uff1f",id:"exchanger-\u4e86\u89e3\u5417",level:3},{value:"\ud83c\udf1f\u80fd\u8bf4\u4e00\u4e0b ConcurrentHashMap \u7684\u5b9e\u73b0\u5417\uff1f\uff08\u8865\u5145\uff09",id:"\u80fd\u8bf4\u4e00\u4e0b-concurrenthashmap-\u7684\u5b9e\u73b0\u5417\u8865\u5145",level:3},{value:"\u8bf4\u4e00\u4e0b JDK 7 \u4e2d ConcurrentHashMap \u7684\u5b9e\u73b0\u539f\u7406\uff1f",id:"\u8bf4\u4e00\u4e0b-jdk-7-\u4e2d-concurrenthashmap-\u7684\u5b9e\u73b0\u539f\u7406",level:3},{value:"\u8bf4\u4e00\u4e0b JDK 7 \u4e2d ConcurrentHashMap \u7684 put \u6d41\u7a0b\uff1f",id:"\u8bf4\u4e00\u4e0b-jdk-7-\u4e2d-concurrenthashmap-\u7684-put-\u6d41\u7a0b",level:3},{value:"\u8bf4\u4e00\u4e0b JDK 7 \u4e2d ConcurrentHashMap \u7684 get \u6d41\u7a0b\uff1f",id:"\u8bf4\u4e00\u4e0b-jdk-7-\u4e2d-concurrenthashmap-\u7684-get-\u6d41\u7a0b",level:3},{value:"\u8bf4\u4e00\u4e0b JDK 8 \u4e2d ConcurrentHashMap \u7684\u5b9e\u73b0\u539f\u7406\uff1f",id:"\u8bf4\u4e00\u4e0b-jdk-8-\u4e2d-concurrenthashmap-\u7684\u5b9e\u73b0\u539f\u7406",level:3},{value:"\u8bf4\u4e00\u4e0b JDK 8 \u4e2d ConcurrentHashMap \u7684 put \u6d41\u7a0b\uff1f",id:"\u8bf4\u4e00\u4e0b-jdk-8-\u4e2d-concurrenthashmap-\u7684-put-\u6d41\u7a0b",level:3},{value:"\u8bf4\u4e00\u4e0b JDK 8 \u4e2d ConcurrentHashMap \u7684 get \u6d41\u7a0b\uff1f",id:"\u8bf4\u4e00\u4e0b-jdk-8-\u4e2d-concurrenthashmap-\u7684-get-\u6d41\u7a0b",level:3},{value:"\u8bf4\u4e00\u4e0b HashMap \u548c ConcurrentHashMap \u7684\u533a\u522b\uff1f",id:"\u8bf4\u4e00\u4e0b-hashmap-\u548c-concurrenthashmap-\u7684\u533a\u522b",level:3},{value:"\u4f60\u9879\u76ee\u4e2d\u600e\u4e48\u4f7f\u7528 ConcurrentHashMap \u7684\uff1f",id:"\u4f60\u9879\u76ee\u4e2d\u600e\u4e48\u4f7f\u7528-concurrenthashmap-\u7684",level:3},{value:"\u8bf4\u4e00\u4e0b ConcurrentHashMap \u5bf9 HashMap \u7684\u6539\u8fdb\uff1f",id:"\u8bf4\u4e00\u4e0b-concurrenthashmap-\u5bf9-hashmap-\u7684\u6539\u8fdb",level:3},{value:"\u4e3a\u4ec0\u4e48 ConcurrentHashMap \u5728 JDK 1.7 \u4e2d\u8981\u7528 ReentrantLock\uff0c\u800c\u5728 JDK 1.8 \u8981\u7528 synchronized",id:"\u4e3a\u4ec0\u4e48-concurrenthashmap-\u5728-jdk-17-\u4e2d\u8981\u7528-reentrantlock\u800c\u5728-jdk-18-\u8981\u7528-synchronized",level:3},{value:"ConcurrentHashMap \u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\uff1f\uff08\u8865\u5145\uff09",id:"concurrenthashmap-\u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\u8865\u5145",level:3},{value:"\u4e3a\u4ec0\u4e48 ConcurrentHashMap \u6bd4 Hashtable \u6548\u7387\u9ad8\uff08\u8865\u5145\uff09",id:"\u4e3a\u4ec0\u4e48-concurrenthashmap-\u6bd4-hashtable-\u6548\u7387\u9ad8\u8865\u5145",level:3},{value:"\u80fd\u8bf4\u4e00\u4e0b CopyOnWriteArrayList \u7684\u5b9e\u73b0\u539f\u7406\u5417\uff1f\uff08\u8865\u5145\uff09",id:"\u80fd\u8bf4\u4e00\u4e0b-copyonwritearraylist-\u7684\u5b9e\u73b0\u539f\u7406\u5417\u8865\u5145",level:3},{value:"\u80fd\u8bf4\u4e00\u4e0b BlockingQueue \u5417\uff1f\uff08\u8865\u5145\uff09",id:"\u80fd\u8bf4\u4e00\u4e0b-blockingqueue-\u5417\u8865\u5145",level:3},{value:"\u963b\u585e\u961f\u5217\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f",id:"\u963b\u585e\u961f\u5217\u662f\u5982\u4f55\u5b9e\u73b0\u7684",level:3},{value:"\u7ebf\u7a0b\u6c60",id:"\u7ebf\u7a0b\u6c60",level:2},{value:"\ud83c\udf1f\u4ec0\u4e48\u662f\u7ebf\u7a0b\u6c60\uff1f",id:"\u4ec0\u4e48\u662f\u7ebf\u7a0b\u6c60",level:3},{value:"\u4f60\u5728\u9879\u76ee\u4e2d\u6709\u7528\u5230\u7ebf\u7a0b\u6c60\u5417\uff1f",id:"\u4f60\u5728\u9879\u76ee\u4e2d\u6709\u7528\u5230\u7ebf\u7a0b\u6c60\u5417",level:3},{value:"\ud83c\udf1f\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1f",id:"\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u7684\u5de5\u4f5c\u6d41\u7a0b",level:3},{value:"\ud83c\udf1f56.\u7ebf\u7a0b\u6c60\u7684\u4e3b\u8981\u53c2\u6570\u6709\u54ea\u4e9b\uff1f",id:"56\u7ebf\u7a0b\u6c60\u7684\u4e3b\u8981\u53c2\u6570\u6709\u54ea\u4e9b",level:3},{value:"\u80fd\u7b80\u5355\u8bf4\u4e00\u4e0b\u53c2\u6570\u4e4b\u95f4\u7684\u5173\u7cfb\u5417\uff1f",id:"\u80fd\u7b80\u5355\u8bf4\u4e00\u4e0b\u53c2\u6570\u4e4b\u95f4\u7684\u5173\u7cfb\u5417",level:3},{value:"\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e0d\u591f\u4f1a\u600e\u4e48\u8fdb\u884c\u5904\u7406\uff1f",id:"\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e0d\u591f\u4f1a\u600e\u4e48\u8fdb\u884c\u5904\u7406",level:3},{value:"\u4e3e\u4e2a\u4f8b\u5b50\u8bf4\u4e00\u4e0b\u8fd9\u4e9b\u53c2\u6570\u7684\u53d8\u5316\uff1f",id:"\u4e3e\u4e2a\u4f8b\u5b50\u8bf4\u4e00\u4e0b\u8fd9\u4e9b\u53c2\u6570\u7684\u53d8\u5316",level:3},{value:"\ud83c\udf1f\u7ebf\u7a0b\u6c60\u7684\u62d2\u7edd\u7b56\u7565\u6709\u54ea\u4e9b\uff1f",id:"\u7ebf\u7a0b\u6c60\u7684\u62d2\u7edd\u7b56\u7565\u6709\u54ea\u4e9b",level:3},{value:"\u7ebf\u7a0b\u6c60\u6709\u54ea\u51e0\u79cd\u963b\u585e\u961f\u5217\uff1f",id:"\u7ebf\u7a0b\u6c60\u6709\u54ea\u51e0\u79cd\u963b\u585e\u961f\u5217",level:3},{value:"\u7ebf\u7a0b\u6c60\u63d0\u4ea4 execute \u548c submit \u6709\u4ec0\u4e48\u533a\u522b\uff1f",id:"\u7ebf\u7a0b\u6c60\u63d0\u4ea4-execute-\u548c-submit-\u6709\u4ec0\u4e48\u533a\u522b",level:3},{value:"\u7ebf\u7a0b\u6c60\u600e\u4e48\u5173\u95ed\u77e5\u9053\u5417\uff1f",id:"\u7ebf\u7a0b\u6c60\u600e\u4e48\u5173\u95ed\u77e5\u9053\u5417",level:3},{value:"\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u6570\u5e94\u8be5\u600e\u4e48\u914d\u7f6e\uff1f",id:"\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u6570\u5e94\u8be5\u600e\u4e48\u914d\u7f6e",level:3},{value:"\u5982\u4f55\u77e5\u9053\u4f60\u8bbe\u7f6e\u7684\u7ebf\u7a0b\u6570\u591a\u4e86\u8fd8\u662f\u5c11\u4e86\uff1f",id:"\u5982\u4f55\u77e5\u9053\u4f60\u8bbe\u7f6e\u7684\u7ebf\u7a0b\u6570\u591a\u4e86\u8fd8\u662f\u5c11\u4e86",level:3},{value:"\u6709\u54ea\u51e0\u79cd\u5e38\u89c1\u7684\u7ebf\u7a0b\u6c60\uff1f",id:"\u6709\u54ea\u51e0\u79cd\u5e38\u89c1\u7684\u7ebf\u7a0b\u6c60",level:3},{value:"\u80fd\u8bf4\u4e00\u4e0b\u56db\u79cd\u5e38\u89c1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\u5417\uff1f",id:"\u80fd\u8bf4\u4e00\u4e0b\u56db\u79cd\u5e38\u89c1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\u5417",level:3},{value:"\u8bf4\u8bf4\u56fa\u5b9a\u5927\u5c0f\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\uff1f",id:"\u8bf4\u8bf4\u56fa\u5b9a\u5927\u5c0f\u7ebf\u7a0b\u6c60\u7684\u539f\u7406",level:3},{value:"\u8bf4\u8bf4\u7f13\u5b58\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\uff1f",id:"\u8bf4\u8bf4\u7f13\u5b58\u7ebf\u7a0b\u6c60\u7684\u539f\u7406",level:3},{value:"\u8bf4\u8bf4\u5b9a\u65f6\u4efb\u52a1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\uff1f",id:"\u8bf4\u8bf4\u5b9a\u65f6\u4efb\u52a1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406",level:3},{value:"\u4f7f\u7528\u65e0\u754c\u961f\u5217\u7684\u7ebf\u7a0b\u6c60\u4f1a\u51fa\u73b0\u4ec0\u4e48\u95ee\u9898\uff1f",id:"\u4f7f\u7528\u65e0\u754c\u961f\u5217\u7684\u7ebf\u7a0b\u6c60\u4f1a\u51fa\u73b0\u4ec0\u4e48\u95ee\u9898",level:3},{value:"\u7ebf\u7a0b\u6c60\u5f02\u5e38\u600e\u4e48\u5904\u7406\u77e5\u9053\u5417\uff1f",id:"\u7ebf\u7a0b\u6c60\u5f02\u5e38\u600e\u4e48\u5904\u7406\u77e5\u9053\u5417",level:3},{value:"\u80fd\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u6709\u51e0\u79cd\u72b6\u6001\u5417\uff1f",id:"\u80fd\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u6709\u51e0\u79cd\u72b6\u6001\u5417",level:3},{value:"\u7ebf\u7a0b\u6c60\u5982\u4f55\u5b9e\u73b0\u53c2\u6570\u7684\u52a8\u6001\u4fee\u6539\uff1f",id:"\u7ebf\u7a0b\u6c60\u5982\u4f55\u5b9e\u73b0\u53c2\u6570\u7684\u52a8\u6001\u4fee\u6539",level:3},{value:"\u7ebf\u7a0b\u6c60\u5728\u4f7f\u7528\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4ec0\u4e48\uff1f\uff08\u8865\u5145\uff09",id:"\u7ebf\u7a0b\u6c60\u5728\u4f7f\u7528\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4ec0\u4e48\u8865\u5145",level:3},{value:"\ud83c\udf1f\u4f60\u80fd\u8bbe\u8ba1\u5b9e\u73b0\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u5417\uff1f",id:"\u4f60\u80fd\u8bbe\u8ba1\u5b9e\u73b0\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u5417",level:3},{value:"\u624b\u5199\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u53ef\u4ee5\u5417\uff1f",id:"\u624b\u5199\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u53ef\u4ee5\u5417",level:3},{value:"\u7ebf\u7a0b\u6c60\u6267\u884c\u4e2d\u65ad\u7535\u4e86\u5e94\u8be5\u600e\u4e48\u5904\u7406\uff1f",id:"\u7ebf\u7a0b\u6c60\u6267\u884c\u4e2d\u65ad\u7535\u4e86\u5e94\u8be5\u600e\u4e48\u5904\u7406",level:3},{value:"\u5e76\u53d1\u5bb9\u5668\u548c\u6846\u67b6",id:"\u5e76\u53d1\u5bb9\u5668\u548c\u6846\u67b6",level:2},{value:"Fork/Join \u6846\u67b6\u4e86\u89e3\u5417\uff1f",id:"forkjoin-\u6846\u67b6\u4e86\u89e3\u5417",level:3}];function o(n){const e={code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.h2,{id:"\u57fa\u7840",children:"\u57fa\u7840"}),"\n",(0,t.jsx)(e.p,{children:"\u5e76\u884c\u8ddf\u5e76\u53d1\u6709\u4ec0\u4e48\u533a\u522b\uff1f\r\n\u5e76\u884c\u662f\u591a\u6838 CPU \u4e0a\u7684\u591a\u4efb\u52a1\u5904\u7406\uff0c\u591a\u4e2a\u4efb\u52a1\u5728\u540c\u4e00\u65f6\u95f4\u771f\u6b63\u5730\u540c\u65f6\u6267\u884c\u3002\r\n\u5e76\u53d1\u662f\u5355\u6838 CPU \u4e0a\u7684\u591a\u4efb\u52a1\u5904\u7406\uff0c\u591a\u4e2a\u4efb\u52a1\u5728\u540c\u4e00\u65f6\u95f4\u6bb5\u5185\u4ea4\u66ff\u6267\u884c\uff0c\u901a\u8fc7\u65f6\u95f4\u7247\u8f6e\u8f6c\u5b9e\u73b0\u4ea4\u66ff\u6267\u884c\uff0c\u7528\u4e8e\u89e3\u51b3 IO \u5bc6\u96c6\u578b\u4efb\u52a1\u7684\u74f6\u9888\u3002\r\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5c31\u597d\u50cf\u6211\u4eec\u53bb\u98df\u5802\u6253\u996d\uff0c\u5e76\u884c\u5c31\u662f\u6bcf\u4e2a\u4eba\u5bf9\u5e94\u4e00\u4e2a\u963f\u59e8\uff0c\u540c\u65f6\u6253\u996d\uff1b\u800c\u5e76\u53d1\u5c31\u662f\u4e00\u4e2a\u963f\u59e8\uff0c\u8f6e\u6d41\u7ed9\u6bcf\u4e2a\u4eba\u6253\u996d\uff0c\u5047\u5982\u6709\u4e2a\u4eba\u78e8\u78e8\u5527\u5527\uff0c\u963f\u59e8\u5c31\u4f1a\u5406\u559d\u4e0b\u4e00\u4e2a\u4eba\uff0c\u8fd9\u6837\u5c31\u80fd\u63d0\u9ad8\u98df\u5802\u7684\u6253\u996d\u6548\u7387\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u4f60\u662f\u5982\u4f55\u7406\u89e3\u7ebf\u7a0b\u5b89\u5168\u7684",children:"\u4f60\u662f\u5982\u4f55\u7406\u89e3\u7ebf\u7a0b\u5b89\u5168\u7684\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u63a8\u8350\u9605\u8bfb\uff1a\u591a\u7ebf\u7a0b\u5e26\u6765\u4e86\u54ea\u4e9b\u95ee\u9898\uff1f\r\n\u5982\u679c\u4e00\u6bb5\u4ee3\u7801\u5757\u6216\u8005\u4e00\u4e2a\u65b9\u6cd5\u88ab\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u6267\u884c\uff0c\u8fd8\u80fd\u591f\u6b63\u786e\u5730\u5904\u7406\u5171\u4eab\u6570\u636e\uff0c\u90a3\u4e48\u8fd9\u6bb5\u4ee3\u7801\u5757\u6216\u8005\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\u3002\r\n\u53ef\u4ee5\u4ece\u4e09\u4e2a\u8981\u7d20\u6765\u786e\u4fdd\u7ebf\u7a0b\u5b89\u5168\uff1a\r\n\u2460\u3001\u539f\u5b50\u6027\uff1a\u4e00\u4e2a\u64cd\u4f5c\u8981\u4e48\u5b8c\u5168\u6267\u884c\uff0c\u8981\u4e48\u5b8c\u5168\u4e0d\u6267\u884c\uff0c\u4e0d\u4f1a\u51fa\u73b0\u4e2d\u95f4\u72b6\u6001\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u539f\u5b50\u6027",src:r(26712).A+"",width:"1234",height:"630"}),"\r\n\u53ef\u4ee5\u901a\u8fc7\u540c\u6b65\u5173\u952e\u5b57 synchronized \u6216\u539f\u5b50\u64cd\u4f5c\uff0c\u5982 AtomicInteger \u6765\u4fdd\u8bc1\u539f\u5b50\u6027\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"AtomicInteger count = new AtomicInteger(0);\r\ncount.\r\n\r\nincrementAndGet(); // \u539f\u5b50\u64cd\u4f5c\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u2461\u3001\u53ef\u89c1\u6027\uff1a\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86\u5171\u4eab\u53d8\u91cf\uff0c\u5176\u4ed6\u7ebf\u7a0b\u80fd\u591f\u7acb\u5373\u770b\u5230\u53d8\u5316\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u53ef\u89c1\u6027",src:r(27523).A+"",width:"796",height:"914"})]}),"\n",(0,t.jsx)(e.p,{children:"\u2462\u3001\u6709\u5e8f\u6027\uff1a\u8981\u786e\u4fdd\u7ebf\u7a0b\u4e0d\u4f1a\u56e0\u4e3a\u6b7b\u9501\u3001\u9965\u997f\u3001\u6d3b\u9501\u7b49\u95ee\u9898\u5bfc\u81f4\u65e0\u6cd5\u7ee7\u7eed\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'private volatile String itwanger = "\u6c89\u9ed8\u738b\u4e8c";\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u7684\u533a\u522b",children:"\ud83c\udf1f\u8bf4\u8bf4\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u7684\u533a\u522b\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u63a8\u8350\u9605\u8bfb:\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f\r\n\u8fdb\u7a0b\u8bf4\u7b80\u5355\u70b9\u5c31\u662f\u6211\u4eec\u5728\u7535\u8111\u4e0a\u542f\u52a8\u7684\u4e00\u4e2a\u4e2a\u5e94\u7528\u3002\u5b83\u662f\u64cd\u4f5c\u7cfb\u7edf\u5206\u914d\u8d44\u6e90\u7684\u6700\u5c0f\u5355\u4f4d\u3002\r\n\u7ebf\u7a0b\u662f\u8fdb\u7a0b\u4e2d\u7684\u72ec\u7acb\u6267\u884c\u5355\u5143\u3002\u591a\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u5171\u4eab\u540c\u4e00\u4e2a\u8fdb\u7a0b\u7684\u8d44\u6e90\uff0c\u5982\u5185\u5b58\uff1b\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u6808\u548c\u5bc4\u5b58\u5668\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u548c\u8fdb\u7a0b",src:r(19890).A+"",width:"744",height:"454"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u5982\u4f55\u7406\u89e3\u534f\u7a0b",children:"\u5982\u4f55\u7406\u89e3\u534f\u7a0b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u534f\u7a0b\u88ab\u89c6\u4e3a\u6bd4\u7ebf\u7a0b\u66f4\u8f7b\u91cf\u7ea7\u7684\u5e76\u53d1\u5355\u5143\uff0c\u53ef\u4ee5\u5728\u5355\u7ebf\u7a0b\u4e2d\u5b9e\u73b0\u5e76\u53d1\u6267\u884c\uff0c\u7531\u6211\u4eec\u5f00\u53d1\u8005\u663e\u5f0f\u8c03\u5ea6\u3002\r\n\u534f\u7a0b\u662f\u5728\u7528\u6237\u6001\u8fdb\u884c\u8c03\u5ea6\u7684\uff0c\u907f\u514d\u4e86\u7ebf\u7a0b\u5207\u6362\u65f6\u7684\u5185\u6838\u6001\u5f00\u9500\u3002\r\nJava \u81ea\u8eab\u662f\u4e0d\u652f\u6301\u534f\u7a0b\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 Quasar\u3001Kotlin \u7b49\u6846\u67b6\u6765\u5b9e\u73b0\u534f\u7a0b\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'fun main() =\r\n\r\nrunBlocking {\r\n    launch {\r\n        delay(1000L)\r\n        println("World!")\r\n    }\r\n    println("Hello,")\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u95f4\u662f\u5982\u4f55\u8fdb\u884c\u901a\u4fe1\u7684",children:"\u7ebf\u7a0b\u95f4\u662f\u5982\u4f55\u8fdb\u884c\u901a\u4fe1\u7684\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u539f\u5219\u4e0a\u53ef\u4ee5\u901a\u8fc7\u6d88\u606f\u4f20\u9012\u548c\u5171\u4eab\u5185\u5b58\u4e24\u79cd\u65b9\u6cd5\u6765\u5b9e\u73b0\u3002Java \u91c7\u7528\u7684\u662f\u5171\u4eab\u5185\u5b58\u7684\u5e76\u53d1\u6a21\u578b\u3002\r\n\u8fd9\u4e2a\u6a21\u578b\u88ab\u79f0\u4e3a Java \u5185\u5b58\u6a21\u578b\uff0c\u7b80\u5199\u4e3a JMM\uff0c\u5b83\u51b3\u5b9a\u4e86\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u5199\u5165\uff0c\u4f55\u65f6\u5bf9\u53e6\u5916\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u89c1\u3002\u5f53\u7136\u4e86\uff0c\u672c\u5730\u5185\u5b58\u662f JMM\r\n\u7684\u4e00\u4e2a\u62bd\u8c61\u6982\u5ff5\uff0c\u5e76\u4e0d\u771f\u5b9e\u5b58\u5728\u3002\r\n\u7528\u4e00\u53e5\u8bdd\u6765\u6982\u62ec\u5c31\u662f\uff1a\u5171\u4eab\u53d8\u91cf\u5b58\u50a8\u5728\u4e3b\u5185\u5b58\u4e2d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u79c1\u6709\u672c\u5730\u5185\u5b58\uff0c\u5b58\u50a8\u7684\u662f\u8fd9\u4e2a\u5171\u4eab\u53d8\u91cf\u7684\u526f\u672c\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u5171\u4eab\u5185\u5b58\u901a\u4fe1",src:r(62840).A+"",width:"423",height:"377"}),"\r\n\u7ebf\u7a0b A \u4e0e\u7ebf\u7a0b B \u4e4b\u95f4\u5982\u8981\u901a\u4fe1\uff0c\u9700\u8981\u8981\u7ecf\u5386 2 \u4e2a\u6b65\u9aa4\uff1a\r\n\u7ebf\u7a0b A \u628a\u672c\u5730\u5185\u5b58 A \u4e2d\u7684\u5171\u4eab\u53d8\u91cf\u526f\u672c\u5237\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d\u3002\r\n\u7ebf\u7a0b B \u5230\u4e3b\u5185\u5b58\u4e2d\u8bfb\u53d6\u7ebf\u7a0b A \u5237\u65b0\u8fc7\u7684\u5171\u4eab\u53d8\u91cf\uff0c\u518d\u540c\u6b65\u5230\u81ea\u5df1\u7684\u5171\u4eab\u53d8\u91cf\u526f\u672c\u4e2d\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u5171\u4eab\u5185\u5b58\u901a\u4fe11",src:r(40659).A+"",width:"440",height:"334"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4\u7ebf\u7a0b\u6709\u51e0\u79cd\u521b\u5efa\u65b9\u5f0f",children:"\ud83c\udf1f\u8bf4\u8bf4\u7ebf\u7a0b\u6709\u51e0\u79cd\u521b\u5efa\u65b9\u5f0f\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u63a8\u8350\u9605\u8bfb\uff1a\u5ba4\u53cb\u6253\u4e86\u4e00\u628a\u738b\u8005\u5c31\u5b66\u4f1a\u4e86 Java \u591a\u7ebf\u7a0b\r\n\u6709\u4e09\u79cd\uff0c\u5206\u522b\u662f\u7ee7\u627f Thread \u7c7b\u3001\u5b9e\u73b0 Runnable \u63a5\u53e3\u3001\u5b9e\u73b0 Callable \u63a5\u53e3\u3002\r\n\u7b2c\u4e00\u79cd\u9700\u8981\u91cd\u5199\u7236\u7c7b Thread \u7684 run() \u65b9\u6cd5\uff0c\u5e76\u4e14\u8c03\u7528 start() \u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b\u3002\r\n\u7b2c\u4e8c\u79cd\u9700\u8981\u91cd\u5199 Runnable \u63a5\u53e3\u7684 run() \u65b9\u6cd5\uff0c\u5e76\u5c06\u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9 Thread \u5bf9\u8c61\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u6700\u540e\u8c03\u7528 start() \u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b\u3002\r\n\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u70b9\u662f\u53ef\u4ee5\u907f\u514d Java \u7684\u5355\u7ee7\u627f\u9650\u5236\uff0c\u5e76\u4e14\u66f4\u7b26\u5408\u9762\u5411\u5bf9\u8c61\u7684\u7f16\u7a0b\u601d\u60f3\uff0c\u56e0\u4e3a Runnable \u63a5\u53e3\u5c06\u4efb\u52a1\u4ee3\u7801\u548c\u7ebf\u7a0b\u63a7\u5236\u7684\u4ee3\u7801\u89e3\u8026\u4e86\u3002\r\n\u7b2c\u4e09\u79cd\u9700\u8981\u91cd\u5199 Callable \u63a5\u53e3\u7684 call() \u65b9\u6cd5\uff0c\u7136\u540e\u521b\u5efa FutureTask \u5bf9\u8c61\uff0c\u53c2\u6570\u4e3a Callable \u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\uff1b\u7d27\u63a5\u7740\u521b\u5efa Thread\r\n\u5bf9\u8c61\uff0c\u53c2\u6570\u4e3a FutureTask \u5bf9\u8c61\uff0c\u6700\u540e\u8c03\u7528 start() \u65b9\u6cd5\u542f\u52a8\u7ebf\u7a0b\u3002\r\n\u8fd9\u79cd\u65b9\u6cd5\u7684\u4f18\u70b9\u662f\u53ef\u4ee5\u83b7\u53d6\u7ebf\u7a0b\u7684\u6267\u884c\u7ed3\u679c\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u4e00\u4e2a-8g-\u5185\u5b58\u7684\u7cfb\u7edf\u6700\u591a\u80fd\u521b\u5efa\u591a\u5c11\u4e2a\u7ebf\u7a0b",children:"\u4e00\u4e2a 8G \u5185\u5b58\u7684\u7cfb\u7edf\u6700\u591a\u80fd\u521b\u5efa\u591a\u5c11\u4e2a\u7ebf\u7a0b?"}),"\n",(0,t.jsxs)(e.p,{children:["\u63a8\u8350\u9605\u8bfb\uff1a\u6df1\u5165\u7406\u89e3 JVM \u7684\u8fd0\u884c\u65f6\u6570\u636e\u533a\r\n\u7406\u8bba\u4e0a\u5927\u7ea6 8000 \u4e2a\u3002\r\n\u521b\u5efa\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u81f3\u5c11\u9700\u8981\u5206\u914d\u4e00\u4e2a\u865a\u62df\u673a\u6808\uff0c\u5728 64 \u4f4d\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u9ed8\u8ba4\u5927\u5c0f\u4e3a 1M\uff0c\u56e0\u6b64\u4e00\u4e2a\u7ebf\u7a0b\u5927\u7ea6\u9700\u8981 1M \u7684\u5185\u5b58\u3002\r\n\u4f46 JVM\u3001\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u7684\u8fd0\u884c\u5c31\u8981\u5360\u4e00\u5b9a\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u53ef\u4ee5\u521b\u5efa\u7684\u7ebf\u7a0b\u6570\u8fdc\u6bd4 8000 \u5c11\u3002\r\n\u8be6\u7ec6\u89e3\u91ca\u4e00\u4e0b\u3002\r\n\u53ef\u4ee5\u901a\u8fc7 java -XX:+PrintFlagsFinal -version | grep ThreadStackSize \u547d\u4ee4\u67e5\u770b JVM \u6808\u7684\u9ed8\u8ba4\u5927\u5c0f\u3002\r\n",(0,t.jsx)(e.img,{alt:"jvm\u6808\u5185\u5b58\u5927\u5c0f\u8bbe\u7f6e",src:r(95802).A+"",width:"1716",height:"354"}),"\r\n\u5176\u4e2d ThreadStackSize \u7684\u5355\u4f4d\u662f KB\uff0c\u4e5f\u5c31\u662f\u8bf4\u9ed8\u8ba4\u7684 JVM \u6808\u5927\u5c0f\u662f 1024 KB\uff0c\u4e5f\u5c31\u662f 1M\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u542f\u52a8\u4e00\u4e2a-java-\u7a0b\u5e8f\u4f60\u80fd\u8bf4\u8bf4\u91cc\u9762\u6709\u54ea\u4e9b\u7ebf\u7a0b\u5417",children:"\u542f\u52a8\u4e00\u4e2a Java \u7a0b\u5e8f\uff0c\u4f60\u80fd\u8bf4\u8bf4\u91cc\u9762\u6709\u54ea\u4e9b\u7ebf\u7a0b\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u9996\u5148\u662f main \u7ebf\u7a0b\uff0c\u8fd9\u662f\u7a0b\u5e8f\u6267\u884c\u7684\u5165\u53e3\u3002\r\n\u7136\u540e\u662f\u5783\u573e\u56de\u6536\u7ebf\u7a0b\uff0c\u5b83\u662f\u4e00\u4e2a\u540e\u53f0\u7ebf\u7a0b\uff0c\u8d1f\u8d23\u56de\u6536\u4e0d\u518d\u4f7f\u7528\u7684\u5bf9\u8c61\u3002\r\n\u8fd8\u6709\u7f16\u8bd1\u5668\u7ebf\u7a0b\uff0c\u6bd4\u5982 JIT\uff0c\u8d1f\u8d23\u628a\u4e00\u90e8\u5206\u70ed\u70b9\u4ee3\u7801\u7f16\u8bd1\u540e\u653e\u5230 codeCache \u4e2d\u3002\r\n",(0,t.jsx)(e.img,{alt:"java\u4e2d\u8fd0\u884c\u7684\u7ebf\u7a0b",src:r(65849).A+"",width:"928",height:"930"})]}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\u8fdb\u884c\u68c0\u6d4b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ThreadLister {\r\n    public static void main(String[] args) {\r\n        // \u83b7\u53d6\u6240\u6709\u7ebf\u7a0b\u7684\u5806\u6808\u8ddf\u8e2a\r\n        Map<Thread, StackTraceElement[]> threads = Thread.getAllStackTraces();\r\n        for (Thread thread : threads.keySet()) {\r\n            System.out.println("Thread: " + thread.getName() + " (ID=" + thread.getId() + ")");\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u7b80\u5355\u89e3\u91ca\u4e0b\uff1a\r\nThread: main (ID=1) - \u4e3b\u7ebf\u7a0b\uff0cJava \u7a0b\u5e8f\u542f\u52a8\u65f6\u7531 JVM \u521b\u5efa\u3002\r\nThread: Reference Handler (ID=2) - \u8fd9\u4e2a\u7ebf\u7a0b\u662f\u7528\u6765\u5904\u7406\u5f15\u7528\u5bf9\u8c61\u7684\uff0c\u5982\u8f6f\u5f15\u7528\u3001\u5f31\u5f15\u7528\u548c\u865a\u5f15\u7528\u3002\u8d1f\u8d23\u6e05\u7406\u88ab JVM \u56de\u6536\u7684\u5bf9\u8c61\u3002\r\nThread: Finalizer (ID=3) - \u7ec8\u7ed3\u5668\u7ebf\u7a0b\uff0c\u8d1f\u8d23\u8c03\u7528\u5bf9\u8c61\u7684 finalize \u65b9\u6cd5\u3002\u5bf9\u8c61\u5728\u5783\u573e\u56de\u6536\u5668\u6807\u8bb0\u4e3a\u53ef\u56de\u6536\u4e4b\u524d\uff0c\u7531\u8be5\u7ebf\u7a0b\u6267\u884c\u5176\r\nfinalize \u65b9\u6cd5\uff0c\u7528\u4e8e\u6267\u884c\u7279\u5b9a\u7684\u8d44\u6e90\u91ca\u653e\u64cd\u4f5c\u3002\r\nThread: Signal Dispatcher (ID=4) - \u4fe1\u53f7\u8c03\u5ea6\u7ebf\u7a0b\uff0c\u5904\u7406\u6765\u81ea\u64cd\u4f5c\u7cfb\u7edf\u7684\u4fe1\u53f7\uff0c\u5c06\u5b83\u4eec\u8f6c\u53d1\u7ed9 JVM \u8fdb\u884c\u8fdb\u4e00\u6b65\u5904\u7406\uff0c\u4f8b\u5982\u54cd\u5e94\u4e2d\u65ad\u3001\u505c\u6b62\u7b49\u4fe1\u53f7\u3002\r\nThread: Monitor Ctrl-Break (ID=5) - \u76d1\u89c6\u5668\u7ebf\u7a0b\uff0c\u901a\u5e38\u7531\u4e00\u4e9b\u7279\u5b9a\u7684 IDE \u521b\u5efa\uff0c\u7528\u4e8e\u5728\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u76d1\u63a7\u548c\u7ba1\u7406\u7a0b\u5e8f\u6267\u884c\u6216\u8005\u5904\u7406\u4e2d\u65ad\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8c03\u7528-start-\u65b9\u6cd5\u65f6\u4f1a\u6267\u884c-run-\u65b9\u6cd5\u90a3\u600e\u4e48\u4e0d\u76f4\u63a5\u8c03\u7528-run\u65b9\u6cd5",children:"\ud83c\udf1f\u8c03\u7528 start \u65b9\u6cd5\u65f6\u4f1a\u6267\u884c run \u65b9\u6cd5\uff0c\u90a3\u600e\u4e48\u4e0d\u76f4\u63a5\u8c03\u7528 run\u65b9\u6cd5\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u8c03\u7528 start() \u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\uff0c\u5e76\u5f02\u6b65\u6267\u884c run() \u65b9\u6cd5\u4e2d\u7684\u4ee3\u7801\u3002\r\n\u76f4\u63a5\u8c03\u7528 run() \u65b9\u6cd5\u53ea\u662f\u4e00\u4e2a\u666e\u901a\u7684\u540c\u6b65\u65b9\u6cd5\u8c03\u7528\uff0c\u6240\u6709\u4ee3\u7801\u90fd\u5728\u5f53\u524d\u7ebf\u7a0b\u4e2d\u6267\u884c\uff0c\u4e0d\u4f1a\u521b\u5efa\u65b0\u7ebf\u7a0b\u3002\u6ca1\u6709\u65b0\u7684\u7ebf\u7a0b\u521b\u5efa\uff0c\u4e5f\u5c31\u8fbe\u4e0d\u5230\u591a\u7ebf\u7a0b\u5e76\u53d1\u7684\u76ee\u7684\u3002\r\n\u901a\u8fc7\u6572\u4ee3\u7801\u4f53\u9a8c\u4e00\u4e0b\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class MyThread extends Thread {\r\n    public void run() {\r\n        System.out.println(Thread.currentThread().getName());\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        MyThread t1 = new MyThread();\r\n        t1.start(); // \u6b63\u786e\u7684\u65b9\u5f0f\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7ebf\u7a0b\uff0c\u5e76\u5728\u65b0\u7ebf\u7a0b\u4e2d\u6267\u884c run()\r\n        t1.run(); // \u4ec5\u5728\u4e3b\u7ebf\u7a0b\u4e2d\u6267\u884c run()\uff0c\u6ca1\u6709\u521b\u5efa\u65b0\u7ebf\u7a0b\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u4e5f\u5c31\u662f\u8bf4\uff0c\u8c03\u7528 start() \u65b9\u6cd5\u4f1a\u901a\u77e5 JVM\uff0c\u53bb\u8c03\u7528\u5e95\u5c42\u7684\u7ebf\u7a0b\u8c03\u5ea6\u673a\u5236\u6765\u542f\u52a8\u65b0\u7ebf\u7a0b\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u542f\u52a8\u7ebf\u7a0b",src:r(18699).A+"",width:"559",height:"422"}),"\r\n\u8c03\u7528 start() \u540e\uff0c\u7ebf\u7a0b\u8fdb\u5165\u5c31\u7eea\u72b6\u6001\uff0c\u7b49\u5f85\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\uff1b\u4e00\u65e6\u8c03\u5ea6\u6267\u884c\uff0c\u7ebf\u7a0b\u4f1a\u6267\u884c\u5176 run() \u65b9\u6cd5\u4e2d\u7684\u4ee3\u7801\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6709\u54ea\u4e9b\u5e38\u7528\u7684\u8c03\u5ea6\u65b9\u6cd5",children:"\u7ebf\u7a0b\u6709\u54ea\u4e9b\u5e38\u7528\u7684\u8c03\u5ea6\u65b9\u6cd5\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u6bd4\u5982\u8bf4 start \u65b9\u6cd5\u7528\u4e8e\u542f\u52a8\u7ebf\u7a0b\u5e76\u8ba9\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\u6267\u884c\uff1bsleep \u65b9\u6cd5\u7528\u4e8e\u8ba9\u5f53\u524d\u7ebf\u7a0b\u4f11\u7720\u4e00\u6bb5\u65f6\u95f4\uff1bwait \u65b9\u6cd5\u4f1a\u8ba9\u5f53\u524d\u7ebf\u7a0b\u7b49\u5f85\uff0cnotify\r\n\u4f1a\u5524\u9192\u4e00\u4e2a\u7b49\u5f85\u7684\u7ebf\u7a0b\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u901a\u4fe1",src:r(94329).A+"",width:"617",height:"532"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4wait\u65b9\u6cd5\u548cnotify\u65b9\u6cd5",children:"\u8bf4\u8bf4wait\u65b9\u6cd5\u548cnotify\u65b9\u6cd5\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u7ebf\u7a0b A \u8c03\u7528\u5171\u4eab\u5bf9\u8c61\u7684 wait() \u65b9\u6cd5\u65f6\uff0c\u7ebf\u7a0b A \u4f1a\u88ab\u963b\u585e\u6302\u8d77\uff0c\u76f4\u5230\uff1a \u7ebf\u7a0b B \u8c03\u7528\u4e86\u5171\u4eab\u5bf9\u8c61\u7684 notify() \u65b9\u6cd5\u6216\u8005 notifyAll()\r\n\u65b9\u6cd5\uff1b\r\n\u5176\u4ed6\u7ebf\u7a0b\u8c03\u7528\u7ebf\u7a0b A \u7684 interrupt() \u65b9\u6cd5\uff0c\u5bfc\u81f4\u7ebf\u7a0b A \u629b\u51fa InterruptedException \u5f02\u5e38\u3002\r\n\u7ebf\u7a0b A \u8c03\u7528\u5171\u4eab\u5bf9\u8c61\u7684 wait(timeout)\u65b9\u6cd5\u540e\uff0c\u6ca1\u6709\u5728\u6307\u5b9a\u7684 timeout \u65f6\u95f4\u5185\u88ab\u5176\u5b83\u7ebf\u7a0b\u5524\u9192\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u56e0\u4e3a\u8d85\u65f6\u800c\u8fd4\u56de\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u7ebf\u7a0b A \u8c03\u7528\u5171\u4eab\u5bf9\u8c61\u7684 notify() \u65b9\u6cd5\u540e\uff0c\u4f1a\u5524\u9192\u4e00\u4e2a\u5728\u8fd9\u4e2a\u5171\u4eab\u5bf9\u8c61\u4e0a\u8c03\u7528 wait \u7cfb\u5217\u65b9\u6cd5\u88ab\u6302\u8d77\u7684\u7ebf\u7a0b\u3002\r\n\u5171\u4eab\u5bf9\u8c61\u4e0a\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u7ebf\u7a0b\u5728\u7b49\u5f85\uff0c\u5177\u4f53\u5524\u9192\u54ea\u4e2a\u7ebf\u7a0b\u662f\u968f\u673a\u7684\u3002\r\n\u5982\u679c\u8c03\u7528\u7684\u662f notifyAll \u65b9\u6cd5\uff0c\u4f1a\u5524\u9192\u6240\u6709\u5728\u8fd9\u4e2a\u5171\u4eab\u53d8\u91cf\u4e0a\u8c03\u7528 wait \u7cfb\u5217\u65b9\u6cd5\u800c\u88ab\u6302\u8d77\u7684\u7ebf\u7a0b\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4-sleep-\u65b9\u6cd5",children:"\u8bf4\u8bf4 sleep \u65b9\u6cd5\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u7ebf\u7a0b A \u8c03\u7528\u4e86 Thread \u7684 sleep \u65b9\u6cd5\u540e\uff0c\u7ebf\u7a0b A \u4f1a\u6682\u65f6\u8ba9\u51fa\u6307\u5b9a\u65f6\u95f4\u7684\u6267\u884c\u6743\u3002\r\n\u6307\u5b9a\u7684\u7761\u7720\u65f6\u95f4\u5230\u4e86\u540e\u8be5\u65b9\u6cd5\u4f1a\u6b63\u5e38\u8fd4\u56de\uff0c\u63a5\u7740\u53c2\u4e0e CPU \u8c03\u5ea6\uff0c\u83b7\u53d6\u5230 CPU \u8d44\u6e90\u540e\u53ef\u4ee5\u7ee7\u7eed\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4yield\u65b9\u6cd5",children:"\u8bf4\u8bf4yield\u65b9\u6cd5\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"yield() \u65b9\u6cd5\u7684\u76ee\u7684\u662f\u8ba9\u5f53\u524d\u7ebf\u7a0b\u8ba9\u51fa CPU \u4f7f\u7528\u6743\uff0c\u56de\u5230\u5c31\u7eea\u72b6\u6001\u3002\u4f46\u662f\u7ebf\u7a0b\u8c03\u5ea6\u5668\u53ef\u80fd\u4f1a\u5ffd\u7565"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4interrupt\u65b9\u6cd5",children:"\u8bf4\u8bf4interrupt\u65b9\u6cd5\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u63a8\u8350\u9605\u8bfb\uff1ainterrupt \u65b9\u6cd5\r\ninterrupt() \u65b9\u6cd5\u7528\u4e8e\u901a\u77e5\u7ebf\u7a0b\u505c\u6b62\uff0c\u4f46\u4e0d\u4f1a\u76f4\u63a5\u7ec8\u6b62\u7ebf\u7a0b\uff0c\u9700\u8981\u7ebf\u7a0b\u81ea\u884c\u5904\u7406\u4e2d\u65ad\u6807\u5fd7\u3002\r\n\u5e38\u4e0e isInterrupted() \u6216 Thread.interrupted() \u914d\u5408\u4f7f\u7528\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public static void main(String[] args) {\r\n    Thread thread = new Thread(() -> {\r\n        while (!Thread.currentThread().isInterrupted()) {\r\n            System.out.println("Running");\r\n        }\r\n        System.out.println("Interrupted");\r\n    });\r\n    thread.start();\r\n    thread.interrupt(); // \u4e2d\u65ad\u7ebf\u7a0b\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4-stop-\u65b9\u6cd5",children:"\u8bf4\u8bf4 stop \u65b9\u6cd5\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"stop \u65b9\u6cd5\u7528\u6765\u5f3a\u5236\u505c\u6b62\u7ebf\u7a0b\uff0c\u76ee\u524d\u5df2\u7ecf\u5904\u4e8e\u5e9f\u5f03\u72b6\u6001\uff0c\u56e0\u4e3a stop \u65b9\u6cd5\u53ef\u80fd\u4f1a\u5728\u4e0d\u4e00\u81f4\u7684\u72b6\u6001\u4e0b\u91ca\u653e\u9501\uff0c\u7834\u574f\u5bf9\u8c61\u7684\u4e00\u81f4\u6027\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6709\u51e0\u79cd\u72b6\u6001",children:"\ud83c\udf1f\u7ebf\u7a0b\u6709\u51e0\u79cd\u72b6\u6001\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"6 \u79cd\u3002"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"new \u4ee3\u8868\u7ebf\u7a0b\u88ab\u521b\u5efa\u4f46\u672a\u542f\u52a8"}),"\n",(0,t.jsx)(e.li,{children:"runnable \u4ee3\u8868\u7ebf\u7a0b\u5904\u4e8e\u5c31\u7eea\u6216\u6b63\u5728\u8fd0\u884c\u72b6\u6001\uff0c\u7531\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6"}),"\n",(0,t.jsx)(e.li,{children:"blocked \u4ee3\u8868\u7ebf\u7a0b\u88ab\u963b\u585e\uff0c\u7b49\u5f85\u83b7\u53d6\u9501"}),"\n",(0,t.jsx)(e.li,{children:"waiting \u4ee3\u8868\u7ebf\u7a0b\u7b49\u5f85\u5176\u4ed6\u7ebf\u7a0b\u7684\u901a\u77e5\u6216\u4e2d\u65ad"}),"\n",(0,t.jsx)(e.li,{children:"timed_waiting \u4ee3\u8868\u7ebf\u7a0b\u4f1a\u7b49\u5f85\u4e00\u6bb5\u65f6\u95f4\uff0c\u8d85\u65f6\u540e\u81ea\u52a8\u6062\u590d"}),"\n",(0,t.jsxs)(e.li,{children:["terminated \u4ee3\u8868\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\uff0c\u751f\u547d\u5468\u671f\u7ed3\u675f\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u72b6\u6001",src:r(5181).A+"",width:"1037",height:"708"}),"\r\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f\u53ef\u4ee5\u5206\u4e3a\u4e94\u4e2a\u4e3b\u8981\u9636\u6bb5\uff1a\u65b0\u5efa\u3001\u5c31\u7eea\u3001\u8fd0\u884c\u3001\u963b\u585e\u548c\u7ec8\u6b62\u3002\u7ebf\u7a0b\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u4f1a\u6839\u636e\u72b6\u6001\u7684\u53d8\u5316\u5728\u8fd9\u4e9b\u9636\u6bb5\u4e4b\u95f4\u5207\u6362\u3002"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ThreadStateExample {\r\n    public static void main(String[] args) throws InterruptedException {\r\n        Thread thread = new Thread(() -> {\r\n            try {\r\n                Thread.sleep(2000); // TIMED_WAITING\r\n                synchronized (ThreadStateExample.class) {\r\n                    ThreadStateExample.class.wait(); // WAITING\r\n                }\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        });\r\n\r\n        System.out.println("State after creation: " + thread.getState()); // NEW\r\n\r\n        thread.start();\r\n        System.out.println("State after start: " + thread.getState()); // RUNNABLE\r\n\r\n        Thread.sleep(2500); // \u8fd9\u91cc\u7684\u65f6\u95f4\u8981\u6bd4\u5b50\u7ebf\u7a0b\u7684\u591a\uff0c\u4e0d\u7136\u4f1a\u63d0\u524d\u5524\u9192\r\n        System.out.println("State while sleeping: " + thread.getState()); // TIMED_WAITING\r\n\r\n        synchronized (ThreadStateExample.class) {\r\n            ThreadStateExample.class.notify(); // \u5524\u9192\u7ebf\u7a0b\r\n        }\r\n\r\n        thread.join();\r\n        System.out.println("State after termination: " + thread.getState()); // TERMINATED\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u603b\u7ed3\u8bf4\u660e"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"NEW\uff1a\u5f53\u7ebf\u7a0b\u88ab\u521b\u5efa\u540e\uff0c\u5982\u901a\u8fc7new Thread()\uff0c\u5b83\u5904\u4e8e\u65b0\u5efa\u72b6\u6001\u3002\u6b64\u65f6\uff0c\u7ebf\u7a0b\u5df2\u7ecf\u88ab\u5206\u914d\u4e86\u5fc5\u8981\u7684\u8d44\u6e90\uff0c\u4f46\u8fd8\u6ca1\u6709\u5f00\u59cb\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.li,{children:"RUNNABLE\uff1a \u5f53\u8c03\u7528\u7ebf\u7a0b\u7684start()\u65b9\u6cd5\u540e\uff0c\u7ebf\u7a0b\u8fdb\u5165\u53ef\u8fd0\u884c\u72b6\u6001\u3002\u5728\u8fd9\u4e2a\u72b6\u6001\u4e0b\uff0c\u7ebf\u7a0b\u53ef\u80fd\u6b63\u5728\u8fd0\u884c\u4e5f\u53ef\u80fd\u6b63\u5728\u7b49\u5f85\u83b7\u53d6 CPU\r\n\u65f6\u95f4\u7247\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u7ebf\u7a0b\u8c03\u5ea6\u5668\u7684\u8c03\u5ea6\u7b56\u7565\u3002"}),"\n",(0,t.jsxs)(e.li,{children:["BLOCKED\uff1a \u7ebf\u7a0b\u5728",(0,t.jsx)(e.strong,{children:"\u8bd5\u56fe\u83b7\u53d6\u4e00\u4e2a\u9501\u4ee5\u8fdb\u5165\u540c\u6b65\u5757/\u65b9\u6cd5\u65f6\u5982\u679c\u9501\u88ab\u5176\u4ed6\u7ebf\u7a0b\u6301\u6709"}),"\uff0c\u7ebf\u7a0b\u5c06\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u5b83\u83b7\u53d6\u5230\u9501\u3002\r\n\uff08\u8fd9\u91cc\u7684\u610f\u601d\u662f\u53ea\u6709\u4f7f\u7528synchronized\u4e14\u5c06\u7ebf\u7a0b\u5524\u9192\u65f6\uff0c\u7ebf\u7a0b\u6ca1\u6709\u83b7\u53d6\u5230\u9501\u624d\u8fdb\u5165\u8fd9\u4e2a\u72b6\u6001\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:["WAITING\uff1a \u7ebf\u7a0b\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\u662f\u56e0\u4e3a\u8c03\u7528\u4e86\u5982\u4e0b\u65b9\u6cd5\u4e4b\u4e00\uff1aObject.wait()\u6216LockSupport.park()\u3002\u5728\u7b49\u5f85\u72b6\u6001\u4e0b\uff0c*\r\n",(0,t.jsx)(e.em,{children:"\u7ebf\u7a0b\u9700\u8981\u5176\u4ed6\u7ebf\u7a0b\u663e\u5f0f\u5730\u5524\u9192\uff0c\u5426\u5219\u4e0d\u4f1a\u81ea\u52a8\u6267\u884c"}),"*\u3002"]}),"\n",(0,t.jsx)(e.li,{children:"TIME_WAITING \u5f53\u7ebf\u7a0b\u8c03\u7528\u5e26\u6709\u8d85\u65f6\u53c2\u6570\u7684\u65b9\u6cd5\u65f6\uff0c\u5982Thread.sleep(long millis)\u3001Object.wait(long timeout)\r\n\u6216LockSupport.parkNanos()\uff0c\u5b83\u5c06\u8fdb\u5165\u8d85\u65f6\u7b49\u5f85\u72b6\u6001\u3002\u7ebf\u7a0b\u5728\u6307\u5b9a\u7684\u7b49\u5f85\u65f6\u95f4\u8fc7\u540e\u4f1a\u81ea\u52a8\u8fd4\u56de\u53ef\u8fd0\u884c\u72b6\u6001\u3002"}),"\n",(0,t.jsx)(e.li,{children:"TERMINATED \u5f53\u7ebf\u7a0b\u7684run()\u65b9\u6cd5\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u6216\u8005\u56e0\u4e3a\u4e00\u4e2a\u672a\u6355\u83b7\u7684\u5f02\u5e38\u7ec8\u6b62\u4e86\u6267\u884c\uff0c\u7ebf\u7a0b\u8fdb\u5165\u7ec8\u6b62\u72b6\u6001\u3002\u4e00\u65e6\u7ebf\u7a0b\u7ec8\u6b62\uff0c\u5b83\u7684\u751f\u547d\u5468\u671f\u7ed3\u675f\uff0c\u4e0d\u80fd\u518d\u88ab\u91cd\u65b0\u542f\u52a8\u3002"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"AQS\u6846\u67b6\u7684\u9501\u7ade\u4e89\u5931\u8d25\u540e\u4f1a\u8fdb\u5165\u5230WAITING / TIMED_WAITING"}),"\n",(0,t.jsx)(e.h3,{id:"\u5982\u4f55\u5f3a\u5236\u7ec8\u6b62\u7ebf\u7a0b",children:"\u5982\u4f55\u5f3a\u5236\u7ec8\u6b62\u7ebf\u7a0b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e00\u6b65\uff0c\u8c03\u7528\u7ebf\u7a0b\u7684 interrupt() \u65b9\u6cd5\uff0c\u8bf7\u6c42\u7ec8\u6b62\u7ebf\u7a0b\u3002\r\n\u7b2c\u4e8c\u6b65\uff0c\u5728\u7ebf\u7a0b\u7684 run() \u65b9\u6cd5\u4e2d\u68c0\u67e5\u4e2d\u65ad\u72b6\u6001\uff0c\u5982\u679c\u7ebf\u7a0b\u88ab\u4e2d\u65ad\uff0c\u5c31\u9000\u51fa\u7ebf\u7a0b\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public class MyTask implements Runnable {\r\n    @Override\r\n    public void run() {\r\n        while (!Thread.currentThread().isInterrupted()) {\r\n            try {\r\n                System.out.println("Running...");\r\n                Thread.sleep(1000); // \u6a21\u62df\u5de5\u4f5c\r\n            } catch (InterruptedException e) {\r\n                // \u6355\u83b7\u4e2d\u65ad\u5f02\u5e38\u540e\uff0c\u91cd\u7f6e\u4e2d\u65ad\u72b6\u6001\r\n                Thread.currentThread().interrupt();\r\n                System.out.println("Thread interrupted, exiting...");\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    public static void main(String[] args) throws InterruptedException {\r\n        Thread thread = new Thread(new MyTask());\r\n        thread.start();\r\n        Thread.sleep(3000); // \u4e3b\u7ebf\u7a0b\u7b49\u5f853\u79d2\r\n        thread.interrupt(); // \u8bf7\u6c42\u7ec8\u6b62\u7ebf\u7a0b\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362",children:"\u4ec0\u4e48\u662f\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\u662f\u6307 CPU \u4ece\u4e00\u4e2a\u7ebf\u7a0b\u5207\u6362\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u65f6\u7684\u8fc7\u7a0b\u3002\r\n\u5728\u7ebf\u7a0b\u5207\u6362\u7684\u8fc7\u7a0b\u4e2d\uff0cCPU \u9700\u8981\u4fdd\u5b58\u5f53\u524d\u7ebf\u7a0b\u7684\u6267\u884c\u72b6\u6001\uff0c\u5e76\u52a0\u8f7d\u4e0b\u4e00\u4e2a\u7ebf\u7a0b\u7684\u4e0a\u4e0b\u6587\u3002\r\n\u4e4b\u6240\u4ee5\u8981\u8fd9\u6837\uff0c\u662f\u56e0\u4e3a CPU \u5728\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u6267\u884c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u4e3a\u4e86\u5b9e\u73b0\u591a\u7ebf\u7a0b\u5e76\u53d1\u6267\u884c\uff0c\u9700\u8981\u4e0d\u65ad\u5730\u5728\u591a\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u5207\u6362\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u6267\u884c\u4e2d\u7684\u4e0a\u4e0b\u6587\u5207\u6362",src:r(31901).A+"",width:"755",height:"423"}),"\r\n\u4e3a\u4e86\u8ba9\u7528\u6237\u611f\u89c9\u591a\u4e2a\u7ebf\u7a0b\u662f\u5728\u540c\u65f6\u6267\u884c\u7684\uff0c CPU \u8d44\u6e90\u7684\u5206\u914d\u91c7\u7528\u4e86\u65f6\u95f4\u7247\u8f6e\u8f6c\u7684\u65b9\u5f0f\uff0c\u7ebf\u7a0b\u5728\u65f6\u95f4\u7247\u5185\u5360\u7528 CPU \u6267\u884c\u4efb\u52a1\u3002\u5f53\u7ebf\u7a0b\u4f7f\u7528\u5b8c\u65f6\u95f4\u7247\u540e\uff0c\u5c31\u4f1a\u8ba9\u51fa\r\nCPU \u8ba9\u5176\u4ed6\u7ebf\u7a0b\u5360\u7528\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u53ef\u4ee5\u88ab\u591a\u6838\u8c03\u5ea6\u5417",children:"\u7ebf\u7a0b\u53ef\u4ee5\u88ab\u591a\u6838\u8c03\u5ea6\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u591a\u6838\u5904\u7406\u5668\u63d0\u4f9b\u4e86\u5e76\u884c\u6267\u884c\u591a\u4e2a\u7ebf\u7a0b\u7684\u80fd\u529b\u3002\u6bcf\u4e2a\u6838\u5fc3\u53ef\u4ee5\u72ec\u7acb\u6267\u884c\u4e00\u4e2a\u6216\u591a\u4e2a\u7ebf\u7a0b\uff0c\u64cd\u4f5c\u7cfb\u7edf\u7684\u4efb\u52a1\u8c03\u5ea6\u5668\u4f1a\u6839\u636e\u7b56\u7565\u548c\u7b97\u6cd5\uff0c\u5982\u4f18\u5148\u7ea7\u8c03\u5ea6\u3001\u8f6e\u8f6c\u8c03\u5ea6\u7b49\uff0c\u51b3\u5b9a\u54ea\u4e2a\u7ebf\u7a0b\u4f55\u65f6\u5728\u54ea\u4e2a\u6838\u5fc3\u4e0a\u8fd0\u884c\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u5b88\u62a4\u7ebf\u7a0b\u4e86\u89e3\u5417",children:"\u5b88\u62a4\u7ebf\u7a0b\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e86\u89e3\uff0c\u5b88\u62a4\u7ebf\u7a0b\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7ebf\u7a0b\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u4e3a\u5176\u4ed6\u7ebf\u7a0b\u63d0\u4f9b\u670d\u52a1\u3002\r\nJava \u4e2d\u7684\u7ebf\u7a0b\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u79cd\u662f\u5b88\u62a4\u7ebf\u7a0b\uff0c\u53e6\u5916\u4e00\u79cd\u662f\u7528\u6237\u7ebf\u7a0b\u3002\r\nJVM \u542f\u52a8\u65f6\u4f1a\u8c03\u7528 main \u65b9\u6cd5\uff0cmain \u65b9\u6cd5\u6240\u5728\u7684\u7ebf\u7a0b\u5c31\u662f\u4e00\u4e2a\u7528\u6237\u7ebf\u7a0b\u3002\r\n\u5728 JVM \u5185\u90e8\uff0c\u540c\u65f6\u8fd8\u542f\u52a8\u4e86\u5f88\u591a\u5b88\u62a4\u7ebf\u7a0b\uff0c\u6bd4\u5982\u5783\u573e\u56de\u6536\u7ebf\u7a0b\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u5b88\u62a4\u7ebf\u7a0b\u548c\u7528\u6237\u7ebf\u7a0b\u6709\u4ec0\u4e48\u533a\u522b\u5462",children:"\u5b88\u62a4\u7ebf\u7a0b\u548c\u7528\u6237\u7ebf\u7a0b\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u533a\u522b\u4e4b\u4e00\u662f\u5f53\u6700\u540e\u4e00\u4e2a\u975e\u5b88\u62a4\u7ebf\u7a0b\u675f\u65f6\uff0c JVM \u4f1a\u6b63\u5e38\u9000\u51fa\uff0c\u4e0d\u7ba1\u5f53\u524d\u662f\u5426\u5b58\u5728\u5b88\u62a4\u7ebf\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b88\u62a4\u7ebf\u7a0b\u662f\u5426\u7ed3\u675f\u5e76\u4e0d\u5f71\u54cd JVM \u9000\u51fa\u3002\r\n\u6362\u800c\u8a00\u4e4b\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u7528\u6237\u7ebf\u7a0b\u8fd8\u6ca1\u7ed3\u675f\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b JVM \u5c31\u4e0d\u4f1a\u9000\u51fa\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u95f4\u6709\u54ea\u4e9b\u901a\u4fe1\u65b9\u5f0f",children:"\u7ebf\u7a0b\u95f4\u6709\u54ea\u4e9b\u901a\u4fe1\u65b9\u5f0f\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u4e4b\u95f4\u4f20\u9012\u4fe1\u606f\u7684\u65b9\u5f0f\u6709\u591a\u79cd\uff0c\u6bd4\u5982\u8bf4\u4f7f\u7528 volatile \u548c synchronized \u5173\u952e\u5b57\u5171\u4eab\u5bf9\u8c61\u3001\u4f7f\u7528 wait() \u548c notify() \u65b9\u6cd5\u5b9e\u73b0\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u6a21\u5f0f\u3001\u4f7f\u7528\r\nExchanger \u8fdb\u884c\u6570\u636e\u4ea4\u6362\u3001\u4f7f\u7528 Condition \u5b9e\u73b0\u7ebf\u7a0b\u95f4\u7684\u534f\u8c03\u7b49\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u7b80\u5355\u8bf4\u8bf4-volatile-\u548c-synchronized-\u7684\u4f7f\u7528\u65b9\u5f0f",children:"\u7b80\u5355\u8bf4\u8bf4 volatile \u548c synchronized \u7684\u4f7f\u7528\u65b9\u5f0f\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u591a\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u901a\u8fc7 volatile \u548c synchronized \u5173\u952e\u5b57\u8bbf\u95ee\u548c\u4fee\u6539\u540c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4ece\u800c\u5b9e\u73b0\u4fe1\u606f\u7684\u4f20\u9012\u3002\r\n\u5173\u952e\u5b57 volatile \u53ef\u4ee5\u7528\u6765\u4fee\u9970\u6210\u5458\u53d8\u91cf\uff0c\u544a\u77e5\u7a0b\u5e8f\u4efb\u4f55\u5bf9\u8be5\u53d8\u91cf\u7684\u8bbf\u95ee\u5747\u9700\u8981\u4ece\u5171\u4eab\u5185\u5b58\u4e2d\u83b7\u53d6\uff0c\u5e76\u540c\u6b65\u5237\u65b0\u56de\u5171\u4eab\u5185\u5b58\uff0c\u4fdd\u8bc1\u6240\u6709\u7ebf\u7a0b\u5bf9\u53d8\u91cf\u8bbf\u95ee\u7684\u53ef\u89c1\u6027\u3002\r\n\u5173\u952e\u5b57 synchronized \u53ef\u4ee5\u4fee\u9970\u65b9\u6cd5\uff0c\u6216\u8005\u540c\u6b65\u4ee3\u7801\u5757\uff0c\u786e\u4fdd\u591a\u4e2a\u7ebf\u7a0b\u5728\u540c\u4e00\u4e2a\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u6267\u884c\u65b9\u6cd5\u6216\u4ee3\u7801\u5757\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public class SharedObject {\r\n    private String message;\r\n    private boolean hasMessage = false;\r\n\r\n    public synchronized void writeMessage(String message) {\r\n        while (hasMessage) {\r\n            try {\r\n                wait();\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        }\r\n        this.message = message;\r\n        hasMessage = true;\r\n        notifyAll();\r\n    }\r\n\r\n    public synchronized String readMessage() {\r\n        while (!hasMessage) {\r\n            try {\r\n                wait();\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        }\r\n        hasMessage = false;\r\n        notifyAll();\r\n        return message;\r\n    }\r\n\r\n\r\n    public static void main(String[] args) {\r\n        SharedObject sharedObject = new SharedObject();\r\n\r\n        Thread writer = new Thread(() -> {\r\n            sharedObject.writeMessage("Hello from Writer!");\r\n        });\r\n\r\n        Thread reader = new Thread(() -> {\r\n            String message = sharedObject.readMessage();\r\n            System.out.println("Reader received: " + message);\r\n        });\r\n\r\n        writer.start();\r\n        reader.start();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"wait-\u548c-notify-\u65b9\u6cd5\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417",children:"wait() \u548c notify() \u65b9\u6cd5\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528\u5171\u4eab\u5bf9\u8c61\u7684 wait() \u65b9\u6cd5\u65f6\uff0c\u5b83\u4f1a\u8fdb\u5165\u8be5\u5bf9\u8c61\u7684\u7b49\u5f85\u6c60\uff0c\u91ca\u653e\u5df2\u7ecf\u6301\u6709\u7684\u9501\uff0c\u8fdb\u5165\u7b49\u5f85\u72b6\u6001\u3002\r\n\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528 notify() \u65b9\u6cd5\u65f6\uff0c\u5b83\u4f1a\u5524\u9192\u5728\u8be5\u5bf9\u8c61\u7b49\u5f85\u6c60\u4e2d\u7b49\u5f85\u7684\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u4f7f\u5176\u8fdb\u5165\u9501\u6c60\uff0c\u7b49\u5f85\u83b7\u53d6\u9501\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class MessageBox {\r\n    private String message;\r\n    private boolean empty = true;\r\n\r\n    public synchronized void produce(String message) {\r\n        while (!empty) {\r\n            try {\r\n                wait();\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        }\r\n        empty = false;\r\n        this.message = message;\r\n        notifyAll();\r\n    }\r\n\r\n    public synchronized String consume() {\r\n        while (empty) {\r\n            try {\r\n                wait();\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        }\r\n        empty = true;\r\n        notifyAll();\r\n        return message;\r\n    }\r\n}\r\n\r\npublic class Main {\r\n    public static void main(String[] args) {\r\n        MessageBox box = new MessageBox();\r\n\r\n        Thread producer = new Thread(() -> {\r\n            box.produce("Message from producer");\r\n        });\r\n\r\n        Thread consumer = new Thread(() -> {\r\n            String message = box.consume();\r\n            System.out.println("Consumer received: " + message);\r\n        });\r\n\r\n        producer.start();\r\n        consumer.start();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u901a\u5e38\u4e0e\u9501 ReentrantLock \u4e00\u8d77\u4f7f\u7528\uff0c\u4e3a\u7ebf\u7a0b\u63d0\u4f9b\u4e86\u4e00\u79cd\u7b49\u5f85\u67d0\u4e2a\u6761\u4ef6\u6210\u771f\u7684\u673a\u5236\uff0c\u5e76\u5141\u8bb8\u5176\u4ed6\u7ebf\u7a0b\u5728\u8be5\u6761\u4ef6\u53d8\u5316\u65f6\u901a\u77e5\u7b49\u5f85\u7ebf\u7a0b\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"exchanger-\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417",children:"Exchanger \u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["Exchanger \u662f\u4e00\u4e2a\u540c\u6b65\u70b9\uff0c\u53ef\u4ee5\u5728\u4e24\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u4ea4\u6362\u6570\u636e\u3002\u4e00\u4e2a\u7ebf\u7a0b\u8c03\u7528 exchange() \u65b9\u6cd5\uff0c\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u53e6\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u540c\u65f6\u63a5\u6536\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u7684\u6570\u636e\u3002\r\n",(0,t.jsx)(e.strong,{children:"ps:\u6211\u5c1d\u8bd5\u4f7f\u75283\u4e2a\u7ebf\u7a0b\uff0c\u4f1a\u5bfc\u81f4\u963b\u585e\uff1f"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public class ExchangerTest {\r\n    public static void main(String[] args) {\r\n        Exchanger<String> exchanger = new Exchanger<>();\r\n\r\n        Thread thread1 = new Thread(() -> {\r\n            try {\r\n                String message = "Message from thread1";\r\n                String response = exchanger.exchange(message);\r\n                System.out.println("Thread1 received: " + response);\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        });\r\n\r\n        Thread thread2 = new Thread(() -> {\r\n            try {\r\n                String message = "Message from thread2";\r\n                String response = exchanger.exchange(message);\r\n                System.out.println("Thread2 received: " + response);\r\n            } catch (InterruptedException e) {\r\n                Thread.currentThread().interrupt();\r\n            }\r\n        });\r\n\r\n        thread1.start();\r\n        thread2.start();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"completablefuture-\u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417",children:"CompletableFuture \u7684\u4f7f\u7528\u65b9\u5f0f\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["CompletableFuture \u662f Java 8 \u5f15\u5165\u7684\u4e00\u4e2a\u7c7b\uff0c\u652f\u6301\u5f02\u6b65\u7f16\u7a0b\uff0c\u5141\u8bb8\u7ebf\u7a0b\u5728\u5b8c\u6210\u8ba1\u7b97\u540e\u5c06\u7ed3\u679c\u4f20\u9012\u7ed9\u5176\u4ed6\u7ebf\u7a0b\u3002\r\n",(0,t.jsx)(e.strong,{children:"me: \u53ea\u8981\u4f7f\u7528 CompletableFuture\uff0c\u5c31\u4e00\u5b9a\u8981\u8003\u8651\u5f02\u5e38\u5904\u7406\u3002\u4f7f\u7528 exceptionally, handle,\r\nwhenComplete\u7b49\u65b9\u6cd5\uff0c\u786e\u4fdd\u5f02\u5e38\u80fd\u88ab\u59a5\u5584\u5904\u7406\u6216\u8bb0\u5f55\uff0c\u907f\u514d\u5f02\u5e38\u88ab\u201c\u541e\u6389\u201d"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public static void main(String[] args) {\r\n    CompletableFuture<String> future = CompletableFuture.supplyAsync(() -> {\r\n        // \u6a21\u62df\u957f\u65f6\u95f4\u8ba1\u7b97\r\n        return "Message from CompletableFuture";\r\n    });\r\n\r\n    future.thenAccept(message -> {\r\n        System.out.println("Received: " + message);\r\n    });\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf7\u8bf4\u8bf4-sleep-\u548c-wait-\u7684\u533a\u522b\u8865\u5145",children:"\ud83c\udf1f\u8bf7\u8bf4\u8bf4 sleep \u548c wait \u7684\u533a\u522b\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"sleep \u4f1a\u8ba9\u5f53\u524d\u7ebf\u7a0b\u4f11\u7720\uff0c\u4e0d\u9700\u8981\u83b7\u53d6\u5bf9\u8c61\u9501\uff0c\u5c5e\u4e8e Thread \u7c7b\u7684\u65b9\u6cd5\uff1b\r\nwait \u4f1a\u8ba9\u83b7\u5f97\u5bf9\u8c61\u9501\u7684\u7ebf\u7a0b\u7b49\u5f85\uff0c\u8981\u63d0\u524d\u83b7\u5f97\u5bf9\u8c61\u9501\uff0c\u5c5e\u4e8e Object \u7c7b\u7684\u65b9\u6cd5\u3002"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u6240\u5c5e\u7c7b\u4e0d\u540c\r\nsleep() \u65b9\u6cd5\u4e13\u5c5e\u4e8e Thread \u7c7b , wait() \u65b9\u6cd5\u4e13\u5c5e\u4e8e Object \u7c7b,"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u9501\u884c\u4e3a\u4e0d\u540c\r\n\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u5728\u6301\u6709\u67d0\u4e2a\u5bf9\u8c61\u9501\u65f6\u8c03\u7528\u4e86 sleep \u65b9\u6cd5\uff0c\u5b83\u5728\u7761\u7720\u671f\u95f4\u4ecd\u7136\u4f1a\u6301\u6709\u8fd9\u4e2a\u9501\u3002"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u4f7f\u7528\u6761\u4ef6\u4e0d\u540c\r\nsleep() \u65b9\u6cd5\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u88ab\u8c03\u7528\u3002\r\nwait() \u65b9\u6cd5\u5fc5\u987b\u5728\u540c\u6b65\u4ee3\u7801\u5757\u6216\u540c\u6b65\u65b9\u6cd5\u4e2d\u88ab\u8c03\u7528\uff0c\u8fd9\u662f\u56e0\u4e3a\u8c03\u7528 wait() \u65b9\u6cd5\u7684\u524d\u63d0\u662f\u5f53\u524d\u7ebf\u7a0b\u5fc5\u987b\u6301\u6709\u5bf9\u8c61\u7684\u9501\u3002\u5426\u5219\u4f1a\u629b\u51fa\r\nIllegalMonitorStateException \u5f02\u5e38\u3002"}),"\n"]}),"\n",(0,t.jsxs)(e.li,{children:["\n",(0,t.jsx)(e.p,{children:"\u5524\u9192\u65b9\u5f0f\u4e0d\u540c\r\n\u8c03\u7528 sleep \u65b9\u6cd5\u540e\uff0c\u7ebf\u7a0b\u4f1a\u8fdb\u5165 TIMED_WAITING \u72b6\u6001\uff0c\u5373\u5728\u6307\u5b9a\u7684\u65f6\u95f4\u5185\u6682\u505c\u6267\u884c\u3002\u5f53\u6307\u5b9a\u7684\u65f6\u95f4\u7ed3\u675f\u540e\uff0c\u7ebf\u7a0b\u4f1a\u81ea\u52a8\u6062\u590d\u5230 RUNNABLE\r\n\u72b6\u6001\uff0c\u7b49\u5f85 CPU \u8c03\u5ea6\u518d\u6b21\u6267\u884c\u3002\r\n\u8c03\u7528 wait \u65b9\u6cd5\u540e\uff0c\u7ebf\u7a0b\u4f1a\u8fdb\u5165 WAITING \u72b6\u6001\uff0c\u76f4\u5230\u6709\u5176\u4ed6\u7ebf\u7a0b\u5728\u540c\u4e00\u5bf9\u8c61\u4e0a\u8c03\u7528 notify \u6216 notifyAll \u65b9\u6cd5\uff0c\u7ebf\u7a0b\u624d\u4f1a\u4ece WAITING\r\n\u72b6\u6001\u8f6c\u53d8\u4e3a RUNNABLE \u72b6\u6001\uff0c\u51c6\u5907\u518d\u6b21\u83b7\u5f97 CPU \u7684\u6267\u884c\u6743\u3002"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"\u600e\u4e48\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u8865\u5145",children:"\ud83c\udf1f\u600e\u4e48\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u5b89\u5168\u662f\u6307\u5728\u5e76\u53d1\u73af\u5883\u4e0b\uff0c\u591a\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u65f6\uff0c\u7a0b\u5e8f\u80fd\u591f\u6b63\u786e\u5730\u6267\u884c\uff0c\u800c\u4e0d\u4f1a\u51fa\u73b0\u6570\u636e\u4e0d\u4e00\u81f4\u7684\u95ee\u9898\u3002\r\n\u4e3a\u4e86\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\uff0c\u53ef\u4ee5\u4f7f\u7528 synchronized \u5173\u952e\u5b57\u5bf9\u65b9\u6cd5\u52a0\u9501\uff0c\u5bf9\u4ee3\u7801\u5757\u52a0\u9501\u3002\r\n\u7ebf\u7a0b\u5728\u6267\u884c\u540c\u6b65\u65b9\u6cd5\u3001\u540c\u6b65\u4ee3\u7801\u5757\u65f6\uff0c\u4f1a\u83b7\u53d6\u7c7b\u9501\u6216\u8005\u5bf9\u8c61\u9501\uff0c\u5176\u4ed6\u7ebf\u7a0b\u5c31\u4f1a\u963b\u585e\u5e76\u7b49\u5f85\u9501\u3002\r\n\u5982\u679c\u9700\u8981\u66f4\u7ec6\u7c92\u5ea6\u7684\u9501\uff0c\u53ef\u4ee5\u4f7f\u7528 ReentrantLock \u5e76\u53d1\u91cd\u5165\u9501\u7b49\u3002\r\n\u5982\u679c\u9700\u8981\u4fdd\u8bc1\u53d8\u91cf\u7684\u5185\u5b58\u53ef\u89c1\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528 volatile \u5173\u952e\u5b57\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5bf9\u4e8e\u7b80\u5355\u7684\u539f\u5b50\u53d8\u91cf\u64cd\u4f5c\uff0c\u8fd8\u53ef\u4ee5\u4f7f\u7528 Atomic \u539f\u5b50\u7c7b\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5bf9\u4e8e\u7ebf\u7a0b\u72ec\u7acb\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528 ThreadLocal \u6765\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u63d0\u4f9b\u4e13\u5c5e\u7684\u53d8\u91cf\u526f\u672c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5bf9\u4e8e\u9700\u8981\u5e76\u53d1\u5bb9\u5668\u7684\u5730\u65b9\uff0c\u53ef\u4ee5\u4f7f\u7528 ConcurrentHashMap\u3001CopyOnWriteArrayList \u7b49\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u6709\u4e2aint\u7684\u53d8\u91cf\u4e3a0\uff0c\u5341\u4e2a\u7ebf\u7a0b\u8f6e\u6d41\u5bf9\u5176\u8fdb\u884c++\u64cd\u4f5c\uff08\u5faa\u73af10000\u6b21\uff09\uff0c\u7ed3\u679c\u5927\u4e8e10 \u4e07\u8fd8\u662f\u5c0f\u4e8e\u7b49\u4e8e10\u4e07\uff0c\u4e3a\u4ec0\u4e48\uff1f\r\n\u5728\u8fd9\u4e2a\u573a\u666f\u4e2d\uff0c\u6700\u7ec8\u7684\u7ed3\u679c\u4f1a\u5c0f\u4e8e 100000\uff0c\u539f\u56e0\u662f\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\uff0c++ \u64cd\u4f5c\u5e76\u4e0d\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\uff0c\u800c\u662f\u5206\u4e3a\u8bfb\u53d6\u3001\u52a0 1\u3001\u5199\u56de\u4e09\u4e2a\u6b65\u9aa4\u3002\r\n\u8bfb\u53d6\u53d8\u91cf\u7684\u503c -> \u5c06\u8bfb\u53d6\u5230\u7684\u503c\u52a0 -> \u5c06\u7ed3\u679c\u5199\u56de\u53d8\u91cf\u3002\r\n\u8fd9\u6837\u7684\u8bdd\uff0c\u5c31\u4f1a\u6709\u591a\u4e2a\u7ebf\u7a0b\u8bfb\u53d6\u5230\u76f8\u540c\u7684\u503c\uff0c\u7136\u540e\u5bf9\u8fd9\u4e2a\u503c\u8fdb\u884c\u52a0 1 \u64cd\u4f5c\uff0c\u6700\u7ec8\u5bfc\u81f4\u7ed3\u679c\u5c0f\u4e8e 100000\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u8be6\u7ec6\u89e3\u91ca\u4e0b\u3002\r\n\u591a\u4e2a\u7ebf\u7a0b\u5728\u5e76\u53d1\u6267\u884c ++ \u64cd\u4f5c\u65f6\uff0c\u53ef\u80fd\u51fa\u73b0\u4ee5\u4e0b\u7ade\u6001\u6761\u4ef6\uff1a\r\n\u7ebf\u7a0b 1 \u8bfb\u53d6\u53d8\u91cf\u503c\u4e3a 0\u3002\r\n\u7ebf\u7a0b 2 \u4e5f\u8bfb\u53d6\u53d8\u91cf\u503c\u4e3a 0\u3002\r\n\u7ebf\u7a0b 1 \u8fdb\u884c\u52a0\u6cd5\u8fd0\u7b97\u5e76\u5c06\u7ed3\u679c 1 \u5199\u56de\u53d8\u91cf\u3002\r\n\u7ebf\u7a0b 2 \u8fdb\u884c\u52a0\u6cd5\u8fd0\u7b97\u5e76\u5c06\u7ed3\u679c 1 \u5199\u56de\u53d8\u91cf\uff0c\u8986\u76d6\u4e86\u7ebf\u7a0b 1 \u7684\u7ed3\u679c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u901a\u8fc7 synchronized \u5173\u952e\u5b57\u4e3a ++ \u64cd\u4f5c\u52a0\u9501\u3002\r\n\u6216\u8005\u4f7f\u7528 AtomicInteger \u7684 incrementAndGet() \u65b9\u6cd5\u6765\u66ff\u4ee3 ++ \u64cd\u4f5c\uff0c\u4fdd\u8bc1\u53d8\u91cf\u7684\u539f\u5b50\u6027\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u573a\u666f\u6709\u4e00\u4e2a-key-\u5bf9\u5e94\u7684-value-\u662f\u4e00\u4e2ajson-\u7ed3\u6784json-\u5f53\u4e2d\u6709\u597d\u51e0\u4e2a\u5b50\u4efb\u52a1\u8fd9\u4e9b\u5b50\u4efb\u52a1\u5982\u679c\u5bf9-key-\u8fdb\u884c\u4fee\u6539\u7684\u8bdd\u4f1a\u4e0d\u4f1a\u5b58\u5728\u7ebf\u7a0b\u5b89\u5168\u7684\u95ee\u9898",children:"\u573a\u666f:\u6709\u4e00\u4e2a key \u5bf9\u5e94\u7684 value \u662f\u4e00\u4e2ajson \u7ed3\u6784\uff0cjson \u5f53\u4e2d\u6709\u597d\u51e0\u4e2a\u5b50\u4efb\u52a1\uff0c\u8fd9\u4e9b\u5b50\u4efb\u52a1\u5982\u679c\u5bf9 key \u8fdb\u884c\u4fee\u6539\u7684\u8bdd\uff0c\u4f1a\u4e0d\u4f1a\u5b58\u5728\u7ebf\u7a0b\u5b89\u5168\u7684\u95ee\u9898\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5355\u8282\u70b9\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 synchronized \u5173\u952e\u5b57\u6216 ReentrantLock \u6765\u4fdd\u8bc1\u5bf9 key \u7684\u4fee\u6539\u64cd\u4f5c\u662f\u539f\u5b50\u7684\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class KeyManager {\r\n    private final ReentrantLock lock = new ReentrantLock();\r\n\r\n    private String key = "{\\"tasks\\": [\\"task1\\", \\"task2\\"]}";\r\n\r\n    public String readKey() {\r\n        lock.lock();\r\n        try {\r\n            return key;\r\n        } finally {\r\n            lock.unlock();\r\n        }\r\n    }\r\n\r\n    public void updateKey(String newKey) {\r\n        lock.lock();\r\n        try {\r\n            this.key = newKey;\r\n        } finally {\r\n            lock.unlock();\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u591a\u8282\u70b9\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u5206\u5e03\u5f0f\u9501 Redisson \u6765\u4fdd\u8bc1\u5bf9 key \u7684\u4fee\u6539\u64cd\u4f5c\u662f\u539f\u5b50\u7684\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class DistributedKeyManager {\r\n    private final RedissonClient redisson;\r\n\r\n    public DistributedKeyManager() {\r\n        Config config = new Config();\r\n        config.useSingleServer().setAddress("redis://127.0.0.1:6379");\r\n        this.redisson = Redisson.create(config);\r\n    }\r\n\r\n    public void updateKey(String key, String newValue) {\r\n        RLock lock = redisson.getLock(key);\r\n        lock.lock();\r\n        try {\r\n            // \u6a21\u62df\u8bfb\u53d6\u548c\u66f4\u65b0\u64cd\u4f5c\r\n            String currentValue = readFromDatabase(key); // \u5047\u8bbe\u8bfb\u53d6 JSON \u6570\u636e\r\n            String updatedValue = modifyJson(currentValue, newValue); // \u4fee\u6539 JSON\r\n            writeToDatabase(key, updatedValue); // \u5199\u56de\u6570\u636e\u5e93\r\n        } finally {\r\n            lock.unlock();\r\n        }\r\n    }\r\n\r\n    private String readFromDatabase(String key) {\r\n        // \u6a21\u62df\u4ece\u6570\u636e\u5e93\u8bfb\u53d6\r\n        return "{\\"tasks\\": [\\"task1\\", \\"task2\\"]}";\r\n    }\r\n\r\n    private String modifyJson(String json, String newValue) {\r\n        // \u4f7f\u7528 JSON \u5e93\u89e3\u6790\u5e76\u4fee\u6539\r\n        return json.replace("task1", newValue);\r\n    }\r\n\r\n    private void writeToDatabase(String key, String value) {\r\n        // \u6a21\u62df\u5199\u56de\u6570\u636e\u5e93\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u4f7f\u7528\u573a\u666f",children:"\u8bf4\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u4f7f\u7528\u573a\u666f\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5355\u4f8b\u6a21\u5f0f\u3002\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\uff0c\u5982\u679c\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u5c1d\u8bd5\u521b\u5efa\u5b9e\u4f8b\uff0c\u5355\u4f8b\u7c7b\u5fc5\u987b\u786e\u4fdd\u53ea\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\uff0c\u5e76\u63d0\u4f9b\u4e00\u4e2a\u5168\u5c40\u8bbf\u95ee\u70b9\u3002\r\n\u997f\u6c49\u5f0f\u662f\u4e00\u79cd\u6bd4\u8f83\u76f4\u63a5\u7684\u5b9e\u73b0\u65b9\u5f0f\uff0c\u5b83\u901a\u8fc7\u5728\u7c7b\u52a0\u8f7d\u65f6\u5c31\u7acb\u5373\u521d\u59cb\u5316\u5355\u4f8b\u5bf9\u8c61\u6765\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class Singleton {\r\n    private static final Singleton instance = new Singleton();\r\n\r\n    private Singleton() {\r\n    }\r\n\r\n    public static Singleton getInstance() {\r\n        return instance;\r\n    }\r\n}\r\n\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u61d2\u6c49\u5f0f\u5355\u4f8b\u5219\u5728\u7b2c\u4e00\u6b21\u4f7f\u7528\u65f6\u521d\u59cb\u5316\u5355\u4f8b\u5bf9\u8c61\uff0c\u8fd9\u79cd\u65b9\u5f0f\u9700\u8981\u4f7f\u7528\u53cc\u91cd\u68c0\u67e5\u9501\u5b9a\u6765\u786e\u4fdd\u7ebf\u7a0b\u5b89\u5168\uff0c\r\nvolatile \u5173\u952e\u5b57\u7528\u6765\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0csyncronized \u5173\u952e\u5b57\u7528\u6765\u4fdd\u8bc1\u540c\u6b65\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class LazySingleton {\r\n    private static volatile LazySingleton instance;\r\n\r\n    private LazySingleton() {\r\n    }\r\n\r\n    public static LazySingleton getInstance() {\r\n        if (instance == null) { // \u7b2c\u4e00\u6b21\u68c0\u67e5\r\n            synchronized (LazySingleton.class) {\r\n                if (instance == null) { // \u7b2c\u4e8c\u6b21\u68c0\u67e5\r\n                    instance = new LazySingleton();\r\n                }\r\n            }\r\n        }\r\n        return instance;\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u80fd\u8bf4\u4e00\u4e0b-hashtable-\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u5417",children:"\u80fd\u8bf4\u4e00\u4e0b Hashtable \u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e0e HashMap \u7c7b\u4f3c\uff0cHashtable \u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u4e5f\u662f\u4e00\u4e2a\u6570\u7ec4\u52a0\u4e0a\u94fe\u8868\u7684\u65b9\u5f0f\uff0c\u7136\u540e\u901a\u8fc7 synchronized \u52a0\u9501\u6765\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"threadlocal",children:"ThreadLocal"}),"\n",(0,t.jsx)(e.p,{children:"\u63a8\u8350\u9605\u8bfb\uff1aThreadLocal \u5168\u9762\u89e3\u6790"}),"\n",(0,t.jsx)(e.h3,{id:"threadlocal-\u662f\u4ec0\u4e48",children:"\ud83c\udf1fThreadLocal \u662f\u4ec0\u4e48\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["ThreadLocal \u662f\u4e00\u79cd\u7528\u4e8e\u5b9e\u73b0\u7ebf\u7a0b\u5c40\u90e8\u53d8\u91cf\u7684\u5de5\u5177\u7c7b\u3002\u5b83\u5141\u8bb8\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u62e5\u6709\u81ea\u5df1\u7684\u72ec\u7acb\u526f\u672c\uff0c\u4ece\u800c\u5b9e\u73b0\u7ebf\u7a0b\u9694\u79bb\u3002\r\n",(0,t.jsx)(e.img,{alt:"ThreadLocal",src:r(23067).A+"",width:"666",height:"468"}),"\r\n\u4f7f\u7528 ThreadLocal \u901a\u5e38\u5206\u4e3a\u56db\u6b65\uff1a\r\n\u2460\u3001\u521b\u5efa ThreadLocal\r\n//\u521b\u5efa\u4e00\u4e2aThreadLocal\u53d8\u91cf\r\n",(0,t.jsx)(e.code,{children:"public static ThreadLocal<String> localVariable = new ThreadLocal<>();"}),"\r\n\u2461\u3001\u8bbe\u7f6e ThreadLocal \u7684\u503c\r\n//\u8bbe\u7f6eThreadLocal\u53d8\u91cf\u7684\u503c\r\n",(0,t.jsx)(e.code,{children:'localVariable.set("\u6c89\u9ed8\u738b\u4e8c\u662f\u6c99\u96d5");'}),"\r\n\u2462\u3001\u83b7\u53d6 ThreadLocal \u7684\u503c\r\n//\u83b7\u53d6ThreadLocal\u53d8\u91cf\u7684\u503c\r\n",(0,t.jsx)(e.code,{children:"String value = localVariable.get();"}),"\r\n\u2463\u3001\u5220\u9664 ThreadLocal \u7684\u503c\r\n//\u5220\u9664ThreadLocal\u53d8\u91cf\u7684\u503c\r\n",(0,t.jsx)(e.code,{children:"localVariable.remove();"})]}),"\n",(0,t.jsx)(e.p,{children:"\u5728 Web \u5e94\u7528\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 ThreadLocal \u5b58\u50a8\u7528\u6237\u4f1a\u8bdd\u4fe1\u606f\uff0c\u8fd9\u6837\u6bcf\u4e2a\u7ebf\u7a0b\u5728\u5904\u7406\u7528\u6237\u8bf7\u6c42\u65f6\u90fd\u80fd\u65b9\u4fbf\u5730\u8bbf\u95ee\u5f53\u524d\u7528\u6237\u7684\u4f1a\u8bdd\u4fe1\u606f\u3002\r\n\u5728\u6570\u636e\u5e93\u64cd\u4f5c\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528 ThreadLocal \u5b58\u50a8\u6570\u636e\u5e93\u8fde\u63a5\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u6709\u81ea\u5df1\u72ec\u7acb\u7684\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u4ece\u800c\u907f\u514d\u4e86\u591a\u7ebf\u7a0b\u7ade\u4e89\u540c\u4e00\u6570\u636e\u5e93\u8fde\u63a5\u7684\u95ee\u9898\u3002\r\n\u5728\u683c\u5f0f\u5316\u64cd\u4f5c\u4e2d\uff0c\u4f8b\u5982\u65e5\u671f\u683c\u5f0f\u5316\uff0c\u53ef\u4ee5\u4f7f\u7528 ThreadLocal \u5b58\u50a8 SimpleDateFormat \u5b9e\u4f8b\uff0c\u907f\u514d\u591a\u7ebf\u7a0b\u5171\u4eab\u540c\u4e00\u5b9e\u4f8b\u5bfc\u81f4\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"threadlocal-\u6709\u54ea\u4e9b\u4f18\u70b9",children:"ThreadLocal \u6709\u54ea\u4e9b\u4f18\u70b9\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u6bcf\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u7684\u53d8\u91cf\u526f\u672c\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u907f\u514d\u4e86\u5171\u4eab\u53d8\u91cf\u5f15\u8d77\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u3002\u7531\u4e8e ThreadLocal \u5b9e\u73b0\u4e86\u53d8\u91cf\u7684\u7ebf\u7a0b\u72ec\u5360\uff0c\u4f7f\u5f97\u53d8\u91cf\u4e0d\u9700\u8981\u540c\u6b65\u5904\u7406\uff0c\u56e0\u6b64\u80fd\u591f\u907f\u514d\u8d44\u6e90\u7ade\u4e89\u3002\r\nThreadLocal \u53ef\u7528\u4e8e\u8de8\u65b9\u6cd5\u3001\u8de8\u7c7b\u65f6\u4f20\u9012\u4e0a\u4e0b\u6587\u6570\u636e\uff0c\u4e0d\u9700\u8981\u5728\u65b9\u6cd5\u95f4\u4f20\u9012\u53c2\u6570\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u4f60\u5728\u5de5\u4f5c\u4e2d\u7528\u5230\u8fc7-threadlocal-\u5417",children:"\u4f60\u5728\u5de5\u4f5c\u4e2d\u7528\u5230\u8fc7 ThreadLocal \u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u6709\u7528\u5230\u8fc7\uff0c\u7528\u6765\u5b58\u50a8\u7528\u6237\u4fe1\u606f\u3002\r\n\u6280\u672f\u6d3e\u5b9e\u6218\u9879\u76ee\u662f\u5178\u578b\u7684 MVC \u67b6\u6784\uff0c\u767b\u5f55\u540e\u7684\u7528\u6237\u6bcf\u6b21\u8bbf\u95ee\u63a5\u53e3\uff0c\u90fd\u4f1a\u5728\u8bf7\u6c42\u5934\u4e2d\u643a\u5e26\u4e00\u4e2a token\uff0c\u5728\u63a7\u5236\u5c42\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\r\ntoken\uff0c\u89e3\u6790\u51fa\u7528\u6237\u7684\u57fa\u672c\u4fe1\u606f\u3002\r\n\u5047\u5982\u5728\u670d\u52a1\u5c42\u548c\u6301\u4e45\u5c42\u4e5f\u8981\u7528\u5230\u7528\u6237\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u5728\u63a7\u5236\u5c42\u62e6\u622a\u8bf7\u6c42\u628a\u7528\u6237\u4fe1\u606f\u5b58\u5165 ThreadLocal\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"threadlocal-\u600e\u4e48\u5b9e\u73b0\u7684\u5462",children:"\ud83c\udf1fThreadLocal \u600e\u4e48\u5b9e\u73b0\u7684\u5462\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u6211\u4eec\u521b\u5efa\u4e00\u4e2a ThreadLocal \u5bf9\u8c61\u5e76\u8c03\u7528 set \u65b9\u6cd5\u65f6\uff0c\u5176\u5b9e\u662f\u5728\u5f53\u524d\u7ebf\u7a0b\u4e2d\u521d\u59cb\u5316\u4e86\u4e00\u4e2a ThreadLocalMap\u3002\r\nThreadLocalMap \u662f ThreadLocal \u7684\u4e00\u4e2a\u9759\u6001\u5185\u90e8\u7c7b\uff0c\u5b83\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a Entry \u6570\u7ec4\uff0ckey \u662f ThreadLocal \u5bf9\u8c61\uff0cvalue\r\n\u662f\u7ebf\u7a0b\u7684\u5c40\u90e8\u53d8\u91cf\uff0c\u8fd9\u6837\u5c31\u76f8\u5f53\u4e8e\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u7ef4\u62a4\u4e86\u4e00\u4e2a\u53d8\u91cf\u526f\u672c\u3002"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"ThreadLocal\u539f\u7406",src:r(32328).A+"",width:"776",height:"467"}),"\r\nEntry \u7ee7\u627f\u4e86 WeakReference\uff0c\u5b83\u9650\u5b9a\u4e86 key \u662f\u4e00\u4e2a\u5f31\u5f15\u7528\uff0c\u5f31\u5f15\u7528\u7684\u597d\u5904\u662f\u5f53\u5185\u5b58\u4e0d\u8db3\u65f6\uff0cJVM \u4f1a\u56de\u6536 ThreadLocal \u5bf9\u8c61\uff0c\u5e76\u4e14\u5c06\u5176\u5bf9\u5e94\u7684\r\nEntry.value \u8bbe\u7f6e\u4e3a null\uff0c\u8fd9\u6837\u53ef\u4ee5\u5728\u5f88\u5927\u7a0b\u5ea6\u4e0a\u907f\u514d\u5185\u5b58\u6cc4\u6f0f\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static class Entry extends WeakReference<ThreadLocal<?>> {\r\n    /** The value associated with this ThreadLocal. */\r\n    Object value;\r\n\r\n    //\u8282\u70b9\u7c7b\r\n    Entry(ThreadLocal<?> k, Object v) {\r\n        //key\u8d4b\u503c\r\n        super(k);\r\n        //value\u8d4b\u503c\r\n        value = v;\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u603b\u7ed3\u4e00\u4e0b\uff1a\r\nThreadLocal \u7684\u5b9e\u73b0\u539f\u7406\u662f\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u7ef4\u62a4\u4e00\u4e2a Map\uff0ckey \u4e3a ThreadLocal \u5bf9\u8c61\uff0cvalue \u4e3a\u60f3\u8981\u5b9e\u73b0\u7ebf\u7a0b\u9694\u79bb\u7684\u5bf9\u8c61\u3002\r\n1\u3001\u901a\u8fc7 ThreadLocal \u7684 set \u65b9\u6cd5\u5c06\u5bf9\u8c61\u5b58\u5165 Map \u4e2d\u3002\r\n2\u3001\u901a\u8fc7 ThreadLocal \u7684 get \u65b9\u6cd5\u4ece Map \u4e2d\u53d6\u51fa\u5bf9\u8c61\u3002\r\n3\u3001Map \u7684\u5927\u5c0f\u7531 ThreadLocal \u5bf9\u8c61\u7684\u591a\u5c11\u51b3\u5b9a\u3002\r\n",(0,t.jsx)(e.img,{alt:"ThreadLocal\u7ed3\u6784",src:r(62558).A+"",width:"1182",height:"1534"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u5f31\u5f15\u7528\u4ec0\u4e48\u662f\u5f3a\u5f15\u7528",children:"\u4ec0\u4e48\u662f\u5f31\u5f15\u7528\uff0c\u4ec0\u4e48\u662f\u5f3a\u5f15\u7528\uff1f"}),"\n",(0,t.jsx)(e.p,{children:'\u6211\u5148\u8bf4\u4e00\u4e0b\u5f3a\u5f15\u7528\uff0c\u6bd4\u5982 User user = new User("\u6c89\u9ed8\u738b\u4e8c") \u4e2d\uff0cuser \u5c31\u662f\u4e00\u4e2a\u5f3a\u5f15\u7528\uff0cnew User("\u6c89\u9ed8\u738b\u4e8c") \u5c31\u662f\u5f3a\u5f15\u7528\u5bf9\u8c61\u3002\r\n\u5f53 user \u88ab\u7f6e\u4e3a null \u65f6\uff08user = null\uff09\uff0cnew User("\u6c89\u9ed8\u738b\u4e8c") \u5bf9\u8c61\u5c31\u4f1a\u88ab\u5783\u573e\u56de\u6536\uff1b\u5426\u5219\u5373\u4fbf\u662f\u5185\u5b58\u7a7a\u95f4\u4e0d\u8db3\uff0cJVM \u4e5f\u4e0d\u4f1a\u56de\u6536 new\r\nUser("\u6c89\u9ed8\u738b\u4e8c") \u8fd9\u4e2a\u5f3a\u5f15\u7528\u5bf9\u8c61\uff0c\u5b81\u613f\u629b\u51fa OutOfMemoryError\u3002\r\n\u5f31\u5f15\u7528\uff0c\u6bd4\u5982\u8bf4\u5728\u4f7f\u7528 ThreadLocal \u4e2d\uff0cEntry \u7684 key \u5c31\u662f\u4e00\u4e2a\u5f31\u5f15\u7528\u5bf9\u8c61\u3002'}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public static void main(String[] args) {\r\n    ThreadLocal<User> userThreadLocal = new ThreadLocal<>();\r\n    userThreadLocal.set(new User("\u6c89\u9ed8\u738b\u4e8c"));\r\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["userThreadLocal \u662f\u4e00\u4e2a\u5f3a\u5f15\u7528\uff0c",(0,t.jsx)(e.code,{children:"new ThreadLocal<>()"}),' \u662f\u4e00\u4e2a\u5f3a\u5f15\u7528\u5bf9\u8c61\uff1b\r\nnew User("\u6c89\u9ed8\u738b\u4e8c") \u662f\u4e00\u4e2a\u5f3a\u5f15\u7528\u5bf9\u8c61\u3002\r\n\u8c03\u7528 set \u65b9\u6cd5\u540e\uff0c\u4f1a\u5c06 ',(0,t.jsx)(e.code,{children:"key = new ThreadLocal<>()"})," \u653e\u5165 ThreadLocalMap \u4e2d\uff0c\u6b64\u65f6\u7684 key \u662f\u4e00\u4e2a\u5f31\u5f15\u7528\u5bf9\u8c61\u3002\u5f53 JVM\r\n\u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u5982\u679c\u53d1\u73b0\u4e86\u5f31\u5f15\u7528\u5bf9\u8c61\uff0c\u5c31\u4f1a\u5c06\u5176\u56de\u6536\u3002\r\n",(0,t.jsx)(e.img,{alt:"ThreadLocal\u5bf9\u8c61\u5f15\u7528",src:r(26898).A+"",width:"930",height:"404"}),"\r\n\u5176\u5173\u7cfb\u94fe\u5c31\u662f\uff1a\r\nThreadLocal \u5f3a\u5f15\u7528 -> ThreadLocal \u5bf9\u8c61\u3002\r\nThread \u5f3a\u5f15\u7528 -> ThreadLocalMap\u3002\r\nThreadLocalMap[i] \u5f3a\u5f15\u7528\u4e86 -> Entry\u3002\r\nEntry.key \u5f31\u5f15\u7528 -> ThreadLocal \u5bf9\u8c61\u3002\r\nEntry.value \u5f3a\u5f15\u7528 -> \u7ebf\u7a0b\u7684\u5c40\u90e8\u53d8\u91cf\u5bf9\u8c61\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"threadlocal-\u5185\u5b58\u6cc4\u9732\u662f\u600e\u4e48\u56de\u4e8b",children:"\ud83c\udf1fThreadLocal \u5185\u5b58\u6cc4\u9732\u662f\u600e\u4e48\u56de\u4e8b\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["ThreadLocalMap \u7684 Key \u662f \u5f31\u5f15\u7528(\u6240\u4ee5\u5982\u679c\u5bf9\u5e94\u7684ThreadLocal\u5bf9\u8c61\u88ab\u91ca\u653e\u4e86\uff0ckey\u5c31\u80fd\u968f\u7740\u88ab\u91ca\u653e)\uff0c\r\n\u4f46 Value \u662f\u5f3a\u5f15\u7528\u3002 \u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u4e00\u76f4\u5728\u8fd0\u884c\uff0c\u5e76\u4e14 value \u4e00\u76f4\u6307\u5411\u67d0\u4e2a\u5f3a\u5f15\u7528\u5bf9\u8c61\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u4e0d\u4f1a\u88ab\u56de\u6536\uff0c\u4ece\u800c\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\u3002\r\n",(0,t.jsx)(e.img,{alt:"ThreadLocalMap",src:r(90121).A+"",width:"960",height:"954"}),"\r\n\u90a3\u600e\u4e48\u89e3\u51b3\u5185\u5b58\u6cc4\u6f0f\u95ee\u9898\u5462\uff1f\r\n\u5f88\u7b80\u5355\uff0c\u4f7f\u7528\u5b8c ThreadLocal \u540e\uff0c\u53ca\u65f6\u8c03\u7528 remove() \u65b9\u6cd5\u91ca\u653e\u5185\u5b58\u7a7a\u95f4\u3002\r\nremove() \u4f1a\u8c03\u7528 ThreadLocalMap \u7684 remove \u65b9\u6cd5\u904d\u5386\u54c8\u5e0c\u8868\uff0c\u627e\u5230 key \u7b49\u4e8e\u5f53\u524d ThreadLocal \u7684 Entry\uff0c\u627e\u5230\u540e\u4f1a\u8c03\u7528 Entry \u7684\r\nclear \u65b9\u6cd5\uff0c\u5c06 Entry \u7684 value \u8bbe\u7f6e\u4e3a null\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void remove(ThreadLocal<?> key) {\r\n    Entry[] tab = table;\r\n    int len = tab.length;\r\n    // \u8ba1\u7b97 key \u7684 hash \u503c\r\n    int i = key.threadLocalHashCode & (len - 1);\r\n    // \u904d\u5386\u6570\u7ec4\uff0c\u627e\u5230 key \u4e3a null \u7684 Entry\r\n    for (Entry e = tab[i];\r\n         e != null;\r\n         e = tab[i = nextIndex(i, len)]) {\r\n        if (e.get() == key) {\r\n            // \u5c06\u8be5 Entry \u7684 key \u7f6e\u4e3a null\uff08\u5373 Entry \u5931\u6548\uff09\r\n            e.clear();\r\n            // \u6e05\u7406\u8fc7\u671f\u7684 entry\r\n            expungeStaleEntry(i);\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\npublic void clear() {\r\n    this.referent = null;\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u7136\u540e\u6267\u884c expungeStaleEntry() \u65b9\u6cd5\uff0c\u6e05\u9664 key \u4e3a null \u7684 Entry\u3002\r\n",(0,t.jsx)(e.img,{alt:"expungeStaleEntry\u4ee3\u7801\u89e3\u6790",src:r(95534).A+"",width:"1324",height:"1318"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u90a3\u4e3a\u4ec0\u4e48-key-\u8981\u8bbe\u8ba1\u6210\u5f31\u5f15\u7528",children:"\u90a3\u4e3a\u4ec0\u4e48 key \u8981\u8bbe\u8ba1\u6210\u5f31\u5f15\u7528\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u5f31\u5f15\u7528\u7684\u597d\u5904\u662f\uff0c\u5f53\u5185\u5b58\u4e0d\u8db3\u7684\u65f6\u5019\uff0cJVM \u80fd\u591f\u53ca\u65f6\u56de\u6536\u6389\u5f31\u5f15\u7528\u7684\u5bf9\u8c61\u3002\r\nWeakReference key = new WeakReference(new ThreadLocal());\r\nkey \u662f\u5f31\u5f15\u7528\uff0cnew WeakReference(new ThreadLocal()) \u662f\u5f31\u5f15\u7528\u5bf9\u8c61\uff0c\u5f53 JVM \u8fdb\u884c\u5783\u573e\u56de\u6536\u65f6\uff0c\u53ea\u8981\u53d1\u73b0\u4e86\u5f31\u5f15\u7528\u5bf9\u8c61\uff0c\u5c31\u4f1a\u5c06\u5176\u56de\u6536\u3002\r\n\u4e00\u65e6 key \u88ab\u56de\u6536\uff0cThreadLocalMap \u5728\u8fdb\u884c ",(0,t.jsx)(e.strong,{children:"set\u3001get \u7684\u65f6\u5019\u5c31\u4f1a\u5bf9 key \u4e3a null \u7684 Entry \u8fdb\u884c\u6e05\u7406"}),"\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"ThreadLocalMap\u5783\u573e\u56de\u6536",src:r(93850).A+"",width:"838",height:"470"}),"\r\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u5728 ThreadLocal \u88ab\u5783\u573e\u6536\u96c6\u540e\uff0c\u4e0b\u4e00\u6b21\u8bbf\u95ee ThreadLocalMap \u65f6\uff0cJava \u4f1a\u81ea\u52a8\u6e05\u7406\u90a3\u4e9b\u952e\u4e3a null \u7684 entry\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4f1a\u5728\u6267\u884c\r\nget()\u3001set()\u3001remove()\u65f6\u89e6\u53d1\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u4f60\u4e86\u89e3\u54ea\u4e9b-threadlocal-\u7684\u6539\u8fdb\u65b9\u6848",children:"\u4f60\u4e86\u89e3\u54ea\u4e9b ThreadLocal \u7684\u6539\u8fdb\u65b9\u6848\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5728 JDK 20 Early-Access Build 28 \u7248\u672c\u4e2d\uff0c\u51fa\u73b0\u4e86 ThreadLocal \u7684\u6539\u8fdb\u65b9\u6848\uff0c\u5373 ScopedValue\u3002\r\n\u8fd8\u6709 Netty \u4e2d\u7684 FastThreadLocal\uff0c\u5b83\u662f Netty \u5bf9 ThreadLocal \u7684\u4f18\u5316\uff0c\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u7d22\u5f15\u5e38\u91cf index\uff0c\u6bcf\u6b21\u521b\u5efa FastThreadLocal\r\n\u4e2d\u90fd\u4f1a\u81ea\u52a8+1\uff0c\u7528\u6765\u53d6\u4ee3 hash \u51b2\u7a81\u5e26\u6765\u7684\u635f\u8017\uff0c\u7528\u7a7a\u95f4\u6362\u65f6\u95f4\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private final int index;\r\n\r\npublic FastThreadLocal() {\r\n    index = InternalThreadLocalMap.nextVariableIndex();\r\n}\r\n\r\npublic static int nextVariableIndex() {\r\n    int index = nextIndex.getAndIncrement();\r\n    if (index < 0) {\r\n        nextIndex.decrementAndGet();\r\n    }\r\n    return index;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4ee5\u53ca\u963f\u91cc\u7684 TransmittableThreadLocal\uff0c\u4e0d\u4ec5\u5b9e\u73b0\u4e86\u5b50\u7ebf\u7a0b\u53ef\u4ee5\u7ee7\u627f\u7236\u7ebf\u7a0b ThreadLocal \u7684\u529f\u80fd\uff0c\u5e76\u4e14\u8fd8\u53ef\u4ee5\u8de8\u7ebf\u7a0b\u6c60\u4f20\u9012\u503c\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'TransmittableThreadLocal<String> context = new TransmittableThreadLocal<>();\r\n// \u5728\u7236\u7ebf\u7a0b\u4e2d\u8bbe\u7f6e\r\ncontext.\r\n\r\nset("value-set-in-parent");\r\n\r\n// \u5728\u5b50\u7ebf\u7a0b\u4e2d\u53ef\u4ee5\u8bfb\u53d6\uff0c\u503c\u662f"value-set-in-parent"\r\nString value = context.get();\n'})}),"\n",(0,t.jsx)(e.h3,{id:"threadlocalmap-\u7684\u6e90\u7801\u770b\u8fc7\u5417",children:"ThreadLocalMap \u7684\u6e90\u7801\u770b\u8fc7\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"ThreadLocalMap \u867d\u7136\u88ab\u53eb\u505a Map\uff0c\u4f46\u5b83\u5e76\u6ca1\u6709\u5b9e\u73b0 Map \u63a5\u53e3\uff0c\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u7ebf\u6027\u63a2\u6d4b\u54c8\u5e0c\u8868\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static class ThreadLocalMap {\r\n    static class Entry extends WeakReference<ThreadLocal<?>> {\r\n        Object value;\r\n\r\n        Entry(ThreadLocal<?> k, Object v) {\r\n            super(k);  // \u8fd9\u91cc\u7684 Key \u662f WeakReference\r\n            value = v;\r\n        }\r\n    }\r\n\r\n    private Entry[] table;  // \u5b58\u50a8 ThreadLocal \u53d8\u91cf\u7684\u6570\u7ec4\r\n    private int size;       // \u5f53\u524d Entry \u6570\u91cf\r\n    private int threshold;  // \u89e6\u53d1\u6269\u5bb9\u7684\u9608\u503c\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5e95\u5c42\u7684\u6570\u636e\u7ed3\u6784\u4e5f\u662f\u6570\u7ec4\uff0c\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u662f\u4e00\u4e2a Entry \u5bf9\u8c61\uff0cEntry \u5bf9\u8c61\u7ee7\u627f\u4e86 WeakReference\uff0ckey \u662f ThreadLocal \u5bf9\u8c61\uff0cvalue\r\n\u662f\u7ebf\u7a0b\u7684\u5c40\u90e8\u53d8\u91cf\u3002\r\n",(0,t.jsx)(e.img,{alt:"ThreadLocalMap\u7ed3\u6784",src:r(43088).A+"",width:"1208",height:"474"}),"\r\n\u5f53\u8c03\u7528 ThreadLocal.set(value) \u65f6\uff0c\u4f1a\u5c06 value \u5b58\u5165 ThreadLocalMap\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public void set(T value) {\r\n    Thread t = Thread.currentThread();\r\n    ThreadLocalMap map = getMap(t);\r\n    if (map != null) {\r\n        map.set(this, value);\r\n    } else {\r\n        createMap(t, value);\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"set() \u65b9\u6cd5\u662f ThreadLocalMap \u7684\u6838\u5fc3\u65b9\u6cd5\uff0c\u901a\u8fc7 key \u7684\u54c8\u5e0c\u7801\u4e0e\u6570\u7ec4\u957f\u5ea6\u53d6\u6a21\uff0c\u8ba1\u7b97\u51fa key \u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\uff0c\u8fd9\u4e00\u70b9\u548c HashMap \u7684\u5b9e\u73b0\u7c7b\u4f3c\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void set(ThreadLocal<?> key, Object value) {\r\n    Entry[] tab = table;\r\n    int len = tab.length;\r\n    int i = key.threadLocalHashCode & (len - 1); // \u8ba1\u7b97\u7d22\u5f15\r\n\r\n    for (Entry e = tab[i]; e != null; e = tab[nextIndex(i, len)]) {\r\n        ThreadLocal<?> k = e.get();\r\n        if (k == key) { // \u5982\u679c key \u5df2\u5b58\u5728\uff0c\u66f4\u65b0 value\r\n            e.value = value;\r\n            return;\r\n        }\r\n        if (k == null) { // Key \u4e3a null\uff0c\u6e05\u7406\u65e0\u6548 Entry\r\n            replaceStaleEntry(key, value, i);\r\n            return;\r\n        }\r\n    }\r\n\r\n    tab[i] = new Entry(key, value); // \u76f4\u63a5\u63d2\u5165 Entry\r\n    size++;\r\n    if (size >= threshold) {\r\n        rehash();\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"threadLocalHashCode \u7684\u8ba1\u7b97\u6709\u70b9\u4e1c\u897f\uff0c\u6bcf\u521b\u5efa\u4e00\u4e2a ThreadLocal \u5bf9\u8c61\uff0c\u5b83\u5c31\u4f1a\u65b0\u589e\u4e00\u4e2a\u9ec4\u91d1\u5206\u5272\u6570\uff0c\u53ef\u4ee5\u8ba9\u54c8\u5e0c\u7801\u5206\u5e03\u7684\u975e\u5e38\u5747\u5300\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private static final int HASH_INCREMENT = 0x61c88647;\r\n\r\nprivate static int nextHashCode() {\r\n    return nextHashCode.getAndAdd(HASH_INCREMENT);\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u8c03\u7528 ThreadLocal.get() \u65f6\uff0c\u4f1a\u8c03\u7528 ThreadLocalMap \u7684 getEntry() \u65b9\u6cd5\uff0c\u6839\u636e key \u7684\u54c8\u5e0c\u7801\u627e\u5230\u5bf9\u5e94\u7684\u7ebf\u7a0b\u5c40\u90e8\u53d8\u91cf\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private Entry getEntry(ThreadLocal<?> key) {\r\n    int i = key.threadLocalHashCode & (table.length - 1);\r\n    Entry e = table[i];\r\n\r\n    if (e != null && e.get() == key) { // \u5982\u679c key \u5b58\u5728\uff0c\u76f4\u63a5\u8fd4\u56de\r\n        return e;\r\n    } else {\r\n        return getEntryAfterMiss(key, i, e); // \u7ee7\u7eed\u67e5\u627e\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u8c03\u7528 ThreadLocal.remove() \u65f6\uff0c\u4f1a\u8c03\u7528 ThreadLocalMap \u7684 remove() \u65b9\u6cd5\uff0c\u6839\u636e key \u7684\u54c8\u5e0c\u7801\u627e\u5230\u5bf9\u5e94\u7684\u7ebf\u7a0b\u5c40\u90e8\u53d8\u91cf\uff0c\u5c06\u5176\u6e05\u9664\uff0c\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void remove(ThreadLocal<?> key) {\r\n    Entry[] tab = table;\r\n    int len = tab.length;\r\n    int i = key.threadLocalHashCode & (len - 1);\r\n\r\n    for (Entry e = tab[i]; e != null; e = tab[nextIndex(i, len)]) {\r\n        if (e.get() == key) {\r\n            e.clear(); // \u6e05\u9664 WeakReference\r\n            e.value = null; // \u91ca\u653e Value\r\n            expungeStaleEntries();\r\n            return;\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"threadlocalmap-\u600e\u4e48\u89e3\u51b3-hash-\u51b2\u7a81\u7684",children:"ThreadLocalMap \u600e\u4e48\u89e3\u51b3 Hash \u51b2\u7a81\u7684\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f00\u653e\u5b9a\u5740\u6cd5\u3002\r\n\u5982\u679c\u8ba1\u7b97\u5f97\u5230\u7684\u69fd\u4f4d i \u5df2\u7ecf\u88ab\u5360\u7528\uff0cThreadLocalMap \u4f1a\u91c7\u7528\u5f00\u653e\u5730\u5740\u6cd5\u4e2d\u7684\u7ebf\u6027\u63a2\u6d4b\u6765\u5bfb\u627e\u4e0b\u4e00\u4e2a\u7a7a\u95f2\u69fd\u4f4d\uff1a\r\n\u5982\u679c i \u4f4d\u7f6e\u88ab\u5360\u7528\uff0c\u5c1d\u8bd5 i+1\u3002\r\n\u5982\u679c i+1 \u4e5f\u88ab\u5360\u7528\uff0c\u7ee7\u7eed\u63a2\u6d4b i+2\uff0c\u76f4\u5230\u627e\u5230\u4e00\u4e2a\u7a7a\u4f4d\u3002\r\n\u5982\u679c\u5230\u8fbe\u6570\u7ec4\u672b\u5c3e\uff0c\u5219\u56de\u5230\u6570\u7ec4\u5934\u90e8\uff0c\u7ee7\u7eed\u5bfb\u627e\u7a7a\u4f4d\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private static int nextIndex(int i, int len) {\r\n    return ((i + 1 < len) ? i + 1 : 0);\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u4e3a\u4ec0\u4e48\u8981\u7528\u7ebf\u6027\u63a2\u6d4b\u6cd5\u800c\u4e0d\u662fHashMap \u7684\u62c9\u94fe\u6cd5\u6765\u89e3\u51b3\u54c8\u5e0c\u51b2\u7a81\uff1f\r\nThreadLocalMap \u8bbe\u8ba1\u7684\u76ee\u7684\u662f\u5b58\u50a8\u7ebf\u7a0b\u79c1\u6709\u6570\u636e\uff0c\u4e0d\u4f1a\u6709\u5927\u91cf\u7684 Key\uff0c\u6240\u4ee5\u91c7\u7528\u7ebf\u6027\u63a2\u6d4b\u66f4\u8282\u7701\u7a7a\u95f4\u3002\r\n\u62c9\u94fe\u6cd5\u8fd8\u9700\u8981\u5355\u72ec\u7ef4\u62a4\u4e00\u4e2a\u94fe\u8868\uff0c\u751a\u81f3\u7ea2\u9ed1\u6811\uff0c\u4e0d\u9002\u5408 ThreadLocal \u8fd9\u79cd\u573a\u666f\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u5f00\u653e\u5730\u5740\u6cd5\u4e86\u89e3\u5417",children:"\u5f00\u653e\u5730\u5740\u6cd5\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u8fd9\u4e2a\u5751\u88ab\u4eba\u5360\u4e86\uff0c\u90a3\u5c31\u63a5\u7740\u53bb\u627e\u7a7a\u7740\u7684\u5751\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u5f00\u653e\u5730\u5740\u6cd5",src:r(82137).A+"",width:"1002",height:"448"}),"\r\n\u5982\u679c\u6211\u4eec\u63d2\u5165\u4e00\u4e2a value=27 \u7684\u6570\u636e\uff0c\u901a\u8fc7 hash \u8ba1\u7b97\u540e\u5e94\u8be5\u843d\u5165\u7b2c 4 \u4e2a\u69fd\u4f4d\uff0c\u800c\u69fd\u4f4d 4 \u5df2\u7ecf\u6709\u6570\u636e\u4e86\uff0c\u800c\u4e14 key \u548c\u5f53\u524d\u7684\u4e0d\u7b49\u3002\r\n\u6b64\u65f6\u5c31\u4f1a\u7ebf\u6027\u5411\u540e\u67e5\u627e\uff0c\u4e00\u76f4\u627e\u5230 Entry \u4e3a null \u7684\u69fd\u4f4d\u624d\u4f1a\u505c\u6b62\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"threadlocalmap-\u6269\u5bb9\u673a\u5236\u4e86\u89e3\u5417",children:"ThreadLocalMap \u6269\u5bb9\u673a\u5236\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e0e HashMap \u4e0d\u540c\uff0cThreadLocalMap \u5e76\u4e0d\u4f1a\u76f4\u63a5\u5728\u5143\u7d20\u6570\u91cf\u8fbe\u5230\u9608\u503c\u65f6\u7acb\u5373\u6269\u5bb9\uff0c\u800c\u662f\u5148\u6e05\u7406\u88ab GC \u56de\u6536\u7684 key\uff0c\u7136\u540e\u5728\u586b\u5145\u7387\u8fbe\u5230\u56db\u5206\u4e4b\u4e09\u65f6\u8fdb\u884c\u6269\u5bb9\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void rehash() {\r\n    // \u6e05\u7406\u88ab GC \u56de\u6536\u7684 key\r\n    expungeStaleEntries();\r\n\r\n    //\u6269\u5bb9\r\n    if (size >= threshold - threshold / 4)\r\n        resize();\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6e05\u7406\u8fc7\u7a0b\u4f1a\u904d\u5386\u6574\u4e2a\u6570\u7ec4\uff0c\u5c06 key \u4e3a null \u7684 Entry \u6e05\u9664\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void expungeStaleEntries() {\r\n    Entry[] tab = table;\r\n    int len = tab.length;\r\n    for (int j = 0; j < len; j++) {\r\n        Entry e = tab[j];\r\n        // \u5982\u679c key \u4e3a null\uff0c\u6e05\u7406 Entry\r\n        if (e != null && e.get() == null)\r\n            expungeStaleEntry(j);\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u9608\u503c threshold \u7684\u9ed8\u8ba4\u503c\u662f\u6570\u7ec4\u957f\u5ea6\u7684\u4e09\u5206\u4e4b\u4e8c\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void setThreshold(int len) {\r\n    threshold = len * 2 / 3;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6269\u5bb9\u65f6\uff0c\u4f1a\u5c06\u6570\u7ec4\u957f\u5ea6\u7ffb\u500d\uff0c\u7136\u540e\u91cd\u65b0\u8ba1\u7b97\u6bcf\u4e2a Entry \u7684\u4f4d\u7f6e\uff0c\u91c7\u7528\u7ebf\u6027\u63a2\u6d4b\u6cd5\u6765\u5bfb\u627e\u65b0\u7684\u7a7a\u4f4d\uff0c\u7136\u540e\u5c06 Entry \u653e\u5165\u65b0\u7684\u6570\u7ec4\u4e2d\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{children:"private void resize() {\r\n    Entry[] oldTab = table;\r\n    int oldLen = oldTab.length;\r\n    // \u6269\u5bb9\u4e3a\u539f\u6765\u7684\u4e24\u500d\r\n    int newLen = oldLen * 2;\r\n    Entry[] newTab = new Entry[newLen];\r\n  \r\n    int count = 0;\r\n    // \u904d\u5386\u8001\u6570\u7ec4\r\n    for (int j = 0; j < oldLen; ++j) {\r\n        Entry e = oldTab[j];\r\n        if (e != null) {\r\n            ThreadLocal<?> k = e.get();\r\n            if (k == null) {\r\n                e.value = null; // \u91ca\u653e Value\uff0c\u9632\u6b62\u5185\u5b58\u6cc4\u6f0f\r\n            } else {\r\n                // \u91cd\u65b0\u8ba1\u7b97\u4f4d\u7f6e\r\n                int h = k.threadLocalHashCode & (newLen - 1);\r\n                while (newTab[h] != null) {\r\n                    // \u7ebf\u6027\u63a2\u6d4b\u5bfb\u627e\u65b0\u4f4d\u7f6e\r\n                    h = nextIndex(h, newLen);\r\n                }\r\n                // \u653e\u5165\u65b0\u6570\u7ec4\r\n                newTab[h] = e;\r\n                count++;\r\n            }\r\n        }\r\n    }\r\n    table = newTab;\r\n    size = count;\r\n    threshold = newLen * 2 / 3; // \u91cd\u65b0\u8ba1\u7b97\u6269\u5bb9\u9608\u503c\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u4e00\u53e5\u8bdd\u603b\u7ed3\uff1aThreadLocalMap \u91c7\u7528\u7684\u662f\u201c",(0,t.jsx)(e.strong,{children:"\u5148\u6e05\u7406\u518d\u6269\u5bb9"}),"\u201d\u7684\u7b56\u7565\uff0c\u6269\u5bb9\u65f6\uff0c\u6570\u7ec4\u957f\u5ea6\u7ffb\u500d\uff0c\u5e76\u91cd\u65b0\u8ba1\u7b97\u7d22\u5f15\uff0c\u5982\u679c\u53d1\u751f\u54c8\u5e0c\u51b2\u7a81\uff0c\u91c7\u7528\u7ebf\u6027\u63a2\u6d4b\u6cd5\u6765\u89e3\u51b3\u3002\r\n",(0,t.jsx)(e.img,{alt:"ThreadLocalMap\u6269\u5bb9",src:r(24375).A+"",width:"1006",height:"358"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u7236\u7ebf\u7a0b\u80fd\u7528-threadlocal-\u7ed9\u5b50\u7ebf\u7a0b\u4f20\u503c\u5417",children:"\u7236\u7ebf\u7a0b\u80fd\u7528 ThreadLocal \u7ed9\u5b50\u7ebf\u7a0b\u4f20\u503c\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e0d\u80fd\u3002\r\n\u56e0\u4e3a ThreadLocal \u53d8\u91cf\u5b58\u50a8\u5728\u6bcf\u4e2a\u7ebf\u7a0b\u7684 ThreadLocalMap \u4e2d\uff0c\u800c\u5b50\u7ebf\u7a0b\u4e0d\u4f1a\u7ee7\u627f\u7236\u7ebf\u7a0b\u7684 ThreadLocalMap\u3002\r\n\u53ef\u4ee5\u4f7f\u7528 InheritableThreadLocal\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\r\n\u5728 Thread \u7c7b\u7684\u5b9a\u4e49\u4e2d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u4e24\u4e2a ThreadLocalMap\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public class Thread {\r\n    /* \u666e\u901a ThreadLocal \u53d8\u91cf\u5b58\u50a8\u7684\u5730\u65b9 */\r\n    ThreadLocal.ThreadLocalMap threadLocals = null;\r\n\r\n    /* InheritableThreadLocal \u53d8\u91cf\u5b58\u50a8\u7684\u5730\u65b9 */\r\n    ThreadLocal.ThreadLocalMap inheritableThreadLocals = null;\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u666e\u901a ThreadLocal \u53d8\u91cf\u5b58\u50a8\u5728 threadLocals \u4e2d\uff0c\u4e0d\u4f1a\u88ab\u5b50\u7ebf\u7a0b\u7ee7\u627f\u3002\r\nInheritableThreadLocal \u53d8\u91cf\u5b58\u50a8\u5728 inheritableThreadLocals \u4e2d\uff0c\r\n",(0,t.jsx)(e.strong,{children:"\u5f53 new Thread() \u521b\u5efa\u4e00\u4e2a\u5b50\u7ebf\u7a0b\u65f6\uff0cThread \u7684 init()"}),"\r\nps: \u7ebf\u7a0b\u6c60\u4e2d\u65e0\u6cd5\u4f7f\u7528\r\n\u65b9\u6cd5\u4f1a\u68c0\u67e5\u7236\u7ebf\u7a0b\u662f\u5426\u6709 inheritableThreadLocals\uff0c\r\n\u5982\u679c\u6709\uff0c\u5c31\u4f1a\u62f7\u8d1d InheritableThreadLocal \u53d8\u91cf\u5230\u5b50\u7ebf\u7a0b\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void init(ThreadGroup g, Runnable target, String name, long stackSize) {\r\n    // \u83b7\u53d6\u5f53\u524d\u7236\u7ebf\u7a0b\r\n    Thread parent = currentThread();\r\n    // \u590d\u5236 InheritableThreadLocal \u53d8\u91cf\r\n    if (parent.inheritableThreadLocals != null) {\r\n        this.inheritableThreadLocals =\r\n                ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u963f\u91cc\u7684",(0,t.jsx)(e.code,{children:"TransmittableThreadLocal<T>"}),"\u9700\u8981com.alibaba.ttl.threadpool.TtlExecutors\u521b\u5efa\u7684\u7ebf\u7a0b\u6c60\u624d\u884c"]}),"\n",(0,t.jsx)(e.h2,{id:"java-\u5185\u5b58\u6a21\u578b",children:"Java \u5185\u5b58\u6a21\u578b"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b\u4f60\u5bf9-java-\u5185\u5b58\u6a21\u578b\u7684\u7406\u89e3",children:"\ud83c\udf1f\u8bf4\u4e00\u4e0b\u4f60\u5bf9 Java \u5185\u5b58\u6a21\u578b\u7684\u7406\u89e3\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u63a8\u8350\u9605\u8bfb\uff1a\u8bf4\u8bf4 Java \u7684\u5185\u5b58\u6a21\u578b\r\nJava \u5185\u5b58\u6a21\u578b\u662f Java \u865a\u62df\u673a\u89c4\u8303\u4e2d\u5b9a\u4e49\u7684\u4e00\u4e2a\u62bd\u8c61\u6a21\u578b\uff0c\u7528\u6765\u63cf\u8ff0\u591a\u7ebf\u7a0b\u73af\u5883\u4e2d\u5171\u4eab\u53d8\u91cf\u7684\u5185\u5b58\u53ef\u89c1\u6027\u3002\r\n",(0,t.jsx)(e.img,{alt:"JAVA\u5185\u5b58\u6a21\u578b",src:r(76663).A+"",width:"1278",height:"998"})]}),"\n",(0,t.jsxs)(e.p,{children:["\u5171\u4eab\u53d8\u91cf\u5b58\u50a8\u5728\u4e3b\u5185\u5b58\u4e2d\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u4e00\u4e2a\u79c1\u6709\u7684\u672c\u5730\u5185\u5b58\uff0c\u5b58\u50a8\u4e86\u5171\u4eab\u53d8\u91cf\u7684\u526f\u672c\u3002\r\n\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u66f4\u6539\u4e86\u672c\u5730\u5185\u5b58\u4e2d\u5171\u4eab\u53d8\u91cf\u7684\u526f\u672c\uff0c\u5b83\u9700\u8981 JVM \u5237\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d\uff0c\u4ee5\u786e\u4fdd\u5176\u4ed6\u7ebf\u7a0b\u53ef\u4ee5\u770b\u5230\u8fd9\u4e9b\u66f4\u6539\u3002\r\n\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u9700\u8981\u8bfb\u53d6\u5171\u4eab\u53d8\u91cf\u65f6\uff0c\u5b83\u4e00\u7248\u4f1a\u4ece\u672c\u5730\u5185\u5b58\u4e2d\u8bfb\u53d6\u3002\u5982\u679c\u672c\u5730\u5185\u5b58\u4e2d\u7684\u526f\u672c\u662f\u8fc7\u65f6\u7684\uff0cJVM \u4f1a\u5c06\u4e3b\u5185\u5b58\u4e2d\u7684\u5171\u4eab\u53d8\u91cf\u6700\u65b0\u503c\u5237\u65b0\u5230\u672c\u5730\u5185\u5b58\u4e2d\u3002\r\n",(0,t.jsx)(e.img,{alt:"JAVA\u5185\u5b58\u6a21\u578b1",src:r(1646).A+"",width:"654",height:"610"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u4e3a\u4ec0\u4e48\u7ebf\u7a0b\u8981\u7528\u81ea\u5df1\u7684\u5185\u5b58",children:"\u4e3a\u4ec0\u4e48\u7ebf\u7a0b\u8981\u7528\u81ea\u5df1\u7684\u5185\u5b58\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u4ece\u4e3b\u5185\u5b58\u62f7\u8d1d\u53d8\u91cf\u5230\u5de5\u4f5c\u5185\u5b58\uff0c\u53ef\u4ee5\u51cf\u5c11 CPU \u8bbf\u95ee RAM \u7684\u5f00\u9500\u3002\r\n\u6bcf\u4e2a\u7ebf\u7a0b\u90fd\u6709\u81ea\u5df1\u7684\u53d8\u91cf\u526f\u672c\uff0c\u53ef\u4ee5\u907f\u514d\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u4fee\u6539\u5171\u4eab\u53d8\u91cf\u5bfc\u81f4\u7684\u6570\u636e\u51b2\u7a81\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"i\u662f\u539f\u5b50\u64cd\u4f5c\u5417",children:"i++\u662f\u539f\u5b50\u64cd\u4f5c\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e0d\u662f\uff0c\u5b83\u5305\u62ec\u4e09\u4e2a\u6b65\u9aa4\uff1a\r\n\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6 i \u7684\u503c\u3002\r\n\u5bf9 i \u8fdb\u884c\u52a0 1 \u64cd\u4f5c\u3002\r\n\u5c06\u65b0\u7684\u503c\u5199\u56de\u5185\u5b58\u3002"}),"\n",(0,t.jsx)(e.h4,{id:"\u8bf4\u8bf4\u4f60\u5bf9\u539f\u5b50\u6027\u53ef\u89c1\u6027\u6709\u5e8f\u6027\u7684\u7406\u89e3",children:"\u8bf4\u8bf4\u4f60\u5bf9\u539f\u5b50\u6027\u3001\u53ef\u89c1\u6027\u3001\u6709\u5e8f\u6027\u7684\u7406\u89e3\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u539f\u5b50\u6027\u8981\u6c42\u4e00\u4e2a\u64cd\u4f5c\u662f\u4e0d\u53ef\u5206\u5272\u7684\uff0c\u8981\u4e48\u5168\u90e8\u6267\u884c\u6210\u529f\uff0c\u8981\u4e48\u5b8c\u5168\u4e0d\u6267\u884c\u3002\r\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u5c31\u6bd4\u5982\u8bf4 count++ \u5c31\u4e0d\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\uff0c\u5b83\u5305\u62ec\u8bfb\u53d6 count \u7684\u503c\u3001\u52a0 1\u3001\u5199\u56de count \u4e09\u4e2a\u6b65\u9aa4\uff0c\u6240\u4ee5\u9700\u8981\u52a0\u9501\u6216\u8005\u4f7f\u7528AtomicInteger\u4ee3\u66ff\r\nint \u6765\u4fdd\u8bc1\u539f\u5b50\u6027\u3002\r\n\u53ef\u89c1\u6027\u8981\u6c42\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u53d8\u91cf\u7684\u4fee\u6539\uff0c\u80fd\u591f\u88ab\u5176\u4ed6\u7ebf\u7a0b\u53ca\u65f6\u770b\u89c1\u3002\r\n\u6211\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\u89e3\u91ca\u4e00\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'private static boolean flag = true;\r\n\r\npublic static void main(String[] args) {\r\n    new Thread(() -> {\r\n        while (flag) {\r\n        } // \u7ebf\u7a0b A \u53ef\u80fd\u4e00\u76f4\u770b\u4e0d\u5230 flag=false\r\n        System.out.println("\u7ebf\u7a0b A \u9000\u51fa");\r\n    }).start();\r\n\r\n    try {\r\n        Thread.sleep(1000);\r\n    } catch (InterruptedException e) {\r\n    }\r\n\r\n    flag = false; // \u7ebf\u7a0b B \u4fee\u6539 flag\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4e0a\u8ff0\u4ee3\u7801\u95ee\u9898\uff1a\r\n\u7ebf\u7a0b A \u4f1a\u5728\u672c\u5730\u5185\u5b58\u4e2d\u7f13\u5b58 flag=true\uff0c\u867d\u7136\u7ebf\u7a0b B \u4fee\u6539\u4e86 flag=false\uff0c\u4f46\u4e0d\u4f1a\u7acb\u5373\u540c\u6b65\u5230\u4e3b\u5185\u5b58\u4ee5\u53ca\u7ebf\u7a0b A \u7684\u672c\u5730\u5185\u5b58\uff0c\u56e0\u6b64\u7ebf\u7a0b A\r\n\u4f1a\u4e00\u76f4\u5904\u4e8e\u6b7b\u5faa\u73af\u3002\r\n\u89e3\u51b3\u529e\u6cd5\u5c31\u662f\u901a\u8fc7 volatile \u5173\u952e\u5b57\u6765\u4fdd\u8bc1\u53ef\u89c1\u6027\u3002\r\n\u6709\u5e8f\u6027\u662f\u6307\u7a0b\u5e8f\u6267\u884c\u7684\u987a\u5e8f\u662f\u5426\u6309\u7167\u4ee3\u7801\u7f16\u5199\u7684\u987a\u5e8f\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u5355\u7ebf\u7a0b\u73af\u5883\u4e0b\uff0c\u4ee3\u7801\u80fd\u591f\u51c6\u786e\u65e0\u8bef\u5730\u6309\u7167\u7f16\u5199\u987a\u5e8f\u6267\u884c\u3002\u4f46\u5728\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\uff0cCPU \u548c\u7f16\u8bd1\u5668\u53ef\u80fd\u4f1a\u8fdb\u884c\u6307\u4ee4\u91cd\u6392\uff0c\u4ee3\u7801\u7684\u6267\u884c\u987a\u5e8f\u56e0\u6b64\u4f1a\u53d1\u751f\u53d8\u5316\u3002\r\n\u6211\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\u89e3\u91ca\u4e00\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"int a = 0, b = 0;\r\nboolean flag = false;\r\n\r\nvoid thread1() {\r\n    a = 1;\r\n    flag = true; // \u53ef\u80fd\u4f1a\u88ab CPU \u4f18\u5316\uff0c\u5148\u6267\u884c\r\n}\r\n\r\nvoid thread2() {\r\n    if (flag) {\r\n        System.out.println(a); // \u53ef\u80fd\u6253\u5370 0\uff0c\u800c\u4e0d\u662f 1\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7531\u4e8e\u6307\u4ee4\u91cd\u6392\uff0cflag = true \u53ef\u80fd\u4f1a\u5728 a = 1 \u4e4b\u524d\u6267\u884c\uff0c\u5bfc\u81f4 thread2() \u8bfb\u53d6 flag=true \u540e\uff0ca \u4ecd\u7136\u662f 0\uff0c\u51fa\u73b0\u4e0d\u7b26\u5408\u4ee3\u7801\u903b\u8f91\u7684\u60c5\u51b5\u3002\r\n\u7b80\u8981\u56de\u7b54\uff1a\r\n\u539f\u5b50\u6027\u4fdd\u8bc1\u64cd\u4f5c\u4e0d\u53ef\u4e2d\u65ad\uff0c\u53ef\u89c1\u6027\u4fdd\u8bc1\u53d8\u91cf\u4fee\u6539\u540e\u7ebf\u7a0b\u80fd\u770b\u5230\u6700\u65b0\u503c\uff0c\u6709\u5e8f\u6027\u4fdd\u8bc1\u4ee3\u7801\u6267\u884c\u987a\u5e8f\u4e00\u81f4\uff0c\u53ef\u4ee5\u901a\u8fc7 volatile\u3001synchronized \u548c\r\nCAS \u673a\u5236\u6765\u4fdd\u8bc1\u8fd9\u4e9b\u7279\u6027\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u4e0b\u9762\u7684\u4ee3\u7801\u662f\u539f\u5b50\u64cd\u4f5c\u5417\uff1f"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"int i = 2;\r\nint j = i;\r\ni++;\r\ni =i +1;\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4\u4ec0\u4e48\u662f\u6307\u4ee4\u91cd\u6392",children:"\u8bf4\u8bf4\u4ec0\u4e48\u662f\u6307\u4ee4\u91cd\u6392\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u6307\u4ee4\u91cd\u6392\u662f\u6307 CPU \u6216\u7f16\u8bd1\u5668\u4e3a\u4e86\u63d0\u9ad8\u7a0b\u5e8f\u7684\u6267\u884c\u6548\u7387\uff0c\u6539\u53d8\u4ee3\u7801\u6267\u884c\u987a\u5e8f\u7684\u4e00\u79cd\u4f18\u5316\u6280\u672f\u3002\r\n\u4ece Java \u6e90\u4ee3\u7801\u5230\u6700\u7ec8\u6267\u884c\u7684\u6307\u4ee4\u5e8f\u5217\uff0c\u4f1a\u7ecf\u5386 3 \u79cd\u91cd\u6392\u5e8f\uff1a\u7f16\u8bd1\u5668\u91cd\u6392\u5e8f\u3001\u6307\u4ee4\u5e76\u884c\u91cd\u6392\u5e8f\u3001\u5185\u5b58\u7cfb\u7edf\u91cd\u6392\u5e8f\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u6307\u4ee4\u91cd\u6392",src:r(77052).A+"",width:"1035",height:"195"})]}),"\n",(0,t.jsx)(e.p,{children:"\u6307\u4ee4\u91cd\u6392\u53ef\u80fd\u4f1a\u5bfc\u81f4\u53cc\u91cd\u68c0\u67e5\u9501\u5931\u6548\uff0c\u6bd4\u5982\u4e0b\u9762\u7684\u5355\u4f8b\u6a21\u5f0f\u4ee3\u7801\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public class Singleton {\r\n    private static Singleton instance;\r\n\r\n    public static Singleton getInstance() {\r\n        if (instance == null) { // \u7b2c\u4e00\u6b21\u68c0\u67e5\r\n            synchronized (Singleton.class) {\r\n                if (instance == null) { // \u7b2c\u4e8c\u6b21\u68c0\u67e5\r\n                    instance = new Singleton(); // \u53ef\u80fd\u53d1\u751f\u6307\u4ee4\u91cd\u6392\r\n                }\r\n            }\r\n        }\r\n        return instance;\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5982\u679c\u7ebf\u7a0b A \u6267\u884c\u4e86 instance = new Singleton();\r\n\u4f46\u6784\u9020\u65b9\u6cd5\u8fd8\u6ca1\u6267\u884c\u5b8c\uff0c\u7ebf\u7a0b B \u53ef\u80fd\u4f1a\u8bfb\u53d6\u5230\u4e00\u4e2a\u672a\u521d\u59cb\u5316\u7684\u5bf9\u8c61\uff0c\u5bfc\u81f4\u51fa\u73b0\u7a7a\u6307\u9488\u5f02\u5e38\u3002\uff1f\uff1f\uff1f\r\n",(0,t.jsx)(e.img,{alt:"\u5355\u4f8b\u6076\u6c49\u6307\u5b9a\u91cd\u6392\u53ef\u80fd\u5b58\u5728\u95ee\u9898",src:r(77767).A+"",width:"901",height:"604"}),"\r\n\u6b63\u786e\u7684\u65b9\u5f0f\u662f\u7ed9 instance \u53d8\u91cf\u52a0\u4e0a volatile \u5173\u952e\u5b57\uff0c\u7981\u6b62\u6307\u4ee4\u91cd\u6392\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class Singleton {\r\n    private static volatile Singleton instance;\r\n\r\n    public static Singleton getInstance() {\r\n        if (instance == null) {\r\n            synchronized (Singleton.class) {\r\n                if (instance == null) {\r\n                    instance = new Singleton(); // \u7531\u4e8e volatile\uff0c\u7981\u6b62\u6307\u4ee4\u91cd\u6392\r\n                }\r\n            }\r\n        }\r\n        return instance;\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"happens-before-\u4e86\u89e3\u5417",children:"happens-before \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.h3,{id:"as-if-serial-\u4e86\u89e3\u5417",children:"as-if-serial \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.h3,{id:"volatile-\u4e86\u89e3\u5417",children:"\ud83c\udf1fvolatile \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u63a8\u8350\u9605\u8bfb\uff1avolatile \u5173\u952e\u5b57\u89e3\u6790\r\n\u4e86\u89e3\u3002\r\n\u7b2c\u4e00\uff0c\u4fdd\u8bc1\u53ef\u89c1\u6027\uff0c\u7ebf\u7a0b\u4fee\u6539 volatile \u53d8\u91cf\u540e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u80fd\u591f\u7acb\u5373\u770b\u5230\u6700\u65b0\u503c\uff1b\r\n\u7b2c\u4e8c\uff0c\u9632\u6b62\u6307\u4ee4\u91cd\u6392\uff0cvolatile \u53d8\u91cf\u7684\u5199\u5165\u4e0d\u4f1a\u88ab\u91cd\u6392\u5e8f\u5230\u5b83\u4e4b\u524d\u7684\u4ee3\u7801\u3002"}),"\n",(0,t.jsx)(e.h4,{id:"volatile-\u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\u7684",children:"volatile \u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\u7684\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u5f53\u7ebf\u7a0b\u5bf9 volatile \u53d8\u91cf\u8fdb\u884c\u5199\u64cd\u4f5c\u65f6\uff0cJVM \u4f1a\u5728\u8fd9\u4e2a\u53d8\u91cf\u5199\u5165\u4e4b\u540e\u63d2\u5165\u4e00\u4e2a\u5199\u5c4f\u969c\u6307\u4ee4\uff0c\u8fd9\u4e2a\u6307\u4ee4\u4f1a\u5f3a\u5236\u5c06\u672c\u5730\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\u503c\u5237\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d\u3002\r\n",(0,t.jsx)(e.img,{alt:"volatile\u4fdd\u8bc1\u53ef\u89c1\u6027",src:r(26255).A+"",width:"796",height:"592"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-text",children:"StoreStore;   // \u4fdd\u8bc1\u5199\u5165\u4e4b\u524d\u7684\u64cd\u4f5c\u4e0d\u4f1a\u91cd\u6392\r\nvolatile_write(); // \u5199\u5165 volatile \u53d8\u91cf\r\nStoreLoad;    // \u4fdd\u8bc1\u5199\u5165\u540e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u7acb\u5373\u53ef\u89c1\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5728 x86 \u67b6\u6784\u4e0b\uff0c\u901a\u5e38\u4f1a\u4f7f\u7528 lock \u6307\u4ee4\u6765\u5b9e\u73b0\u5199\u5c4f\u969c\uff0c\u4f8b\u5982\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-text",children:"mov [a], 2          ; \u5c06\u503c 2 \u5199\u5165\u5185\u5b58\u5730\u5740 a\r\nlock add [a], 0     ; lock \u6307\u4ee4\u5145\u5f53\u5199\u5c4f\u969c\uff0c\u786e\u4fdd\u5185\u5b58\u53ef\u89c1\u6027\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5f53\u7ebf\u7a0b\u5bf9 volatile \u53d8\u91cf\u8fdb\u884c\u8bfb\u64cd\u4f5c\u65f6\uff0cJVM \u4f1a\u63d2\u5165\u4e00\u4e2a\u8bfb\u5c4f\u969c\u6307\u4ee4\uff0c\u8fd9\u4e2a\u6307\u4ee4\u4f1a\u5f3a\u5236\u8ba9\u672c\u5730\u5185\u5b58\u4e2d\u7684\u53d8\u91cf\u503c\u5931\u6548\uff0c\u4ece\u800c\u91cd\u65b0\u4ece\u4e3b\u5185\u5b58\u4e2d\u8bfb\u53d6\u6700\u65b0\u7684\u503c\u3002\r\n",(0,t.jsx)(e.img,{alt:"volatile\u52a0\u5165\u5c4f\u969c\u6307\u4ee4",src:r(61205).A+"",width:"795",height:"593"}),"\r\n\u6211\u4eec\u6765\u58f0\u660e\u4e00\u4e2a volatile \u53d8\u91cf x\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"volatile int x = 0\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u7ebf\u7a0b A \u5bf9 x \u5199\u5165\u540e\u4f1a\u5c06\u5176\u6700\u65b0\u7684\u503c\u5237\u65b0\u5230\u4e3b\u5185\u5b58\u4e2d\uff0c\u7ebf\u7a0b B \u8bfb\u53d6 x \u65f6\u7531\u4e8e\u672c\u5730\u5185\u5b58\u4e2d\u7684 x \u5931\u6548\u4e86\uff0c\u5c31\u4f1a\u4ece\u4e3b\u5185\u5b58\u4e2d\u8bfb\u53d6\u6700\u65b0\u7684\u503c\u3002\r\n",(0,t.jsx)(e.img,{alt:"volatile\u4fee\u9970\u53d8\u91cf\u591a\u7ebf\u7a0b\u4fee\u6539",src:r(81914).A+"",width:"1136",height:"432"})]}),"\n",(0,t.jsx)(e.h3,{id:"volatile-\u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027\u7684",children:"volatile \u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027\u7684\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"JVM \u4f1a\u5728 volatile \u53d8\u91cf\u7684\u8bfb\u5199\u524d\u540e\u63d2\u5165 \u201c\u5185\u5b58\u5c4f\u969c\u201d\uff0c\u4ee5\u7ea6\u675f CPU \u548c\u7f16\u8bd1\u5668\u7684\u4f18\u5316\u884c\u4e3a\uff1a"}),"\n",(0,t.jsx)(e.p,{children:"StoreStore \u5c4f\u969c\u53ef\u4ee5\u7981\u6b62\u666e\u901a\u5199\u64cd\u4f5c\u4e0e volatile \u5199\u64cd\u4f5c\u7684\u91cd\u6392\r\nStoreLoad \u5c4f\u969c\u4f1a\u7981\u6b62 volatile \u5199\u4e0e volatile \u8bfb\u91cd\u6392\r\nLoadLoad \u5c4f\u969c\u4f1a\u7981\u6b62 volatile \u8bfb\u4e0e\u540e\u7eed\u666e\u901a\u8bfb\u64cd\u4f5c\u91cd\u6392\r\nLoadStore \u5c4f\u969c\u4f1a\u7981\u6b62 volatile \u8bfb\u4e0e\u540e\u7eed\u666e\u901a\u5199\u64cd\u4f5c\u91cd\u6392"}),"\n",(0,t.jsx)(e.h3,{id:"volatile-\u548c-synchronized-\u7684\u533a\u522b",children:"volatile \u548c synchronized \u7684\u533a\u522b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"volatile \u5173\u952e\u5b57\u7528\u4e8e\u4fee\u9970\u53d8\u91cf\uff0c\u786e\u4fdd\u8be5\u53d8\u91cf\u7684\u66f4\u65b0\u64cd\u4f5c\u5bf9\u6240\u6709\u7ebf\u7a0b\u662f\u53ef\u89c1\u7684\uff0c\u5373\u4e00\u65e6\u67d0\u4e2a\u7ebf\u7a0b\u4fee\u6539\u4e86 volatile \u53d8\u91cf\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4f1a\u7acb\u5373\u770b\u5230\u6700\u65b0\u7684\u503c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"synchronized \u5173\u952e\u5b57\u7528\u4e8e\u4fee\u9970\u65b9\u6cd5\u6216\u4ee3\u7801\u5757\uff0c\u786e\u4fdd\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u591f\u6267\u884c\u8be5\u65b9\u6cd5\u6216\u4ee3\u7801\u5757\uff0c\u4ece\u800c\u5b9e\u73b0\u4e92\u65a5\u8bbf\u95ee\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"volatile-\u52a0\u5728\u57fa\u672c\u7c7b\u578b\u548c\u5bf9\u8c61\u4e0a\u7684\u533a\u522b",children:"volatile \u52a0\u5728\u57fa\u672c\u7c7b\u578b\u548c\u5bf9\u8c61\u4e0a\u7684\u533a\u522b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53 volatile \u7528\u4e8e\u57fa\u672c\u6570\u636e\u7c7b\u578b\u65f6\uff0c\u80fd\u786e\u4fdd\u8be5\u53d8\u91cf\u7684\u8bfb\u5199\u64cd\u4f5c\u662f\u76f4\u63a5\u4ece\u4e3b\u5185\u5b58\u4e2d\u8bfb\u53d6\u6216\u5199\u5165\u7684\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private volatile int count = 0;\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5f53 volatile \u7528\u4e8e\u5f15\u7528\u7c7b\u578b\u65f6\uff0c\u80fd\u786e\u4fdd\u5f15\u7528\u672c\u8eab\u7684\u53ef\u89c1\u6027\uff0c\u5373\u786e\u4fdd\u5f15\u7528\u6307\u5411\u7684\u5bf9\u8c61\u5730\u5740\u662f\u6700\u65b0\u7684\u3002\r\n\u4f46\u662f\uff0cvolatile \u5e76\u4e0d\u80fd\u4fdd\u8bc1\u5f15\u7528\u5bf9\u8c61\u5185\u90e8\u72b6\u6001\u7684\u7ebf\u7a0b\u5b89\u5168\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private volatile SomeObject obj = new SomeObject();\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u867d\u7136 volatile \u786e\u4fdd\u4e86 obj \u5f15\u7528\u7684\u53ef\u89c1\u6027\uff0c\u4f46\u5bf9 obj \u5f15\u7528\u7684 new SomeObject() \u5bf9\u8c61\u5e76\u4e0d\u53d7 volatile \u4fdd\u62a4\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u9700\u8981\u4fdd\u8bc1\u5f15\u7528\u5bf9\u8c61\u5185\u90e8\u72b6\u6001\u7684\u7ebf\u7a0b\u5b89\u5168\uff0c\u9700\u8981\u4f7f\u7528 synchronized \u6216 ReentrantLock \u7b49\u9501\u673a\u5236\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"\u9501",children:"\u9501"}),"\n",(0,t.jsx)(e.h3,{id:"synchronized-\u7528\u8fc7\u5417",children:"synchronized \u7528\u8fc7\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7528\u8fc7\uff0c\u9891\u7387\u8fd8\u5f88\u9ad8\u3002"}),"\n",(0,t.jsx)(e.p,{children:"synchronized \u5728 JDK 1.6 \u4e4b\u540e\uff0c\u8fdb\u884c\u4e86\u9501\u4f18\u5316\uff0c\u589e\u52a0\u4e86\u504f\u5411\u9501\u3001\u8f7b\u91cf\u7ea7\u9501\uff0c\u5927\u5927\u63d0\u5347\u4e86 synchronized \u7684\u6027\u80fd\u3002"}),"\n",(0,t.jsx)(e.p,{children:"synchronized \u4e0a\u9501\u7684\u5bf9\u8c61\u662f\u4ec0\u4e48\uff1f\r\nsynchronized \u7528\u5728\u666e\u901a\u65b9\u6cd5\u4e0a\u65f6\uff0c\u4e0a\u9501\u7684\u662f\u6267\u884c\u8fd9\u4e2a\u65b9\u6cd5\u7684\u5bf9\u8c61\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public synchronized void increment() {\r\n    this.count++;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"synchronized \u7528\u5728\u9759\u6001\u65b9\u6cd5\u4e0a\u65f6\uff0c\u4e0a\u9501\u7684\u662f\u8fd9\u4e2a\u7c7b\u7684 Class \u5bf9\u8c61\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public static synchronized void increment() {\r\n    count++;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"synchronized \u7528\u5728\u4ee3\u7801\u5757\u4e0a\u65f6\uff0c\u4e0a\u9501\u7684\u662f\u62ec\u53f7\u4e2d\u6307\u5b9a\u7684\u5bf9\u8c61\uff0c\u6bd4\u5982\u8bf4\u5f53\u524d\u5bf9\u8c61 this\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public void increment() {\r\n    synchronized (this) {\r\n        this.count++;\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"synchronized-\u7684\u5b9e\u73b0\u539f\u7406\u4e86\u89e3\u5417",children:"synchronized \u7684\u5b9e\u73b0\u539f\u7406\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["synchronized \u4f9d\u8d56 JVM \u5185\u90e8\u7684 Monitor \u5bf9\u8c61\u6765\u5b9e\u73b0\u7ebf\u7a0b\u540c\u6b65\u3002\u4f7f\u7528\u7684\u65f6\u5019\u4e0d\u7528\u624b\u52a8\u53bb lock \u548c unlock\uff0cJVM \u4f1a\u81ea\u52a8\u52a0\u9501\u548c\u89e3\u9501\u3002\r\nsynchronized \u52a0\u9501\u4ee3\u7801\u5757\u65f6\uff0cJVM \u4f1a\u901a\u8fc7 monitorenter\u3001monitorexit \u4e24\u4e2a\u6307\u4ee4\u6765\u5b9e\u73b0\u540c\u6b65\uff1a\r\n\u524d\u8005\u8868\u793a\u7ebf\u7a0b\u6b63\u5728\u5c1d\u8bd5\u83b7\u53d6 lock \u5bf9\u8c61\u7684 Monitor\uff1b\r\n\u540e\u8005\u8868\u793a\u7ebf\u7a0b\u6267\u884c\u5b8c\u4e86\u540c\u6b65\u4ee3\u7801\u5757\uff0c\u6b63\u5728\u91ca\u653e\u9501\u3002\r\n\u4f7f\u7528 javap -c -s -v -l SynchronizedDemo.class \u53cd\u7f16\u8bd1 synchronized \u4ee3\u7801\u5757\u65f6\uff0c\u5c31\u80fd\u770b\u5230\u8fd9\u4e24\u4e2a\u6307\u4ee4\u3002\r\n",(0,t.jsx)(e.img,{alt:"img_1.png",src:r(4503).A+"",width:"957",height:"698"}),"\r\nsynchronized \u4fee\u9970\u666e\u901a\u65b9\u6cd5\u65f6\uff0cJVM \u4f1a\u901a\u8fc7 ACC_SYNCHRONIZED \u6807\u8bb0\u7b26\u6765\u5b9e\u73b0\u540c\u6b65\u3002\r\n",(0,t.jsx)(e.img,{alt:"img_2.png",src:r(80572).A+"",width:"943",height:"448"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u4f60\u5bf9-monitor-\u4e86\u89e3\u591a\u5c11",children:"\u4f60\u5bf9 Monitor \u4e86\u89e3\u591a\u5c11\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"waitx ,\u6ca1\u4eba\u95ee\u8fc7"}),"\n",(0,t.jsx)(e.h3,{id:"synchronized-\u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027",children:"synchronized \u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u901a\u8fc7\u4e24\u6b65\u64cd\u4f5c\uff1a"}),"\n",(0,t.jsx)(e.p,{children:"\u52a0\u9501\u65f6\uff0c\u7ebf\u7a0b\u5fc5\u987b\u4ece\u4e3b\u5185\u5b58\u8bfb\u53d6\u6700\u65b0\u6570\u636e\u3002\r\n\u91ca\u653e\u9501\u65f6\uff0c\u7ebf\u7a0b\u5fc5\u987b\u5c06\u4fee\u6539\u7684\u6570\u636e\u5237\u56de\u4e3b\u5185\u5b58\uff0c\u8fd9\u6837\u5176\u4ed6\u7ebf\u7a0b\u83b7\u53d6\u9501\u540e\uff0c\u5c31\u80fd\u770b\u5230\u6700\u65b0\u7684\u6570\u636e\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-text",children:"\u7ebf\u7a0b A                  \u7ebf\u7a0b B\r\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n  \u2502 synchronized(lock) \u2502\r\n  \u2502    x = 1;          \u2502  // 1. \u7ebf\u7a0b A \u4fee\u6539\u53d8\u91cf x\r\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n        \u2193 \u91ca\u653e\u9501\r\n  \uff08JVM \u5f3a\u5236\u5237\u65b0 x \u5230\u4e3b\u5185\u5b58\uff09\r\n\r\n        \uff08\u7ebf\u7a0b B \u83b7\u53d6\u9501\uff09\r\n  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n  \u2502 synchronized(lock) \u2502\r\n  \u2502    print(x);       \u2502  // 2. \u7ebf\u7a0b B \u8bfb\u53d6\u6700\u65b0 x=1\r\n  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,t.jsx)(e.h3,{id:"synchronized-\u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027",children:"synchronized \u600e\u4e48\u4fdd\u8bc1\u6709\u5e8f\u6027\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"synchronized \u901a\u8fc7 JVM \u6307\u4ee4 monitorenter \u548c monitorexit\uff0c\u6765\u786e\u4fdd\u52a0\u9501\u4ee3\u7801\u5757\u5185\u7684\u6307\u4ee4\u4e0d\u4f1a\u88ab\u91cd\u6392\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u6765\u89e3\u91ca\u4e00\u4e0b\uff0c\u6bd4\u5982\u8bf4\u5bf9\u4e8e\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"synchronized (lock){\r\nx =1;\r\nflag =true;\r\n        }\n"})}),"\n",(0,t.jsx)(e.p,{children:"javap \u53cd\u7f16\u8bd1\u540e\u7684\u4f2a\u4ee3\u7801\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"monitorenter   // \u83b7\u53d6\u9501\r\nstore x, 1     // \u53d8\u91cf x = 1\r\nstore flag, true  // \u53d8\u91cf flag = true\r\nmonitorexit    // \u91ca\u653e\u9501\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5b9e\u9645 javap \u53cd\u7f16\u8bd1\u540e\u7684\u7ed3\u679c\uff1a\r\n",(0,t.jsx)(e.img,{alt:"img_3.png",src:r(32837).A+"",width:"1114",height:"992"}),"\r\n\u6307\u4ee4\u89e3\u91ca\u4e00\u4e0b\uff1a"]}),"\n",(0,t.jsx)(e.p,{children:"\u6307\u4ee4 \u4f5c\u7528\r\nmonitorenter \u83b7\u53d6\u9501\uff0c\u8fdb\u5165\u540c\u6b65\u4ee3\u7801\u5757\r\niconst_1 \u5c06\u6574\u6570 1 \u538b\u5165\u64cd\u4f5c\u6570\u6808\r\nistore_1 \u5b58\u50a8 1 \u5230\u5c40\u90e8\u53d8\u91cf x\r\niconst_1 \u518d\u6b21\u5c06\u6574\u6570 1 \u538b\u5165\u64cd\u4f5c\u6570\u6808\r\nistore_2 \u5b58\u50a8 1 \u5230\u5c40\u90e8\u53d8\u91cf flag\r\naload 4 \u52a0\u8f7d lock \u5bf9\u8c61\u5f15\u7528\r\nmonitorexit \u91ca\u653e\u9501\uff0c\u9000\u51fa\u540c\u6b65\u4ee3\u7801\u5757"}),"\n",(0,t.jsx)(e.h3,{id:"synchronized-\u600e\u4e48\u5b9e\u73b0\u53ef\u91cd\u5165\u7684\u5462",children:"synchronized \u600e\u4e48\u5b9e\u73b0\u53ef\u91cd\u5165\u7684\u5462\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u53ef\u91cd\u5165\u610f\u5473\u7740\u540c\u4e00\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u591a\u6b21\u83b7\u5f97\u540c\u4e00\u4e2a\u9501\uff0c\u800c\u4e0d\u4f1a\u88ab\u963b\u585e\u3002\r\n",(0,t.jsx)(e.img,{alt:"img_7.png",src:r(3489).A+"",width:"1838",height:"1058"}),"\r\nsynchronized \u4e4b\u6240\u4ee5\u652f\u6301\u53ef\u91cd\u5165\uff0c\u662f\u56e0\u4e3a Java \u7684\u5bf9\u8c61\u5934\u5305\u542b\u4e86\u4e00\u4e2a Mark Word\uff0c\u7528\u4e8e\u5b58\u50a8\u5bf9\u8c61\u7684\u72b6\u6001\uff0c\u5305\u62ec\u9501\u4fe1\u606f\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u83b7\u53d6\u5bf9\u8c61\u9501\u65f6\uff0cJVM \u4f1a\u5c06\u8be5\u7ebf\u7a0b\u7684 ID \u5199\u5165 Mark Word\uff0c\u5e76\u5c06\u9501\u8ba1\u6570\u5668\u8bbe\u4e3a 1\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u5c1d\u8bd5\u518d\u6b21\u83b7\u53d6\u5df2\u7ecf\u6301\u6709\u7684\u9501\uff0cJVM \u4f1a\u68c0\u67e5 Mark Word \u4e2d\u7684\u7ebf\u7a0b ID\u3002\u5982\u679c ID \u5339\u914d\uff0c\u8868\u793a\u7684\u662f\u540c\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u9501\u8ba1\u6570\u5668\u9012\u589e\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u7ebf\u7a0b\u9000\u51fa\u540c\u6b65\u5757\u65f6\uff0c\u9501\u8ba1\u6570\u5668\u9012\u51cf\u3002\u5982\u679c\u8ba1\u6570\u5668\u503c\u4e3a\u96f6\uff0cJVM \u5c06\u9501\u6807\u8bb0\u4e3a\u672a\u6301\u6709\u72b6\u6001\uff0c\u5e76\u6e05\u9664\u7ebf\u7a0b ID \u4fe1\u606f\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ReentrantExample {\r\n    public synchronized void method1() {\r\n        System.out.println("Method1 acquired lock");\r\n        method2();  // \u7ebf\u7a0b\u5df2\u7ecf\u6301\u6709\u9501\uff0c\u80fd\u7ee7\u7eed\u8c03\u7528 method2\r\n    }\r\n\r\n    public synchronized void method2() {\r\n        System.out.println("Method2 acquired lock");\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        ReentrantExample example = new ReentrantExample();\r\n        example.method1();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u56e0\u4e3a synchronized \u652f\u6301\u53ef\u91cd\u5165\uff0c\u6240\u4ee5 method1 \u83b7\u53d6\u9501\u540e\uff0cmethod2 \u4ecd\u7136\u53ef\u4ee5\u83b7\u53d6\u9501\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5e95\u5c42\u662f\u901a\u8fc7 Monitor \u5bf9\u8c61\u7684 owner \u548c count \u5b57\u6bb5\u5b9e\u73b0\u7684\uff0cowner \u8bb0\u5f55\u6301\u6709\u9501\u7684\u7ebf\u7a0b\uff0ccount \u8bb0\u5f55\u7ebf\u7a0b\u83b7\u53d6\u9501\u7684\u6b21\u6570\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"synchronized-\u9501\u5347\u7ea7\u4e86\u89e3\u5417",children:"\ud83c\udf1fsynchronized \u9501\u5347\u7ea7\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"waitx \u6ca1\u95ee\u8fc7"}),"\n",(0,t.jsx)(e.h3,{id:"synchronized-\u548c-reentrantlock-\u7684\u533a\u522b\u4e86\u89e3\u5417",children:"\ud83c\udf1fsynchronized \u548c ReentrantLock \u7684\u533a\u522b\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e24\u53e5\u8bdd\u56de\u7b54\uff1asynchronized \u7531 JVM \u5185\u90e8\u7684 Monitor \u673a\u5236\u5b9e\u73b0\uff0cReentrantLock\u57fa\u4e8e AQS \u5b9e\u73b0\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["synchronized \u53ef\u4ee5\u81ea\u52a8\u52a0\u9501\u548c\u89e3\u9501\uff0cReentrantLock \u9700\u8981\u624b\u52a8 lock() \u548c unlock()\u3002\r\n",(0,t.jsx)(e.img,{alt:"img_8.png",src:r(91974).A+"",width:"756",height:"422"}),"\r\n\u5982\u679c\u9762\u8bd5\u5b98\u8fd8\u60f3\u77e5\u9053\u66f4\u591a\uff0c\u53ef\u4ee5\u7ee7\u7eed\u56de\u7b54\uff1a\r\n\u2460\u3001ReentrantLock \u53ef\u4ee5\u5b9e\u73b0\u591a\u8def\u9009\u62e9\u901a\u77e5\uff0c\u7ed1\u5b9a\u591a\u4e2a Condition\uff0c\u800c synchronized \u53ea\u80fd\u901a\u8fc7 wait \u548c notify \u5524\u9192\uff0c\u5c5e\u4e8e\u5355\u8def\u901a\u77e5\uff1b"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"ReentrantLock lock = new ReentrantLock();\r\nCondition condition = lock.newCondition();\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u2461\u3001synchronized \u53ef\u4ee5\u5728\u65b9\u6cd5\u548c\u4ee3\u7801\u5757\u4e0a\u52a0\u9501\uff0cReentrantLock \u53ea\u80fd\u5728\u4ee3\u7801\u5757\u4e0a\u52a0\u9501\uff0c\u4f46\u53ef\u4ee5\u6307\u5b9a\u662f\u516c\u5e73\u9501\u8fd8\u662f\u975e\u516c\u5e73\u9501\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"// synchronized \u4fee\u9970\u65b9\u6cd5\r\npublic synchronized void method() {\r\n    // \u4e1a\u52a1\u4ee3\u7801\r\n}\r\n\r\n// synchronized \u4fee\u9970\u4ee3\u7801\u5757\r\nsynchronized (this){\r\n        // \u4e1a\u52a1\u4ee3\u7801\r\n        }\r\n\r\n// ReentrantLock \u52a0\u9501\r\nReentrantLock lock = new ReentrantLock();\r\nlock.\r\n\r\nlock();\r\ntry{\r\n        // \u4e1a\u52a1\u4ee3\u7801\r\n        }finally{\r\n        lock.\r\n\r\nunlock();\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u2462\u3001ReentrantLock \u63d0\u4f9b\u4e86\u4e00\u79cd\u80fd\u591f\u4e2d\u65ad\u7b49\u5f85\u9501\u7684\u7ebf\u7a0b\u673a\u5236\uff0c\u901a\u8fc7 lock.lockInterruptibly() \u6765\u5b9e\u73b0\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"ReentrantLock lock = new ReentrantLock();\r\ntry{\r\n        lock.\r\n\r\nlockInterruptibly();\r\n}catch(\r\nInterruptedException e){\r\n        // \u5904\u7406\u4e2d\u65ad\u5f02\u5e38\r\n        }\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5e76\u53d1\u91cf\u5927\u7684\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 synchronized \u8fd8\u662f ReentrantLock\uff1f\r\n\u6211\u66f4\u503e\u5411\u4e8e ReentrantLock\uff0c\u56e0\u4e3a\uff1a\r\nReentrantLock \u63d0\u4f9b\u4e86\u8d85\u65f6\u548c\u516c\u5e73\u9501\u7b49\u7279\u6027\uff0c\u53ef\u4ee5\u5e94\u5bf9\u66f4\u590d\u6742\u7684\u5e76\u53d1\u573a\u666f\u3002\r\nReentrantLock \u5141\u8bb8\u66f4\u7ec6\u7c92\u5ea6\u7684\u9501\u63a7\u5236\uff0c\u80fd\u6709\u6548\u51cf\u5c11\u9501\u7ade\u4e89\u3002\r\nReentrantLock \u652f\u6301\u6761\u4ef6\u53d8\u91cf Condition\uff0c\u53ef\u4ee5\u5b9e\u73b0\u6bd4 synchronized \u66f4\u53cb\u597d\u7684\u7ebf\u7a0b\u95f4\u901a\u4fe1\u673a\u5236\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"lock-\u4e86\u89e3\u5417",children:"Lock \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"Lock \u662f JUC \u4e2d\u7684\u4e00\u4e2a\u63a5\u53e3\uff0c\u6700\u5e38\u7528\u7684\u5b9e\u73b0\u7c7b\u5305\u62ec\u53ef\u91cd\u5165\u9501 ReentrantLock\u3001\u8bfb\u5199\u9501 ReentrantReadWriteLock \u7b49"}),"\n",(0,t.jsx)(e.h3,{id:"reentrantlock-\u7684-lock-\u65b9\u6cd5\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417",children:"ReentrantLock \u7684 lock() \u65b9\u6cd5\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"lock \u65b9\u6cd5\u7684\u5177\u4f53\u5b9e\u73b0\u7531 ReentrantLock \u5185\u90e8\u7684 Sync \u7c7b\u6765\u5b9e\u73b0\uff0c\u6d89\u53ca\u5230\u7ebf\u7a0b\u7684\u81ea\u65cb\u3001\u963b\u585e\u961f\u5217\u3001CAS\u3001AQS \u7b49\u3002"}),"\n",(0,t.jsx)(e.p,{children:"lock \u65b9\u6cd5\u4f1a\u9996\u5148\u5c1d\u8bd5\u901a\u8fc7 CAS \u6765\u83b7\u53d6\u9501\u3002\u5982\u679c\u5f53\u524d\u9501\u6ca1\u6709\u88ab\u6301\u6709\uff0c\u4f1a\u5c06\u9501\u72b6\u6001\u8bbe\u7f6e\u4e3a 1\uff0c\u8868\u793a\u9501\u5df2\u88ab\u5360\u7528\u3002\u5426\u5219\uff0c\u4f1a\u5c06\u5f53\u524d\u7ebf\u7a0b\u52a0\u5165\u5230 AQS\r\n\u7684\u7b49\u5f85\u961f\u5217\u4e2d\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"final void lock() {\r\n    if (compareAndSetState(0, 1))  // \u5c1d\u8bd5\u76f4\u63a5\u83b7\u53d6\u9501\r\n        setExclusiveOwnerThread(Thread.currentThread());\r\n    else\r\n        acquire(1);  // \u5982\u679c\u83b7\u53d6\u5931\u8d25\uff0c\u8fdb\u5165AQS\u961f\u5217\u7b49\u5f85\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"aqs-\u4e86\u89e3\u591a\u5c11",children:"AQS \u4e86\u89e3\u591a\u5c11\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u63a8\u8350\u9605\u8bfb\uff1a\u5230\u5e95\u4ec0\u4e48\u662f AQS?\r\nAQS \u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u5b83\u7ef4\u62a4\u4e86\u4e00\u4e2a\u5171\u4eab\u53d8\u91cf state \u548c\u4e00\u4e2a\u7ebf\u7a0b\u7b49\u5f85\u961f\u5217\uff0c\u4e3a ReentrantLock \u7b49\u7c7b\u63d0\u4f9b\u5e95\u5c42\u652f\u6301\u3002\r\n",(0,t.jsx)(e.img,{alt:"AQS\u7ed3\u6784",src:r(73094).A+"",width:"1291",height:"461"}),"\r\nAQS \u7684\u601d\u60f3\u662f\uff0c\u5982\u679c\u88ab\u8bf7\u6c42\u7684\u5171\u4eab\u8d44\u6e90\u5904\u4e8e\u7a7a\u95f2\u72b6\u6001\uff0c\u5219\u5f53\u524d\u7ebf\u7a0b\u6210\u529f\u83b7\u53d6\u9501\uff1b\u5426\u5219\uff0c\u5c06\u5f53\u524d\u7ebf\u7a0b\u52a0\u5165\u5230\u7b49\u5f85\u961f\u5217\u4e2d\uff0c\u5f53\u5176\u4ed6\u7ebf\u7a0b\u91ca\u653e\u9501\u65f6\uff0c\u4ece\u7b49\u5f85\u961f\u5217\u4e2d\u6311\u9009\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u628a\u9501\u5206\u914d\u7ed9\u5b83\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"aqs-\u7684\u6e90\u7801\u9605\u8bfb\u8fc7\u5417",children:"AQS \u7684\u6e90\u7801\u9605\u8bfb\u8fc7\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u6709\u7814\u7a76\u8fc7\u3002\r\n\u7b2c\u4e00\uff0c\u72b6\u6001 state \u7531 volatile \u53d8\u91cf\u4fee\u9970\uff0c\u7528\u4e8e\u4fdd\u8bc1\u591a\u7ebf\u7a0b\u4e4b\u95f4\u7684\u53ef\u89c1\u6027\uff1b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private volatile int state;\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u2461\u3001\u540c\u6b65\u961f\u5217\u7531\u5185\u90e8\u5b9a\u4e49\u7684 Node \u7c7b\u5b9e\u73b0\uff0c\u6bcf\u4e2a Node \u5305\u542b\u4e86\u7b49\u5f85\u72b6\u6001\u3001\u524d\u540e\u8282\u70b9\u3001\u7ebf\u7a0b\u7684\u5f15\u7528\u7b49\uff0c\u662f\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\u7684\u53cc\u5411\u94fe\u8868\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static final class Node {\r\n    static final int CANCELLED = 1;\r\n    static final int SIGNAL = -1;\r\n    static final int CONDITION = -2;\r\n    static final int PROPAGATE = -3;\r\n\r\n    volatile Node prev;\r\n\r\n    volatile Node next;\r\n\r\n    volatile Thread thread;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"AQS \u652f\u6301\u4e24\u79cd\u540c\u6b65\u65b9\u5f0f\uff1a\r\n\u72ec\u5360\u6a21\u5f0f\u4e0b\uff1a\u6bcf\u6b21\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u6301\u6709\u9501\uff0c\u4f8b\u5982 ReentrantLock\u3002\r\n\u5171\u4eab\u6a21\u5f0f\u4e0b\uff1a\u591a\u4e2a\u7ebf\u7a0b\u53ef\u4ee5\u540c\u65f6\u83b7\u53d6\u9501\uff0c\u4f8b\u5982 Semaphore \u548c CountDownLatch\u3002\r\n\u6838\u5fc3\u65b9\u6cd5\u5305\u62ec\uff1a\r\nacquire\uff1a\u83b7\u53d6\u9501\uff0c\u5931\u8d25\u8fdb\u5165\u7b49\u5f85\u961f\u5217\uff1b\r\nrelease\uff1a\u91ca\u653e\u9501\uff0c\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\uff1b\r\nacquireShared\uff1a\u5171\u4eab\u6a21\u5f0f\u83b7\u53d6\u9501\uff1b\r\nreleaseShared\uff1a\u5171\u4eab\u6a21\u5f0f\u91ca\u653e\u9501\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["AQS \u4f7f\u7528\u4e00\u4e2a CLH \u961f\u5217\u6765\u7ef4\u62a4\u7b49\u5f85\u7ebf\u7a0b\uff0cCLH \u662f\u4e09\u4e2a\u4f5c\u8005 Craig\u3001Landin \u548c Hagersten \u7684\u9996\u5b57\u6bcd\u7f29\u5199\uff0c\u662f\u4e00\u79cd\u57fa\u4e8e\u94fe\u8868\u7684\u81ea\u65cb\u9501\u3002\r\n",(0,t.jsx)(e.img,{alt:"AQS\u7684\u62bd\u8c61\u540c\u6b65\u961f\u5217",src:r(25878).A+"",width:"1200",height:"331"}),"\r\n\u5728 CLH \u4e2d\uff0c\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u53d6\u9501\u5931\u8d25\u540e\uff0c\u4f1a\u88ab\u6dfb\u52a0\u5230\u961f\u5217\u7684\u5c3e\u90e8\u5e76\u81ea\u65cb\uff0c\u7b49\u5f85\u524d\u4e00\u4e2a\u8282\u70b9\u7684\u7ebf\u7a0b\u91ca\u653e\u9501\u3002\r\n",(0,t.jsx)(e.img,{alt:"AQS\u7684\u62bd\u8c61\u540c\u6b65\u961f\u5217\u5c3e\u90e8\u81ea\u65cb",src:r(84881).A+"",width:"1215",height:"357"}),"\r\nCLH \u7684\u4f18\u70b9\u662f\uff0c\u5047\u8bbe\u6709 100 \u4e2a\u7ebf\u7a0b\u5728\u7b49\u5f85\u9501\uff0c\u9501\u91ca\u653e\u4e4b\u540e\uff0c\u53ea\u4f1a\u901a\u77e5\u961f\u5217\u4e2d\u7684\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u53bb\u7ade\u4e89\u9501\u3002\u907f\u514d\u540c\u65f6\u5524\u9192\u5927\u91cf\u7ebf\u7a0b\uff0c\u6d6a\u8d39 CPU \u8d44\u6e90\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4-reentrantlock-\u7684\u5b9e\u73b0\u539f\u7406",children:"\ud83c\udf1f\u8bf4\u8bf4 ReentrantLock \u7684\u5b9e\u73b0\u539f\u7406\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["ReentrantLock \u662f\u57fa\u4e8e AQS \u5b9e\u73b0\u7684 \u53ef\u91cd\u5165\u6392\u4ed6\u9501\uff0c\u4f7f\u7528 CAS \u5c1d\u8bd5\u83b7\u53d6\u9501\uff0c\u5931\u8d25\u7684\u8bdd\uff0c\u4f1a\u8fdb\u5165 CLH \u963b\u585e\u961f\u5217\uff0c\u652f\u6301\u516c\u5e73\u9501\u3001\u975e\u516c\u5e73\u9501\uff0c\u53ef\u4ee5\u4e2d\u65ad\u3001\u8d85\u65f6\u7b49\u5f85\u3002\r\n",(0,t.jsx)(e.img,{alt:"ReentrantLock\u539f\u7406",src:r(98203).A+"",width:"686",height:"478"}),"\r\n\u5185\u90e8\u901a\u8fc7\u4e00\u4e2a\u8ba1\u6570\u5668 state \u6765\u8ddf\u8e2a\u9501\u7684\u72b6\u6001\u548c\u6301\u6709\u6b21\u6570\u3002\u5f53\u7ebf\u7a0b\u8c03\u7528 lock() \u65b9\u6cd5\u83b7\u53d6\u9501\u65f6\uff0cReentrantLock \u4f1a\u68c0\u67e5 state \u7684\u503c\uff0c\u5982\u679c\u4e3a\r\n0\uff0c\u901a\u8fc7 CAS \u4fee\u6539\u4e3a 1\uff0c\u8868\u793a\u6210\u529f\u52a0\u9501\u3002\u5426\u5219\u6839\u636e\u5f53\u524d\u7ebf\u7a0b\u7684\u516c\u5e73\u6027\u7b56\u7565\uff0c\u52a0\u5165\u5230\u7b49\u5f85\u961f\u5217\u4e2d\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u9996\u6b21\u83b7\u53d6\u9501\u65f6\uff0cstate \u503c\u8bbe\u4e3a 1\uff1b\u5982\u679c\u540c\u4e00\u4e2a\u7ebf\u7a0b\u518d\u6b21\u83b7\u53d6\u9501\u65f6\uff0cstate \u52a0 1\uff1b\u6bcf\u91ca\u653e\u4e00\u6b21\u9501\uff0cstate \u51cf 1\u3002\r\n\u5f53\u7ebf\u7a0b\u8c03\u7528 unlock() \u65b9\u6cd5\u65f6\uff0cReentrantLock \u4f1a\u5c06\u6301\u6709\u9501\u7684 state \u51cf 1\uff0c\u5982\u679c state = 0\uff0c\u5219\u91ca\u653e\u9501\uff0c\u5e76\u5524\u9192\u7b49\u5f85\u961f\u5217\u4e2d\u7684\u7ebf\u7a0b\u6765\u7ade\u4e89\u9501\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class CounterWithLock {\r\n    private int count = 0;\r\n    private final Lock lock = new ReentrantLock();\r\n\r\n    public void increment() {\r\n        lock.lock();  // \u83b7\u53d6\u9501\r\n        try {\r\n            count++;\r\n        } finally {\r\n            lock.unlock();  // \u91ca\u653e\u9501\r\n        }\r\n    }\r\n\r\n    public int getCount() {\r\n        return count;\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"new ReentrantLock() \u9ed8\u8ba4\u521b\u5efa\u7684\u662f\u975e\u516c\u5e73\u9501 NonfairSync\u3002\u5728\u975e\u516c\u5e73\u9501\u6a21\u5f0f\u4e0b\uff0c\u9501\u53ef\u80fd\u4f1a\u6388\u4e88\u521a\u521a\u8bf7\u6c42\u5b83\u7684\u7ebf\u7a0b\uff0c\u800c\u4e0d\u8003\u8651\u7b49\u5f85\u65f6\u95f4\u3002\u5f53\u5207\u6362\u5230\u516c\u5e73\u9501\u6a21\u5f0f\u4e0b\uff0c\u9501\u4f1a\u6388\u4e88\u7b49\u5f85\u65f6\u95f4\u6700\u957f\u7684\u7ebf\u7a0b\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"reentrantlock-\u600e\u4e48\u521b\u5efa\u516c\u5e73\u9501",children:"ReentrantLock \u600e\u4e48\u521b\u5efa\u516c\u5e73\u9501\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f88\u7b80\u5355\uff0c\u521b\u5efa ReentrantLock \u7684\u65f6\u5019\uff0c\u4f20\u9012\u53c2\u6570 true \u5c31\u53ef\u4ee5\u4e86\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"ReentrantLock lock = new ReentrantLock(true);\r\n\r\n// true \u4ee3\u8868\u516c\u5e73\u9501\uff0cfalse \u4ee3\u8868\u975e\u516c\u5e73\u9501\r\npublic ReentrantLock(boolean fair) {\r\n    sync = fair ? new FairSync() : new NonfairSync();\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u600e\u4e48\u521b\u5efa\u4e00\u4e2a\u975e\u516c\u5e73\u9501\u5462",children:"\u600e\u4e48\u521b\u5efa\u4e00\u4e2a\u975e\u516c\u5e73\u9501\u5462\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u521b\u5efa ReentrantLock \u65f6\uff0c\u4e0d\u4f20\u9012\u53c2\u6570\u6216\u8005\u4f20\u9012\u53c2\u6570\u5c31\u597d\u4e86\u3002\r\n\u975e\u516c\u5e73\u9501\u548c\u516c\u5e73\u9501\u6709\u4ec0\u4e48\u4e0d\u540c\uff1f\r\n\u4e24\u53e5\u8bdd\u56de\u7b54\uff1a\r\n\u516c\u5e73\u9501\u610f\u5473\u7740\u5728\u591a\u4e2a\u7ebf\u7a0b\u7ade\u4e89\u9501\u65f6\uff0c\u83b7\u53d6\u9501\u7684\u987a\u5e8f\u4e0e\u7ebf\u7a0b\u8bf7\u6c42\u9501\u7684\u987a\u5e8f\u76f8\u540c\uff0c\u5373\u5148\u6765\u5148\u670d\u52a1\u3002\r\n\u975e\u516c\u5e73\u9501\u4e0d\u4fdd\u8bc1\u7ebf\u7a0b\u83b7\u53d6\u9501\u7684\u987a\u5e8f\uff0c\u5f53\u9501\u88ab\u91ca\u653e\u65f6\uff0c\u4efb\u4f55\u8bf7\u6c42\u9501\u7684\u7ebf\u7a0b\u90fd\u6709\u673a\u4f1a\u83b7\u53d6\u9501\uff0c\u800c\u4e0d\u662f\u6309\u7167\u8bf7\u6c42\u7684\u987a\u5e8f\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u516c\u5e73\u9501\u7684\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417",children:"\u516c\u5e73\u9501\u7684\u5b9e\u73b0\u903b\u8f91\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u516c\u5e73\u9501\u7684\u6838\u5fc3\u903b\u8f91\u5728 AQS \u7684 hasQueuedPredecessors() \u65b9\u6cd5\u4e2d\uff0c\u8be5\u65b9\u6cd5\u7528\u4e8e\u5224\u65ad\u5f53\u524d\u7ebf\u7a0b\u524d\u9762\u662f\u5426\u6709\u7b49\u5f85\u7684\u7ebf\u7a0b\u3002\r\n",(0,t.jsx)(e.img,{alt:"AQS\u7684hasQueuedPredecessors",src:r(4926).A+"",width:"1284",height:"590"}),"\r\n\u5982\u679c\u961f\u5217\u524d\u9762\u6709\u7b49\u5f85\u7ebf\u7a0b\uff0c\u5f53\u524d\u7ebf\u7a0b\u5c31\u4e0d\u80fd\u62a2\u5360\u9501\uff0c\u5fc5\u987b\u6309\u7167\u961f\u5217\u987a\u5e8f\u6392\u961f\u3002\u5982\u679c\u961f\u5217\u524d\u9762\u6ca1\u6709\u7ebf\u7a0b\uff0c\u6216\u8005\u5f53\u524d\u7ebf\u7a0b\u662f\u961f\u5217\u5934\u90e8\u7684\u7ebf\u7a0b\uff0c\u5c31\u53ef\u4ee5\u83b7\u53d6\u9501\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"cas-\u4e86\u89e3\u591a\u5c11",children:"\ud83c\udf1fCAS \u4e86\u89e3\u591a\u5c11\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u63a8\u8350\u9605\u8bfb\uff1a\u4e00\u6587\u5f7b\u5e95\u641e\u6e05\u695a Java \u5b9e\u73b0 CAS \u7684\u539f\u7406\r\nCAS \u662f\u4e00\u79cd\u4e50\u89c2\u9501\uff0c\u7528\u4e8e\u6bd4\u8f83\u4e00\u4e2a\u53d8\u91cf\u7684\u5f53\u524d\u503c\u662f\u5426\u7b49\u4e8e\u9884\u671f\u503c\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u66f4\u65b0\u503c\uff0c\u5426\u5219\u91cd\u8bd5\u3002\r\n",(0,t.jsx)(e.img,{alt:"CAS\u539f\u7406",src:r(8378).A+"",width:"1242",height:"1172"}),"\r\n\u5728 CAS \u4e2d\uff0c\u6709\u4e09\u4e2a\u503c\uff1a\r\nV\uff1a\u8981\u66f4\u65b0\u7684\u53d8\u91cf(var)\r\nE\uff1a\u9884\u671f\u503c(expected)\r\nN\uff1a\u65b0\u503c(new)\r\n\u5148\u5224\u65ad V \u662f\u5426\u7b49\u4e8e E\uff0c\u5982\u679c\u7b49\u4e8e\uff0c\u5c06 V \u7684\u503c\u8bbe\u7f6e\u4e3a N\uff1b\u5982\u679c\u4e0d\u7b49\uff0c\u8bf4\u660e\u5df2\u7ecf\u6709\u5176\u5b83\u7ebf\u7a0b\u66f4\u65b0\u4e86 V\uff0c\u5f53\u524d\u7ebf\u7a0b\u5c31\u653e\u5f03\u66f4\u65b0\u3002\r\n\u8fd9\u4e2a\u6bd4\u8f83\u548c\u66ff\u6362\u7684\u64cd\u4f5c\u9700\u8981\u662f\u539f\u5b50\u7684\uff0c\u4e0d\u53ef\u4e2d\u65ad\u7684\u3002Java \u4e2d\u7684 CAS \u662f\u7531 Unsafe \u7c7b\u5b9e\u73b0\u7684\u3002\r\nAtomicInteger \u7c7b\u7684 compareAndSet \u5c31\u662f\u4e00\u4e2a CAS \u65b9\u6cd5\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"AtomicInteger atomicInteger = new AtomicInteger(0);\r\nint expect = 0;\r\nint update = 1;\r\natomicInteger.\r\n\r\ncompareAndSet(expect, update);\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5b83\u8c03\u7528\u7684\u662f Unsafe \u7684 compareAndSwapInt\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u600e\u4e48\u4fdd\u8bc1-cas-\u7684\u539f\u5b50\u6027",children:"\u600e\u4e48\u4fdd\u8bc1 CAS \u7684\u539f\u5b50\u6027\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"CPU \u4f1a\u53d1\u51fa\u4e00\u4e2a LOCK \u6307\u4ee4\u8fdb\u884c\u603b\u7ebf\u9501\u5b9a\uff0c\u963b\u6b62\u5176\u4ed6\u5904\u7406\u5668\u5bf9\u5185\u5b58\u5730\u5740\u8fdb\u884c\u64cd\u4f5c\uff0c\u76f4\u5230\u5f53\u524d\u6307\u4ee4\u6267\u884c\u5b8c\u6210\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-c",children:"lock cmpxchg [esi], eax  ; \u6bd4\u8f83 esi \u5730\u5740\u4e2d\u7684\u503c\u4e0e eax\uff0c\u5982\u679c\u76f8\u7b49\u5219\u66ff\u6362\n"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"CAS\u6d41\u7a0b",src:r(32065).A+"",width:"637",height:"763"}),"\r\nCAS \u5b58\u5728\u4e09\u4e2a\u7ecf\u5178\u95ee\u9898\uff0cABA \u95ee\u9898\u3001\u81ea\u65cb\u5f00\u9500\u5927\u3001\u53ea\u80fd\u64cd\u4f5c\u4e00\u4e2a\u53d8\u91cf\u7b49\u3002\r\n",(0,t.jsx)(e.img,{alt:"CAS\u4e09\u5927\u95ee\u9898",src:r(5575).A+"",width:"836",height:"336"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f-aba-\u95ee\u9898",children:"\u4ec0\u4e48\u662f ABA \u95ee\u9898\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"ABA \u95ee\u9898\u6307\u7684\u662f\uff0c\u4e00\u4e2a\u503c\u539f\u6765\u662f A\uff0c\u540e\u6765\u88ab\u6539\u4e3a B\uff0c\u518d\u540e\u6765\u53c8\u88ab\u6539\u56de A\uff0c\u8fd9\u65f6 CAS \u4f1a\u8bef\u8ba4\u4e3a\u8fd9\u4e2a\u503c\u6ca1\u6709\u53d1\u751f\u53d8\u5316\u3002\r\n\u7ebf\u7a0b 1\uff1aCAS(A \u2192 B)\uff0c\u4fee\u6539\u53d8\u91cf A \u2192 B\r\n\u7ebf\u7a0b 2\uff1aCAS(B \u2192 A)\uff0c\u53d8\u91cf\u53c8\u53d8\u56de A\r\n\u7ebf\u7a0b 3\uff1aCAS(A \u2192 C)\uff0cCAS \u6210\u529f\uff0c\u4f46\u5b9e\u9645\u6570\u636e\u5df2\u88ab\u4fee\u6539\u8fc7\uff01\r\n\u53ef\u4ee5\u4f7f\u7528\u7248\u672c\u53f7/\u65f6\u95f4\u6233\u7684\u65b9\u5f0f\u6765\u89e3\u51b3 ABA \u95ee\u9898\u3002\r\n\u6bd4\u5982\u8bf4\uff0c\u6bcf\u6b21\u53d8\u91cf\u66f4\u65b0\u65f6\uff0c\u4e0d\u4ec5\u66f4\u65b0\u53d8\u91cf\u7684\u503c\uff0c\u8fd8\u66f4\u65b0\u4e00\u4e2a\u7248\u672c\u53f7\u3002CAS \u64cd\u4f5c\u65f6\uff0c\u4e0d\u4ec5\u6bd4\u8f83\u53d8\u91cf\u7684\u503c\uff0c\u8fd8\u6bd4\u8f83\u7248\u672c\u53f7\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class OptimisticLockExample {\r\n    private int version;\r\n    private int value;\r\n\r\n    public synchronized boolean updateValue(int newValue, int currentVersion) {\r\n        if (this.version == currentVersion) {\r\n            this.value = newValue;\r\n            this.version++;\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"Java \u7684 AtomicStampedReference \u5c31\u589e\u52a0\u4e86\u7248\u672c\u53f7\uff0c\u5b83\u4f1a\u540c\u65f6\u68c0\u67e5\u5f15\u7528\u503c\u548c stamp \u662f\u5426\u90fd\u76f8\u7b49\r\n\u4f7f\u7528\u793a\u4f8b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ABAFix {\r\n    private static AtomicStampedReference<String> ref = new AtomicStampedReference<>("100", 1);\r\n\r\n    public static void main(String[] args) {\r\n        new Thread(() -> {\r\n            int stamp = ref.getStamp();\r\n            ref.compareAndSet("100", "200", stamp, stamp + 1);\r\n            ref.compareAndSet("200", "100", ref.getStamp(), ref.getStamp() + 1);\r\n        }).start();\r\n\r\n        new Thread(() -> {\r\n            try {\r\n                Thread.sleep(100);\r\n            } catch (InterruptedException e) {\r\n            }\r\n            int stamp = ref.getStamp();\r\n            System.out.println("CAS \u7ed3\u679c\uff1a" + ref.compareAndSet("100", "300", stamp, stamp + 1));\r\n        }).start();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u81ea\u65cb\u5f00\u9500\u5927\u600e\u4e48\u89e3\u51b3",children:"\u81ea\u65cb\u5f00\u9500\u5927\u600e\u4e48\u89e3\u51b3\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"CAS \u5931\u8d25\u65f6\u4f1a\u4e0d\u65ad\u81ea\u65cb\u91cd\u8bd5\uff0c\u5982\u679c\u4e00\u76f4\u4e0d\u6210\u529f\uff0c\u4f1a\u7ed9 CPU \u5e26\u6765\u975e\u5e38\u5927\u7684\u6267\u884c\u5f00\u9500\u3002\r\n\u53ef\u4ee5\u52a0\u4e00\u4e2a\u81ea\u65cb\u6b21\u6570\u7684\u9650\u5236\uff0c\u8d85\u8fc7\u4e00\u5b9a\u6b21\u6570\uff0c\u5c31\u5207\u6362\u5230 synchronized \u6302\u8d77\u7ebf\u7a0b\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public void cas() {\r\n    int MAX_RETRIES = 10;\r\n    int retries = 0;\r\n    while (!atomicInt.compareAndSet(expect, update)) {\r\n        retries++;\r\n        if (retries > MAX_RETRIES) {\r\n            synchronized (this) { // \u8d85\u8fc7\u6b21\u6570\uff0c\u4f7f\u7528 synchronized \u5904\u7406\r\n                if (atomicInt.get() == expect) {\r\n                    atomicInt.set(update);\r\n                }\r\n            }\r\n            break;\r\n        }\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6d89\u53ca\u5230\u591a\u4e2a\u53d8\u91cf\u540c\u65f6\u66f4\u65b0\u600e\u4e48\u529e\uff1f\r\n\u53ef\u4ee5\u5c06\u591a\u4e2a\u53d8\u91cf\u5c01\u88c5\u4e3a\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f7f\u7528 AtomicReference \u8fdb\u884c CAS \u66f4\u65b0\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class Account {\r\n    static class Balance {\r\n        final int money;\r\n        final int points;\r\n\r\n        Balance(int money, int points) {\r\n            this.money = money;\r\n            this.points = points;\r\n        }\r\n    }\r\n\r\n    private AtomicReference<Balance> balance = new AtomicReference<>(new Balance(100, 10));\r\n\r\n    public void update(int newMoney, int newPoints) {\r\n        Balance oldBalance, newBalance;\r\n        do {\r\n            oldBalance = balance.get();\r\n            newBalance = new Balance(newMoney, newPoints);\r\n        } while (!balance.compareAndSet(oldBalance, newBalance));\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"java-\u6709\u54ea\u4e9b\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u65b9\u6cd5",children:"Java \u6709\u54ea\u4e9b\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u65b9\u6cd5\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"\u539f\u5b50\u6027\u7684\u65b9\u6cd5",src:r(74154).A+"",width:"666",height:"274"}),"\r\n\u6bd4\u5982\u8bf4\u4ee5 Atomic \u5f00\u5934\u7684\u539f\u5b50\u7c7b\uff0csynchronized \u5173\u952e\u5b57\uff0cReentrantLock \u9501\u7b49\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u539f\u5b50\u64cd\u4f5c\u7c7b\u4e86\u89e3\u591a\u5c11",children:"\u539f\u5b50\u64cd\u4f5c\u7c7b\u4e86\u89e3\u591a\u5c11\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u539f\u5b50\u64cd\u4f5c\u7c7b\u662f\u57fa\u4e8e CAS + volatile \u5b9e\u73b0\u7684\uff0c\u5e95\u5c42\u4f9d\u8d56\u4e8e Unsafe \u7c7b\uff0c\u6700\u5e38\u7528\u7684\u6709 AtomicInteger\u3001AtomicLong\u3001AtomicReference \u7b49\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u539f\u5b50\u7c7b",src:r(87694).A+"",width:"981",height:"815"}),"\r\n\u50cf AtomicIntegerArray \u8fd9\u79cd\u4ee5 Array \u7ed3\u5c3e\u7684\uff0c\u8fd8\u53ef\u4ee5\u539f\u5b50\u66f4\u65b0\u6570\u7ec4\u91cc\u7684\u5143\u7d20\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class AtomicArrayExample {\r\n    public static void main(String[] args) {\r\n        AtomicIntegerArray atomicArray = new AtomicIntegerArray(new int[]{1, 2, 3});\r\n\r\n        atomicArray.incrementAndGet(1); // \u5bf9\u7d22\u5f15 1 \u8fdb\u884c\u81ea\u589e\r\n        System.out.println(atomicArray.get(1)); // \u8f93\u51fa 3\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u50cf AtomicStampedReference \u8fd8\u53ef\u4ee5\u901a\u8fc7\u7248\u672c\u53f7\u7684\u65b9\u5f0f\u89e3\u51b3 CAS \u4e2d\u7684 ABA \u95ee\u9898\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"class AtomicStampedReferenceExample {\r\n    public static void main(String[] args) {\r\n        AtomicStampedReference<Integer> ref = new AtomicStampedReference<>(100, 1);\r\n\r\n        int stamp = ref.getStamp(); // \u83b7\u53d6\u7248\u672c\u53f7\r\n        ref.compareAndSet(100, 200, stamp, stamp + 1); // A \u2192 B\r\n        ref.compareAndSet(200, 100, ref.getStamp(), ref.getStamp() + 1); // B \u2192 A\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"atomicinteger-\u7684\u6e90\u7801\u8bfb\u8fc7\u5417",children:"AtomicInteger \u7684\u6e90\u7801\u8bfb\u8fc7\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"AtomicInteger \u662f\u57fa\u4e8e volatile \u548c CAS \u5b9e\u73b0\u7684\uff0c\u5e95\u5c42\u4f9d\u8d56\u4e8e Unsafe \u7c7b\u3002\u6838\u5fc3\u65b9\u6cd5\u5305\u62ec getAndIncrement\u3001compareAndSet \u7b49\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public final int getAndIncrement() {\r\n    return unsafe.getAndAddInt(this, valueOffset, 1);\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6b7b\u9501\u4e86\u89e3\u5417",children:"\u7ebf\u7a0b\u6b7b\u9501\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u6b7b\u9501\u53d1\u751f\u5728\u591a\u4e2a\u7ebf\u7a0b\u76f8\u4e92\u7b49\u5f85\u5bf9\u65b9\u91ca\u653e\u9501\u65f6\u3002\u6bd4\u5982\u8bf4\u7ebf\u7a0b 1 \u6301\u6709\u9501 R1\uff0c\u7b49\u5f85\u9501 R2\uff1b\u7ebf\u7a0b 2 \u6301\u6709\u9501 R2\uff0c\u7b49\u5f85\u9501 R1\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u6b7b\u9501",src:r(14546).A+"",width:"976",height:"526"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u6b7b\u9501\u53d1\u751f\u7684\u56db\u4e2a\u6761\u4ef6\u4e86\u89e3\u5417",children:"\u6b7b\u9501\u53d1\u751f\u7684\u56db\u4e2a\u6761\u4ef6\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e00\u6761\u4ef6\u662f\u4e92\u65a5\uff1a\u8d44\u6e90\u4e0d\u80fd\u88ab\u591a\u4e2a\u7ebf\u7a0b\u5171\u4eab\uff0c\u4e00\u6b21\u53ea\u80fd\u7531\u4e00\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u3002\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u5df2\u7ecf\u5360\u7528\u4e86\u4e00\u4e2a\u8d44\u6e90\uff0c\u5176\u4ed6\u8bf7\u6c42\u8be5\u8d44\u6e90\u7684\u7ebf\u7a0b\u5fc5\u987b\u7b49\u5f85\uff0c\u76f4\u5230\u8d44\u6e90\u88ab\u91ca\u653e\u3002\r\n\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u662f\u6301\u6709\u5e76\u7b49\u5f85\uff1a\u4e00\u4e2a\u7ebf\u7a0b\u5df2\u7ecf\u6301\u6709\u4e00\u4e2a\u8d44\u6e90\uff0c\u5e76\u4e14\u5728\u7b49\u5f85\u83b7\u53d6\u5176\u4ed6\u7ebf\u7a0b\u6301\u6709\u7684\u8d44\u6e90\u3002\r\n\u7b2c\u4e09\u4e2a\u6761\u4ef6\u662f\u4e0d\u53ef\u62a2\u5360\uff1a\u8d44\u6e90\u4e0d\u80fd\u88ab\u5f3a\u5236\u4ece\u7ebf\u7a0b\u4e2d\u593a\u8d70\uff0c\u5fc5\u987b\u7b49\u7ebf\u7a0b\u81ea\u5df1\u91ca\u653e\u3002\r\n\u7b2c\u56db\u4e2a\u6761\u4ef6\u662f\u5faa\u73af\u7b49\u5f85\uff1a\u5b58\u5728\u4e00\u79cd\u7ebf\u7a0b\u7b49\u5f85\u94fe\uff0c\u7ebf\u7a0b A \u7b49\u5f85\u7ebf\u7a0b B \u6301\u6709\u7684\u8d44\u6e90\uff0c\u7ebf\u7a0b B \u7b49\u5f85\u7ebf\u7a0b C \u6301\u6709\u7684\u8d44\u6e90\uff0c\u76f4\u5230\u7ebf\u7a0b N \u53c8\u7b49\u5f85\u7ebf\u7a0b\r\nA \u6301\u6709\u7684\u8d44\u6e90\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8be5\u5982\u4f55\u907f\u514d\u6b7b\u9501\u5462",children:"\u8be5\u5982\u4f55\u907f\u514d\u6b7b\u9501\u5462\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e00\uff0c\u6240\u6709\u7ebf\u7a0b\u90fd\u6309\u7167\u56fa\u5b9a\u7684\u987a\u5e8f\u6765\u7533\u8bf7\u8d44\u6e90\u3002\u4f8b\u5982\uff0c\u5148\u7533\u8bf7 R1 \u518d\u7533\u8bf7 R2\u3002\r\n\u7b2c\u4e8c\uff0c\u5982\u679c\u7ebf\u7a0b\u53d1\u73b0\u65e0\u6cd5\u83b7\u53d6\u67d0\u4e2a\u8d44\u6e90\uff0c\u53ef\u4ee5\u5148\u91ca\u653e\u5df2\u7ecf\u6301\u6709\u7684\u8d44\u6e90\uff0c\u91cd\u65b0\u5c1d\u8bd5\u7533\u8bf7\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u6b7b\u9501\u95ee\u9898\u600e\u4e48\u6392\u67e5\u5462",children:"\ud83c\udf1f\u6b7b\u9501\u95ee\u9898\u600e\u4e48\u6392\u67e5\u5462\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"waitx"}),"\n",(0,t.jsx)(e.h3,{id:"\u804a\u804a\u7ebf\u7a0b\u540c\u6b65\u548c\u4e92\u65a5\u8865\u5145",children:"\u804a\u804a\u7ebf\u7a0b\u540c\u6b65\u548c\u4e92\u65a5\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"\u540c\u6b65\uff0c\u610f\u5473\u7740\u7ebf\u7a0b\u4e4b\u95f4\u8981\u5bc6\u5207\u5408\u4f5c\uff0c\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\u6765\u6267\u884c\u4efb\u52a1\u3002\u6bd4\u5982\u8bf4\uff0c\u7ebf\u7a0b A \u5148\u6267\u884c\uff0c\u7ebf\u7a0b B \u518d\u6267\u884c\u3002\r\n\u4e92\u65a5\uff0c\u610f\u5473\u7740\u7ebf\u7a0b\u4e4b\u95f4\u8981\u62a2\u5360\u8d44\u6e90\uff0c\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u3002\u6bd4\u5982\u8bf4\uff0c\u7ebf\u7a0b A \u5728\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u65f6\uff0c\u7ebf\u7a0b B \u4e0d\u80fd\u8bbf\u95ee\u3002\r\n\u540c\u6b65\u5173\u6ce8\u7684\u662f\u7ebf\u7a0b\u4e4b\u95f4\u7684\u534f\u4f5c\uff0c\u4e92\u65a5\u5173\u6ce8\u7684\u662f\u7ebf\u7a0b\u4e4b\u95f4\u7684\u7ade\u4e89\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u5982\u4f55\u5b9e\u73b0\u540c\u6b65\u548c\u4e92\u65a5",children:"\u5982\u4f55\u5b9e\u73b0\u540c\u6b65\u548c\u4e92\u65a5\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u53ef\u4ee5\u4f7f\u7528 synchronized \u5173\u952e\u5b57\u6216\u8005 Lock \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\uff0c\u5982 ReentrantLock \u6765\u7ed9\u8d44\u6e90\u52a0\u9501\u3002\r\n\u9501\u5728\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u7684\u610f\u601d\u662f Mutex\uff0c\u67d0\u4e2a\u7ebf\u7a0b\u8fdb\u5165\u4e34\u754c\u533a\u540e\uff0c\u4e5f\u5c31\u662f\u83b7\u53d6\u5230\u9501\u540e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u4e0d\u80fd\u518d\u8fdb\u5165\u4e34\u754c\u533a\uff0c\u8981\u963b\u585e\u7b49\u5f85\u6301\u6709\u9501\u7684\u7ebf\u7a0b\u79bb\u5f00\u4e34\u754c\u533a\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u5b9e\u73b0\u540c\u6b65\u548c\u4e92\u65a5",src:r(56928).A+"",width:"1538",height:"1072"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u9501\u8981\u89e3\u51b3\u54ea\u4e9b\u95ee\u9898",children:"\u9501\u8981\u89e3\u51b3\u54ea\u4e9b\u95ee\u9898\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e00\uff0c\u8c01\u53ef\u4ee5\u62ff\u5230\u9501\uff0c\u53ef\u4ee5\u662f\u7c7b\u5bf9\u8c61\uff0c\u53ef\u4ee5\u662f\u5f53\u524d\u7684 this \u5bf9\u8c61\uff0c\u4e5f\u53ef\u4ee5\u662f\u4efb\u4f55\u5176\u4ed6\u65b0\u5efa\u7684\u5bf9\u8c61\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"synchronized (this){\r\n        // \u4e34\u754c\u533a\r\n        }\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e8c\uff0c\u62a2\u5360\u9501\u7684\u89c4\u5219\uff0c\u80fd\u4e0d\u80fd\u62a2\u5360\u591a\u6b21\uff0c\u81ea\u5df1\u80fd\u4e0d\u80fd\u53cd\u590d\u62a2\u3002\r\n\u7b2c\u4e09\uff0c\u62a2\u4e0d\u5230\u600e\u4e48\u529e\uff0c\u81ea\u65cb\uff1f\u963b\u585e\uff1f\u6216\u8005\u8d85\u65f6\u653e\u5f03\uff1f\r\n\u7b2c\u56db\uff0c\u9501\u88ab\u91ca\u653e\u4e86\u8fd8\u5728\u7b49\u5f85\u9501\u7684\u7ebf\u7a0b\u600e\u4e48\u529e\uff1f\u662f\u901a\u77e5\u6240\u6709\u7ebf\u7a0b\u4e00\u8d77\u62a2\u6216\u8005\u53ea\u544a\u8bc9\u4e00\u4e2a\u7ebf\u7a0b\u62a2\uff1f"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4\u81ea\u65cb\u9501",children:"\u8bf4\u8bf4\u81ea\u65cb\u9501\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u81ea\u65cb\u9501\u662f\u6307\u5f53\u7ebf\u7a0b\u5c1d\u8bd5\u83b7\u53d6\u9501\u65f6\uff0c\u5982\u679c\u9501\u5df2\u7ecf\u88ab\u5360\u7528\uff0c\u7ebf\u7a0b\u4e0d\u4f1a\u7acb\u5373\u963b\u585e\uff0c\u800c\u662f\u901a\u8fc7\u81ea\u65cb\uff0c\u4e5f\u5c31\u662f\u5faa\u73af\u7b49\u5f85\u7684\u65b9\u5f0f\u4e0d\u65ad\u5c1d\u8bd5\u83b7\u53d6\u9501\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-text",children:"\u7ebf\u7a0b1        \u7ebf\u7a0b2\r\n|            |\r\n| \u83b7\u53d6\u9501\u6210\u529f   | \u5c1d\u8bd5\u83b7\u53d6\u9501\r\n|------------\x3e|\uff08\u9501\u5df2\u88ab\u5360\u7528\uff0c\u81ea\u65cb\u7b49\u5f85\uff09\r\n| \u91ca\u653e\u9501      |\r\n|<------------| \u83b7\u53d6\u9501\u6210\u529f\r\n|            |\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u9002\u7528\u4e8e\u9501\u6301\u6709\u65f6\u95f4\u77ed\u7684\u573a\u666f\uff0cReentrantLock \u7684 tryLock \u65b9\u6cd5\u5c31\u7528\u5230\u4e86\u81ea\u65cb\u9501\u3002\r\n",(0,t.jsx)(e.img,{alt:"ReentrantLock\u81ea\u65cb",src:r(37021).A+"",width:"1258",height:"896"}),"\r\n\u81ea\u65cb\u9501\u7684\u4f18\u70b9\u662f\u53ef\u4ee5\u907f\u514d\u7ebf\u7a0b\u5207\u6362\u5e26\u6765\u7684\u5f00\u9500\uff0c\u7f3a\u70b9\u662f\u5982\u679c\u9501\u88ab\u5360\u7528\u65f6\u95f4\u8fc7\u957f\uff0c\u4f1a\u5bfc\u81f4\u7ebf\u7a0b\u7a7a\u8f6c\uff0c\u6d6a\u8d39 CPU \u8d44\u6e90\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class SpinLock {\r\n    private AtomicBoolean lock = new AtomicBoolean(false);\r\n\r\n    public void lock() {\r\n        while (!lock.compareAndSet(false, true)) {\r\n            // \u81ea\u65cb\u7b49\u5f85\uff0c\u4e0d\u65ad\u5c1d\u8bd5\u83b7\u53d6\u9501\r\n        }\r\n    }\r\n\r\n    public void unlock() {\r\n        lock.set(false);\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        SpinLock spinLock = new SpinLock();\r\n\r\n        Runnable task = () -> {\r\n            spinLock.lock();\r\n            try {\r\n                System.out.println(Thread.currentThread().getName() + " \u83b7\u53d6\u5230\u9501");\r\n            } finally {\r\n                spinLock.unlock();\r\n            }\r\n        };\r\n\r\n        Thread t1 = new Thread(task);\r\n        Thread t2 = new Thread(task);\r\n\r\n        t1.start();\r\n        t2.start();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u81ea\u65cb\u9501\u4f1a\u4e00\u76f4\u7b49\u5f85\uff0c\u76f4\u5230\u83b7\u53d6\u5230\u9501\u4e3a\u6b62\u3002\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u9700\u8981\u8bbe\u7f6e\u81ea\u65cb\u6b21\u6570\u6216\u8005\u8d85\u65f6\u65f6\u95f4\u3002\u5982\u679c\u8d85\u8fc7\u9608\u503c\uff0c\u7ebf\u7a0b\u53ef\u4ee5\u653e\u5f03\u9501\u6216\u8005\u8fdb\u5165\u963b\u585e\u72b6\u6001\u3002\r\n\u4e92\u65a5\u548c\u540c\u6b65\u5728\u65f6\u95f4\u4e0a\u6709\u8981\u6c42\u5417\uff1f\r\n\u6709\u3002\r\n\u4e92\u65a5\u7684\u6838\u5fc3\u662f\u4fdd\u8bc1\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u80fd\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u3002\r\n\u540c\u6b65\u5f3a\u8c03\u7684\u662f\u7ebf\u7a0b\u4e4b\u95f4\u7684\u6267\u884c\u987a\u5e8f\uff0c\u7279\u522b\u662f\u5728\u591a\u4e2a\u7ebf\u7a0b\u9700\u8981\u4f9d\u8d56\u4e8e\u5f7c\u6b64\u7684\u6267\u884c\u7ed3\u679c\u65f6\u3002\r\n\u4f8b\u5982\uff0c\u5728 CountDownLatch \u4e2d\uff0c\u4e3b\u7ebf\u7a0b\u4f1a\u7b49\u5f85\u591a\u4e2a\u5b50\u7ebf\u7a0b\u7684\u4efb\u52a1\u5b8c\u6210\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class SyncExample {\r\n    public static void main(String[] args) throws InterruptedException {\r\n        CountDownLatch latch = new CountDownLatch(3);\r\n\r\n        // \u521b\u5efa3\u4e2a\u5b50\u7ebf\u7a0b\r\n        for (int i = 0; i < 3; i++) {\r\n            new Thread(() -> {\r\n                try {\r\n                    Thread.sleep(1000); // \u6a21\u62df\u4efb\u52a1\r\n                    System.out.println("\u6253\u5b8c\u738b\u8005\u4e86.");\r\n                } catch (InterruptedException e) {\r\n                    e.printStackTrace();\r\n                } finally {\r\n                    latch.countDown(); // \u6bcf\u4e2a\u7ebf\u7a0b\u4efb\u52a1\u5b8c\u6210\u540e\u8ba1\u6570\u5668\u51cf1\r\n                }\r\n            }).start();\r\n        }\r\n\r\n        System.out.println("\u7b49\u6253\u5b8c\u4e09\u628a\u738b\u8005\u5c31\u53bb\u7761\u89c9...");\r\n        latch.await(); // \u4e3b\u7ebf\u7a0b\u7b49\u5f85\u5b50\u7ebf\u7a0b\u5b8c\u6210\r\n        System.out.println("\u597d\uff0c\u738b\u8005\u73a9\u5b8c\u4e86\uff0c\u53ef\u4ee5\u7761\u4e86");\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u6240\u6709\u5b50\u7ebf\u7a0b\u5b8c\u6210\u540e\uff0c\u4e3b\u7ebf\u7a0b\u624d\u4f1a\u7ee7\u7eed\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u804a\u804a\u60b2\u89c2\u9501\u548c\u4e50\u89c2\u9501\u8865\u5145",children:"\ud83c\udf1f\u804a\u804a\u60b2\u89c2\u9501\u548c\u4e50\u89c2\u9501\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"\u597d\u7684\u3002\r\n\u60b2\u89c2\u9501\u8ba4\u4e3a\u6bcf\u6b21\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u65f6\u90fd\u4f1a\u53d1\u751f\u51b2\u7a81\uff0c\u6240\u5728\u5728\u64cd\u4f5c\u524d\u4e00\u5b9a\u8981\u5148\u52a0\u9501\uff0c\u9632\u6b62\u5176\u4ed6\u7ebf\u7a0b\u4fee\u6539\u6570\u636e\u3002\r\n\u4e50\u89c2\u9501\u8ba4\u4e3a\u51b2\u7a81\u4e0d\u4f1a\u603b\u662f\u53d1\u751f\uff0c\u6240\u4ee5\u5728\u64cd\u4f5c\u524d\u4e0d\u52a0\u9501\uff0c\u800c\u662f\u5728\u66f4\u65b0\u6570\u636e\u65f6\u68c0\u67e5\u662f\u5426\u6709\u5176\u4ed6\u7ebf\u7a0b\u4fee\u6539\u4e86\u6570\u636e\u3002\u5982\u679c\u53d1\u73b0\u6570\u636e\u88ab\u4fee\u6539\u4e86\uff0c\u5c31\u4f1a\u91cd\u8bd5\u3002\r\n\u4e50\u89c2\u9501\u53d1\u73b0\u6709\u7ebf\u7a0b\u8fc7\u6765\u4fee\u6539\u6570\u636e\uff0c\u600e\u4e48\u529e\uff1f\r\n\u53ef\u4ee5\u91cd\u65b0\u8bfb\u53d6\u6570\u636e\uff0c\u7136\u540e\u518d\u5c1d\u8bd5\u66f4\u65b0\uff0c\u76f4\u5230\u6210\u529f\u4e3a\u6b62\u6216\u8fbe\u5230\u6700\u5927\u91cd\u8bd5\u6b21\u6570\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class CasRetryExample {\r\n    private static AtomicInteger counter = new AtomicInteger(0);\r\n    private static final int MAX_RETRIES = 5;\r\n\r\n    public static void main(String[] args) {\r\n        boolean success = false;\r\n        int retries = 0;\r\n\r\n        while (retries < MAX_RETRIES) {\r\n            int currentValue = counter.get();\r\n            boolean updated = counter.compareAndSet(currentValue, currentValue + 1);\r\n\r\n            if (updated) {\r\n                System.out.println("\u66f4\u65b0\u6210\u529f\uff0c\u5f53\u524d\u503c: " + counter.get());\r\n                success = true;\r\n                break;\r\n            } else {\r\n                retries++;\r\n                System.out.println("\u66f4\u65b0\u5931\u8d25\uff0c\u8fdb\u884c\u7b2c " + retries + " \u6b21\u91cd\u8bd5");\r\n            }\r\n        }\r\n\r\n        if (!success) {\r\n            System.out.println("\u8fbe\u5230\u6700\u5927\u91cd\u8bd5\u6b21\u6570\uff0c\u64cd\u4f5c\u5931\u8d25");\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u5e76\u53d1\u5de5\u5177\u7c7b",children:"\u5e76\u53d1\u5de5\u5177\u7c7b"}),"\n",(0,t.jsx)(e.h3,{id:"countdownlatch-\u4e86\u89e3\u5417",children:"CountDownLatch \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u63a8\u8350\u9605\u8bfb\uff1aSemaphore\u3001Exchanger\u3001CountDownLatch\u3001CyclicBarrier\u3001Phaser\uff0c\u4e00\u7f51\u6253\u5c3d\r\nCountDownLatch \u662f JUC \u4e2d\u7684\u4e00\u4e2a\u540c\u6b65\u5de5\u5177\u7c7b\uff0c\u7528\u4e8e\u534f\u8c03\u591a\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u7684\u540c\u6b65\uff0c\u786e\u4fdd\u4e3b\u7ebf\u7a0b\u5728\u591a\u4e2a\u5b50\u7ebf\u7a0b\u5b8c\u6210\u4efb\u52a1\u540e\u7ee7\u7eed\u6267\u884c\u3002\r\n\u5b83\u7684\u6838\u5fc3\u601d\u60f3\u662f\u901a\u8fc7\u4e00\u4e2a\u5012\u8ba1\u65f6\u8ba1\u6570\u5668\u6765\u63a7\u5236\u591a\u4e2a\u7ebf\u7a0b\u7684\u6267\u884c\u987a\u5e8f\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class CountDownLatchExample {\r\n    public static void main(String[] args) throws InterruptedException {\r\n        int threadCount = 3;\r\n        CountDownLatch latch = new CountDownLatch(threadCount);\r\n\r\n        for (int i = 0; i < threadCount; i++) {\r\n            new Thread(() -> {\r\n                try {\r\n                    Thread.sleep((long) (Math.random() * 1000)); // \u6a21\u62df\u4efb\u52a1\u6267\u884c\r\n                    System.out.println(Thread.currentThread().getName() + " \u6267\u884c\u5b8c\u6bd5");\r\n                } catch (InterruptedException e) {\r\n                    e.printStackTrace();\r\n                } finally {\r\n                    latch.countDown(); // \u7ebf\u7a0b\u5b8c\u6210\u540e\uff0c\u8ba1\u6570\u5668 -1\r\n                }\r\n            }).start();\r\n        }\r\n\r\n        latch.await(); // \u4e3b\u7ebf\u7a0b\u7b49\u5f85\r\n        System.out.println("\u6240\u6709\u5b50\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\uff0c\u4e3b\u7ebf\u7a0b\u7ee7\u7eed\u6267\u884c");\r\n    }\r\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u4f7f\u7528\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u5148\u521d\u59cb\u5316\u4e00\u4e2a CountDownLatch \u5bf9\u8c61\uff0c\u6307\u5b9a\u4e00\u4e2a\u8ba1\u6570\u5668\u7684\u521d\u59cb\u503c\uff0c\u8868\u793a\u9700\u8981\u7b49\u5f85\u7684\u7ebf\u7a0b\u6570\u91cf\u3002\r\n\u7136\u540e\u5728\u6bcf\u4e2a\u5b50\u7ebf\u7a0b\u6267\u884c\u5b8c\u4efb\u52a1\u540e\uff0c\u8c03\u7528 countDown() \u65b9\u6cd5\uff0c\u8ba1\u6570\u5668\u51cf 1\u3002\r\n\u63a5\u7740\u4e3b\u7ebf\u7a0b\u8c03\u7528 await() \u65b9\u6cd5\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u8ba1\u6570\u5668\u4e3a 0\uff0c\u4e5f\u5c31\u662f\u6240\u6709\u5b50\u7ebf\u7a0b\u90fd\u6267\u884c\u5b8c\u4efb\u52a1\u540e\uff0c\u4e3b\u7ebf\u7a0b\u624d\u4f1a\u7ee7\u7eed\u6267\u884c\u3002\r\n",(0,t.jsx)(e.img,{alt:"CountDownLatch\u7b49\u5f85",src:r(35227).A+"",width:"1796",height:"954"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'public static void main(String[] args) throws InterruptedException {\r\n    CountDownLatch countDownLatch = new CountDownLatch(5);\r\n\r\n    Thread daqiao = new Thread(() -> {\r\n        System.out.println("\u5927\u4e54\u5df2\u5c31\u4f4d\uff01");\r\n        countDownLatch.countDown();\r\n    });\r\n    Thread lanlingwang = new Thread(() -> {\r\n        System.out.println("\u5170\u9675\u738b\u5df2\u5c31\u4f4d\uff01");\r\n        countDownLatch.countDown();\r\n    });\r\n    Thread anqila = new Thread(() -> {\r\n        System.out.println("\u5b89\u5176\u62c9\u5df2\u5c31\u4f4d\uff01");\r\n        countDownLatch.countDown();\r\n    });\r\n    Thread nezha = new Thread(() -> {\r\n        System.out.println("\u54ea\u5412\u5df2\u5c31\u4f4d\uff01");\r\n        countDownLatch.countDown();\r\n    });\r\n    Thread kai = new Thread(() -> {\r\n        System.out.println("\u94e0\u5df2\u5c31\u4f4d\uff01");\r\n        countDownLatch.countDown();\r\n    });\r\n\r\n    daqiao.start();\r\n    lanlingwang.start();\r\n    anqila.start();\r\n    nezha.start();\r\n    kai.start();\r\n\r\n    countDownLatch.await();\r\n    System.out.println("\u5168\u5458\u5c31\u4f4d\uff0c\u5f00\u59cb\u6e38\u620f\uff01");\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4e94\u4e2a\u73a9\u5bb6\u5728\u5012\u8ba1\u65f6\u7ed3\u675f\u540e\uff0c\u4e00\u8d77\u51fa\u51fb\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'private static void waitToFight(CountDownLatch countDownLatch, String name) {\r\n    try {\r\n        countDownLatch.await(); // \u5728\u6b64\u7b49\u5f85\u4fe1\u53f7\u518d\u7ee7\u7eed\r\n        System.out.println(name + " \u6536\u5230\uff0c\u53d1\u8d77\u8fdb\u653b\uff01");\r\n    } catch (InterruptedException e) {\r\n        Thread.currentThread().interrupt();\r\n        System.out.println(name + " \u88ab\u4e2d\u65ad");\r\n    }\r\n}\r\n\r\npublic static void main(String[] args) {\r\n    CountDownLatch countDownLatch = new CountDownLatch(1);\r\n\r\n    Thread daqiao = new Thread(() -> waitToFight(countDownLatch, "\u5927\u4e54"), "Thread-\u5927\u4e54");\r\n    Thread lanlingwang = new Thread(() -> waitToFight(countDownLatch, "\u5170\u9675\u738b"), "Thread-\u5170\u9675\u738b");\r\n    Thread anqila = new Thread(() -> waitToFight(countDownLatch, "\u5b89\u742a\u62c9"), "Thread-\u5b89\u742a\u62c9");\r\n    Thread nezha = new Thread(() -> waitToFight(countDownLatch, "\u54ea\u5412"), "Thread-\u54ea\u5412");\r\n    Thread kai = new Thread(() -> waitToFight(countDownLatch, "\u51ef"), "Thread-\u51ef");\r\n\r\n    daqiao.start();\r\n    lanlingwang.start();\r\n    anqila.start();\r\n    nezha.start();\r\n    kai.start();\r\n\r\n    try {\r\n        Thread.sleep(5000); // \u6a21\u62df\u51c6\u5907\u65f6\u95f4\r\n    } catch (InterruptedException e) {\r\n        Thread.currentThread().interrupt();\r\n        System.out.println("\u4e3b\u7ebf\u7a0b\u88ab\u4e2d\u65ad");\r\n    }\r\n\r\n    System.out.println("\u654c\u519b\u8fd8\u6709 5 \u79d2\u5230\u8fbe\u6218\u573a\uff0c\u5168\u519b\u51fa\u51fb\uff01");\r\n    countDownLatch.countDown(); // \u53d1\u51fa\u4fe1\u53f7\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u573a\u666f\u9898\u5047\u5982\u8981\u67e510\u4e07\u591a\u6761\u6570\u636e\u7528\u7ebf\u7a0b\u6c60\u5206\u621020\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\u600e\u4e48\u505a\u5230\u7b49\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u67e5\u627e\u5b8c\u4e4b\u540e\u5373\u6700\u540e\u4e00\u6761\u7ed3\u679c\u67e5\u627e\u7ed3\u675f\u4e86\u624d\u8f93\u51fa\u7ed3\u679c",children:"\u573a\u666f\u9898\uff1a\u5047\u5982\u8981\u67e510\u4e07\u591a\u6761\u6570\u636e\uff0c\u7528\u7ebf\u7a0b\u6c60\u5206\u621020\u4e2a\u7ebf\u7a0b\u53bb\u6267\u884c\uff0c\u600e\u4e48\u505a\u5230\u7b49\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u67e5\u627e\u5b8c\u4e4b\u540e\uff0c\u5373\u6700\u540e\u4e00\u6761\u7ed3\u679c\u67e5\u627e\u7ed3\u675f\u4e86\uff0c\u624d\u8f93\u51fa\u7ed3\u679c\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f88\u7b80\u5355\uff0c\u53ef\u4ee5\u4f7f\u7528 CountDownLatch \u6765\u5b9e\u73b0\u3002CountDownLatch \u975e\u5e38\u9002\u5408\u8fd9\u4e2a\u573a\u666f\u3002\r\n\u7b2c\u4e00\u6b65\uff0c\u521b\u5efa CountDownLatch \u5bf9\u8c61\uff0c\u521d\u59cb\u503c\u8bbe\u5b9a\u4e3a 20\uff0c\u8868\u793a 20 \u4e2a\u7ebf\u7a0b\u9700\u8981\u5b8c\u6210\u4efb\u52a1\u3002\r\n\u7b2c\u4e8c\u6b65\uff0c\u521b\u5efa\u7ebf\u7a0b\u6c60\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u6267\u884c\u67e5\u8be2\u64cd\u4f5c\uff0c\u67e5\u8be2\u5b8c\u6bd5\u540e\u8c03\u7528 countDown() \u65b9\u6cd5\uff0c\u8ba1\u6570\u5668\u51cf 1\u3002\r\n\u7b2c\u4e09\u6b65\uff0c\u4e3b\u7ebf\u7a0b\u8c03\u7528 await() \u65b9\u6cd5\uff0c\u7b49\u5f85\u6240\u6709\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class DataQueryExample {\r\n\r\n    public static void main(String[] args) throws InterruptedException {\r\n        // \u6a21\u62df10\u4e07\u6761\u6570\u636e\r\n        int totalRecords = 100000;\r\n        int threadCount = 20;\r\n        int batchSize = totalRecords / threadCount; // \u6bcf\u4e2a\u7ebf\u7a0b\u5904\u7406\u7684\u6570\u636e\u91cf\r\n\r\n        // \u521b\u5efa\u7ebf\u7a0b\u6c60\r\n        ExecutorService executor = Executors.newFixedThreadPool(threadCount);\r\n        CountDownLatch latch = new CountDownLatch(threadCount);\r\n\r\n        // \u6a21\u62df\u67e5\u8be2\u7ed3\u679c\r\n        ConcurrentLinkedQueue<String> results = new ConcurrentLinkedQueue<>();\r\n\r\n        for (int i = 0; i < threadCount; i++) {\r\n            int start = i * batchSize;\r\n            int end = (i == threadCount - 1) ? totalRecords : (start + batchSize);\r\n\r\n            executor.execute(() -> {\r\n                try {\r\n                    // \u6a21\u62df\u67e5\u8be2\u64cd\u4f5c\r\n                    for (int j = start; j < end; j++) {\r\n                        results.add("Data-" + j);\r\n                    }\r\n                    System.out.println(Thread.currentThread().getName() + " \u5904\u7406\u6570\u636e " + start + " - " + end);\r\n                } finally {\r\n                    latch.countDown(); // \u7ebf\u7a0b\u4efb\u52a1\u5b8c\u6210\uff0c\u8ba1\u6570\u5668\u51cf1\r\n                }\r\n            });\r\n        }\r\n\r\n        // \u7b49\u5f85\u6240\u6709\u7ebf\u7a0b\u5b8c\u6210\r\n        latch.await();\r\n        executor.shutdown();\r\n\r\n        // \u8f93\u51fa\u7ed3\u679c\r\n        System.out.println("\u6240\u6709\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\uff0c\u67e5\u8be2\u7ed3\u679c\u603b\u6570\uff1a" + results.size());\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"cyclicbarrier-\u4e86\u89e3\u5417",children:"CyclicBarrier \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["CyclicBarrier \u7684\u5b57\u9762\u610f\u601d\u662f\u53ef\u5faa\u73af\u4f7f\u7528\u7684\u5c4f\u969c\uff0c\u7528\u4e8e\u591a\u4e2a\u7ebf\u7a0b\u76f8\u4e92\u7b49\u5f85\uff0c\u76f4\u5230\u6240\u6709\u7ebf\u7a0b\u90fd\u5230\u8fbe\u5c4f\u969c\u540e\u518d\u540c\u65f6\u6267\u884c\u3002\r\n",(0,t.jsx)(e.img,{alt:"CyclicBarrier\u6d41\u7a0b",src:r(70172).A+"",width:"1321",height:"536"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class CyclicBarrierExample {\r\n    private static final int THREAD_COUNT = 3;\r\n    private static final CyclicBarrier barrier = new CyclicBarrier(THREAD_COUNT);\r\n\r\n    public static void main(String[] args) {\r\n        for (int i = 0; i < THREAD_COUNT; i++) {\r\n            new Thread(() -> {\r\n                try {\r\n                    System.out.println(Thread.currentThread().getName() + " \u5230\u8fbe\u5c4f\u969c");\r\n                    barrier.await(); // \u7ebf\u7a0b\u963b\u585e\uff0c\u76f4\u5230\u6240\u6709\u7ebf\u7a0b\u90fd\u5230\u8fbe\r\n                    System.out.println(Thread.currentThread().getName() + " \u7ee7\u7eed\u6267\u884c");\r\n                } catch (InterruptedException | BrokenBarrierException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            }).start();\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"cyclicbarrier-\u548c-countdownlatch-\u6709\u4ec0\u4e48\u533a\u522b",children:"CyclicBarrier \u548c CountDownLatch \u6709\u4ec0\u4e48\u533a\u522b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"CyclicBarrier \u8ba9\u6240\u6709\u7ebf\u7a0b\u76f8\u4e92\u7b49\u5f85\uff0c\u5168\u90e8\u5230\u8fbe\u540e\u518d\u7ee7\u7eed\uff1bCountDownLatch \u8ba9\u4e3b\u7ebf\u7a0b\u7b49\u5f85\u6240\u6709\u5b50\u7ebf\u7a0b\u6267\u884c\u5b8c\u518d\u7ee7\u7eed\u3002\r\n\u5bf9\u6bd4\u9879 CyclicBarrier CountDownLatch\r\n\u4e3b\u8981\u7528\u9014 \u8ba9\u6240\u6709\u7ebf\u7a0b\u76f8\u4e92\u7b49\u5f85\uff0c\u5168\u90e8\u5230\u8fbe\u540e\u518d\u7ee7\u7eed \u8ba9\u4e3b\u7ebf\u7a0b\u7b49\u5f85\u6240\u6709\u5b50\u7ebf\u7a0b\u6267\u884c\u5b8c\r\n\u53ef\u91cd\u7528\u6027 \u2705 \u53ef\u91cd\u590d\u4f7f\u7528\uff0c\u6bcf\u6b21\u5c4f\u969c\u6253\u5f00\u540e\u81ea\u52a8\u91cd\u7f6e \u274c \u4e0d\u53ef\u91cd\u590d\u4f7f\u7528\uff0c\u8ba1\u6570\u5668\u5f52\u96f6\u540e\u4e0d\u80fd\u6062\u590d\r\n\u662f\u5426\u53ef\u6267\u884c\u56de\u8c03 \u2705 \u53ef\u4ee5\uff0c\u6240\u6709\u7ebf\u7a0b\u5230\u8fbe\u5c4f\u969c\u540e\u53ef\u6267\u884c barrierAction \u274c \u4e0d\u80fd\r\n\u7ebf\u7a0b\u7b49\u5f85\u60c5\u51b5 \u6240\u6709\u7ebf\u7a0b\u4e92\u76f8\u7b49\u5f85\uff0c\u4e00\u4e2a\u7ebf\u7a0b\u672a\u5230\u8fbe\uff0c\u5176\u4ed6\u7ebf\u7a0b\u90fd\u4f1a\u963b\u585e \u4e3b\u7ebf\u7a0b\u7b49\u5f85\u6240\u6709\u5b50\u7ebf\u7a0b\u5b8c\u6210\uff0c\u5b50\u7ebf\u7a0b\u6267\u884c\u5b8c\u540e\u53ef\u7ee7\u7eed\u8fd0\u884c\r\n\u9002\u7528\u573a\u666f \u7ebf\u7a0b\u76f8\u4e92\u4f9d\u8d56\uff0c\u9700\u8981\u540c\u6b65\u6267\u884c \u4e3b\u7ebf\u7a0b\u7b49\u5f85\u5b50\u7ebf\u7a0b\u5b8c\u6210\r\n\u793a\u4f8b\u573a\u666f \u8ba1\u7b97\u4efb\u52a1\u62c6\u5206\uff0c\u6240\u6709\u7ebf\u7a0b\u90fd\u5230\u8fbe\u540e\u624d\u80fd\u7ee7\u7eed \u4e3b\u7ebf\u7a0b\u7b49\u591a\u4e2a\u4efb\u52a1\u521d\u59cb\u5316\u5b8c\u6210"}),"\n",(0,t.jsx)(e.h3,{id:"semaphore-\u4e86\u89e3\u5417",children:"Semaphore \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["Semaphore\u2014\u2014\u4fe1\u53f7\u91cf\uff0c\u7528\u4e8e\u63a7\u5236\u540c\u65f6\u8bbf\u95ee\u67d0\u4e2a\u8d44\u6e90\u7684\u7ebf\u7a0b\u6570\u91cf\uff0c\u7c7b\u4f3c\u9650\u6d41\u5668\uff0c\u786e\u4fdd\u6700\u591a\u53ea\u6709\u6307\u5b9a\u6570\u91cf\u7684\u7ebf\u7a0b\u80fd\u591f\u8bbf\u95ee\u67d0\u4e2a\u8d44\u6e90\uff0c\u8d85\u8fc7\u7684\u5fc5\u987b\u7b49\u5f85\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u4fe1\u53f7\u91cf",src:r(36633).A+"",width:"1150",height:"1306"}),"\r\n\u62ff\u505c\u8f66\u573a\u6765\u4e3e\u4f8b\u3002\r\n\u505c\u8f66\u573a\u7684\u8f66\u4f4d\u662f\u6709\u9650\u7684\uff0c\u5982\u679c\u6709\u7a7a\u4f4d\uff0c\u663e\u793a\u724c\u9700\u8981\u663e\u793a\u5269\u4f59\u7684\u8f66\u4f4d\uff0c\u8f66\u8f86\u5c31\u53ef\u4ee5\u9a76\u5165\uff1b\u5426\u5219\u5c31\u4f1a\u663e\u793a\u6570\u5b57 0\uff0c\u65b0\u6765\u7684\u8f66\u8f86\u5c31\u5f97\u6392\u961f\u7b49\u5f85\u3002\r\n\u5982\u679c\u6709\u8f66\u79bb\u5f00\uff0c\u663e\u793a\u724c\u91cd\u65b0\u663e\u793a\u95f2\u7f6e\u7684\u8f66\u4f4d\u6570\u91cf\uff0c\u7b49\u5f85\u7684\u8f66\u8f86\u6309\u5e8f\u9a76\u5165\u505c\u8f66\u573a\u3002\r\n\u5728\u4f7f\u7528 Semaphore \u65f6\uff0c\u9996\u5148\u9700\u8981\u521d\u59cb\u5316\u4e00\u4e2a Semaphore \u5bf9\u8c61\uff0c\u6307\u5b9a\u8bb8\u53ef\u8bc1\u6570\u91cf\uff0c\u8868\u793a\u6700\u591a\u5141\u8bb8\u591a\u5c11\u4e2a\u7ebf\u7a0b\u540c\u65f6\u8bbf\u95ee\u8d44\u6e90\u3002\r\n\u7136\u540e\u5728\u6bcf\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u8d44\u6e90\u524d\uff0c\u8c03\u7528 acquire() \u65b9\u6cd5\u83b7\u53d6\u8bb8\u53ef\u8bc1\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u7528\u8bb8\u53ef\u8bc1\uff0c\u5219\u963b\u585e\u7b49\u5f85\u3002\r\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8bbf\u95ee\u5b8c\u8d44\u6e90\u540e\uff0c\u8981\u8c03\u7528 release() \u65b9\u6cd5\u91ca\u653e\u8bb8\u53ef\u8bc1\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class SemaphoreExample {\r\n    private static final int THREAD_COUNT = 5;\r\n    private static final Semaphore semaphore = new Semaphore(2); // \u6700\u591a\u5141\u8bb8 2 \u4e2a\u7ebf\u7a0b\u8bbf\u95ee\r\n\r\n    public static void main(String[] args) {\r\n        for (int i = 0; i < THREAD_COUNT; i++) {\r\n            new Thread(() -> {\r\n                try {\r\n                    semaphore.acquire(); // \u83b7\u53d6\u8bb8\u53ef\uff08\u5982\u679c\u6ca1\u6709\u53ef\u7528\u8bb8\u53ef\uff0c\u5219\u963b\u585e\uff09\r\n                    System.out.println(Thread.currentThread().getName() + " \u8bbf\u95ee\u8d44\u6e90...");\r\n                    Thread.sleep(2000); // \u6a21\u62df\u4efb\u52a1\u6267\u884c\r\n                } catch (InterruptedException e) {\r\n                    e.printStackTrace();\r\n                } finally {\r\n                    semaphore.release(); // \u91ca\u653e\u8bb8\u53ef\r\n                }\r\n            }).start();\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"Semaphore \u53ef\u4ee5\u7528\u4e8e\u6d41\u91cf\u63a7\u5236\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3001\u7f51\u7edc\u8fde\u63a5\u6c60\u7b49\u3002\r\n\u5047\u5982\u6709\u8fd9\u6837\u4e00\u4e2a\u9700\u6c42\uff0c\u8981\u8bfb\u53d6\u51e0\u4e07\u4e2a\u6587\u4ef6\u7684\u6570\u636e\uff0c\u56e0\u4e3a\u90fd\u662f IO \u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u6211\u4eec\u53ef\u4ee5\u542f\u52a8\u51e0\u5341\u4e2a\u7ebf\u7a0b\u5e76\u53d1\u5730\u8bfb\u53d6\u3002\r\n\u4f46\u662f\u5728\u8bfb\u5230\u5185\u5b58\u540e\uff0c\u9700\u8981\u5b58\u50a8\u5230\u6570\u636e\u5e93\uff0c\u800c\u6570\u636e\u5e93\u8fde\u63a5\u6570\u662f\u6709\u9650\u7684\uff0c\u6bd4\u5982\u8bf4\u53ea\u6709 10 \u4e2a\uff0c\u90a3\u6211\u4eec\u5c31\u5fc5\u987b\u63a7\u5236\u7ebf\u7a0b\u7684\u6570\u91cf\uff0c\u4fdd\u8bc1\u540c\u65f6\u53ea\u6709 10\r\n\u4e2a\u7ebf\u7a0b\u5728\u4f7f\u7528\u6570\u636e\u5e93\u8fde\u63a5\u3002\r\n\u8fd9\u4e2a\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 Semaphore \u6765\u505a\u6d41\u91cf\u63a7\u5236\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class SemaphoreTest {\r\n    private static final int THREAD_COUNT = 30;\r\n    private static ExecutorService threadPool = Executors.newFixedThreadPool(THREAD_COUNT);\r\n    private static Semaphore s = new Semaphore(10);\r\n\r\n    public static void main(String[] args) {\r\n        for (int i = 0; i < THREAD_COUNT; i++) {\r\n            threadPool.execute(new Runnable() {\r\n                @Override\r\n                public void run() {\r\n                    try {\r\n                        s.acquire();\r\n                        System.out.println("save data");\r\n                        s.release();\r\n                    } catch (InterruptedException e) {\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        threadPool.shutdown();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"exchanger-\u4e86\u89e3\u5417",children:"Exchanger \u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["Exchanger\u2014\u2014\u4ea4\u6362\u8005\uff0c\u7528\u4e8e\u5728\u4e24\u4e2a\u7ebf\u7a0b\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u3002\r\n",(0,t.jsx)(e.img,{alt:"Exchanger",src:r(12485).A+"",width:"2260",height:"782"}),"\r\n\u652f\u6301\u53cc\u5411\u6570\u636e\u4ea4\u6362\uff0c\u6bd4\u5982\u8bf4\u7ebf\u7a0b A \u8c03\u7528 exchange(dataA)\uff0c\u7ebf\u7a0b B \u8c03\u7528 exchange(dataB)\uff0c\u5b83\u4eec\u4f1a\u5728\u540c\u6b65\u70b9\u4ea4\u6362\u6570\u636e\uff0c\u5373 A \u5f97\u5230 B \u7684\u6570\u636e\uff0cB\r\n\u5f97\u5230 A \u7684\u6570\u636e\u3002\r\n\u5982\u679c\u4e00\u4e2a\u7ebf\u7a0b\u5148\u8c03\u7528 exchange()\uff0c\u5b83\u4f1a\u963b\u585e\u7b49\u5f85\uff0c\u76f4\u5230\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u4e5f\u8c03\u7528 exchange()\u3002\r\n\u4f7f\u7528 Exchanger \u7684\u65f6\u5019\uff0c\u9700\u8981\u5148\u521b\u5efa\u4e00\u4e2a Exchanger \u5bf9\u8c61\uff0c\u7136\u540e\u5728\u4e24\u4e2a\u7ebf\u7a0b\u4e2d\u8c03\u7528 exchange() \u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u6570\u636e\u4ea4\u6362\u4e86\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ExchangerExample {\r\n    private static final Exchanger<String> exchanger = new Exchanger<>();\r\n\r\n    public static void main(String[] args) {\r\n        new Thread(() -> {\r\n            try {\r\n                String threadAData = "\u6570\u636e A";\r\n                System.out.println("\u7ebf\u7a0b A \u4ea4\u6362\u524d\u7684\u6570\u636e\uff1a" + threadAData);\r\n                String received = exchanger.exchange(threadAData);\r\n                System.out.println("\u7ebf\u7a0b A \u6536\u5230\u7684\u6570\u636e\uff1a" + received);\r\n            } catch (InterruptedException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }).start();\r\n\r\n        new Thread(() -> {\r\n            try {\r\n                String threadBData = "\u6570\u636e B";\r\n                System.out.println("\u7ebf\u7a0b B \u4ea4\u6362\u524d\u7684\u6570\u636e\uff1a" + threadBData);\r\n                String received = exchanger.exchange(threadBData);\r\n                System.out.println("\u7ebf\u7a0b B \u6536\u5230\u7684\u6570\u636e\uff1a" + received);\r\n            } catch (InterruptedException e) {\r\n                e.printStackTrace();\r\n            }\r\n        }).start();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"Exchanger \u53ef\u4ee5\u7528\u4e8e\u9057\u4f20\u7b97\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u6821\u5bf9\u5de5\u4f5c\uff0c\u6bd4\u5982\u6211\u4eec\u5c06\u7eb8\u5236\u94f6\u884c\u6d41\u6c34\u901a\u8fc7\u4eba\u5de5\u7684\u65b9\u5f0f\u5f55\u5165\u5230\u7535\u5b50\u94f6\u884c\u65f6\uff0c\u4e3a\u4e86\u907f\u514d\u9519\u8bef\uff0c\u53ef\u4ee5\u5f55\u5165\u4e24\u904d\uff0c\u7136\u540e\u901a\u8fc7\r\nExchanger \u6765\u6821\u5bf9\u4e24\u6b21\u5f55\u5165\u7684\u7ed3\u679c\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ExchangerTest {\r\n    private static final Exchanger<String> exgr = new Exchanger<String>();\r\n    private static ExecutorService threadPool = Executors.newFixedThreadPool(2);\r\n\r\n    public static void main(String[] args) {\r\n        threadPool.execute(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                try {\r\n                    String A = "\u94f6\u884c\u6d41\u6c34A"; // A\u5f55\u5165\u94f6\u884c\u6d41\u6c34\u6570\u636e\r\n                    exgr.exchange(A);\r\n                } catch (InterruptedException e) {\r\n                }\r\n            }\r\n        });\r\n        threadPool.execute(new Runnable() {\r\n            @Override\r\n            public void run() {\r\n                try {\r\n                    String B = "\u94f6\u884c\u6d41\u6c34B"; // B\u5f55\u5165\u94f6\u884c\u6d41\u6c34\u6570\u636e\r\n                    String A = exgr.exchange("B");\r\n                    System.out.println("A\u548cB\u6570\u636e\u662f\u5426\u4e00\u81f4\uff1a" + A.equals(B) + "\uff0cA\u5f55\u5165\u7684\u662f\uff1a"\r\n                            + A + "\uff0cB\u5f55\u5165\u662f\uff1a" + B);\r\n                } catch (InterruptedException e) {\r\n                }\r\n            }\r\n        });\r\n        threadPool.shutdown();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u80fd\u8bf4\u4e00\u4e0b-concurrenthashmap-\u7684\u5b9e\u73b0\u5417\u8865\u5145",children:"\ud83c\udf1f\u80fd\u8bf4\u4e00\u4e0b ConcurrentHashMap \u7684\u5b9e\u73b0\u5417\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsxs)(e.p,{children:["\u597d\u7684\u3002ConcurrentHashMap \u662f HashMap \u7684\u7ebf\u7a0b\u5b89\u5168\u7248\u672c\u3002\r\nJDK 7 \u91c7\u7528\u7684\u662f\u5206\u6bb5\u9501\uff0c\u6574\u4e2a Map \u4f1a\u88ab\u5206\u4e3a\u82e5\u5e72\u6bb5\uff0c\u6bcf\u4e2a\u6bb5\u90fd\u53ef\u4ee5\u72ec\u7acb\u52a0\u9501\u3002\u4e0d\u540c\u7684\u7ebf\u7a0b\u53ef\u4ee5\u540c\u65f6\u64cd\u4f5c\u4e0d\u540c\u7684\u6bb5\uff0c\u4ece\u800c\u5b9e\u73b0\u5e76\u53d1\r\n",(0,t.jsx)(e.img,{alt:"JAVA7\u7684ConcurrentHashMap\u5b89\u5168\u5b9e\u73b0",src:r(15787).A+"",width:"1512",height:"1053"}),"\r\nJDK 8 \u4f7f\u7528\u4e86\u4e00\u79cd\u66f4\u52a0\u7ec6\u7c92\u5ea6\u7684\u9501\u2014\u2014\u6876\u9501\uff0c\u518d\u914d\u5408 CAS + synchronized \u4ee3\u7801\u5757\u63a7\u5236\u5e76\u53d1\u5199\u5165\uff0c\u4ee5\u6700\u5927\u7a0b\u5ea6\u51cf\u5c11\u9501\u7684\u7ade\u4e89\u3002\r\n",(0,t.jsx)(e.img,{alt:"JAVA8\u7684ConcurrentHashMap\u5b89\u5168\u5b9e\u73b0",src:r(24980).A+"",width:"1512",height:"1165"}),"\r\n\u5bf9\u4e8e\u8bfb\u64cd\u4f5c\uff0cConcurrentHashMap \u4f7f\u7528\u4e86 volatile \u53d8\u91cf\u6765\u4fdd\u8bc1\u5185\u5b58\u53ef\u89c1\u6027\u3002\r\n\u5bf9\u4e8e\u5199\u64cd\u4f5c\uff0cConcurrentHashMap \u4f18\u5148\u4f7f\u7528 CAS \u5c1d\u8bd5\u63d2\u5165\uff0c\u5982\u679c\u6210\u529f\u5c31\u76f4\u63a5\u8fd4\u56de\uff1b\u5426\u5219\u4f7f\u7528 synchronized \u4ee3\u7801\u5757\u8fdb\u884c\u52a0\u9501\u5904\u7406\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-jdk-7-\u4e2d-concurrenthashmap-\u7684\u5b9e\u73b0\u539f\u7406",children:"\u8bf4\u4e00\u4e0b JDK 7 \u4e2d ConcurrentHashMap \u7684\u5b9e\u73b0\u539f\u7406\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u597d\u7684\u3002\r\nJDK 7 \u7684 ConcurrentHashMap \u91c7\u7528\u7684\u662f\u5206\u6bb5\u9501\uff0c\u6574\u4e2a Map \u4f1a\u88ab\u5206\u4e3a\u82e5\u5e72\u6bb5\uff0c\u6bcf\u4e2a\u6bb5\u90fd\u53ef\u4ee5\u72ec\u7acb\u52a0\u9501\uff0c\u6bcf\u4e2a\u6bb5\u7c7b\u4f3c\u4e00\u4e2a Hashtable\u3002\r\n",(0,t.jsx)(e.img,{alt:"ConcurrentHashMap\u5206\u6bb5\u9501",src:r(47461).A+"",width:"1057",height:"376"}),"\r\n\u6bcf\u4e2a\u6bb5\u7ef4\u62a4\u4e00\u4e2a\u952e\u503c\u5bf9\u6570\u7ec4 ",(0,t.jsx)(e.code,{children:"HashEntry<K, V>[] table\uff0cHashEntry"})," \u662f\u4e00\u4e2a\u5355\u9879\u94fe\u8868\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static final class HashEntry<K, V> {\r\n    final int hash;\r\n    final K key;\r\n    volatile V value;\r\n    final HashEntry<K, V> next;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6bb5\u7ee7\u627f\u4e86 ReentrantLock\uff0c\u6240\u4ee5\u6bcf\u4e2a\u6bb5\u90fd\u662f\u4e00\u4e2a\u53ef\u91cd\u5165\u9501\uff0c\u4e0d\u540c\u7684\u7ebf\u7a0b\u53ef\u4ee5\u540c\u65f6\u64cd\u4f5c\u4e0d\u540c\u7684\u6bb5\uff0c\u4ece\u800c\u5b9e\u73b0\u5e76\u53d1\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static final class Segment<K, V> extends ReentrantLock {\r\n    transient volatile HashEntry<K, V>[] table;\r\n    transient int count;\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-jdk-7-\u4e2d-concurrenthashmap-\u7684-put-\u6d41\u7a0b",children:"\u8bf4\u4e00\u4e0b JDK 7 \u4e2d ConcurrentHashMap \u7684 put \u6d41\u7a0b\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["put \u6d41\u7a0b\u548c HashMap \u975e\u5e38\u7c7b\u4f3c\uff0c\u53ea\u4e0d\u8fc7\u662f\u5148\u5b9a\u4f4d\u5230\u5177\u4f53\u7684\u6bb5\uff0c\u518d\u901a\u8fc7 ReentrantLock \u53bb\u64cd\u4f5c\u800c\u5df2\u3002\u4e00\u5171\u53ef\u4ee5\u5206\u4e3a 4 \u4e2a\u6b65\u9aa4\uff1a\r\n\u7b2c\u4e00\u6b65\uff0c\u8ba1\u7b97 key \u7684 hash\uff0c\u5b9a\u4f4d\u5230\u6bb5\uff0c\u6bb5\u5982\u679c\u662f\u7a7a\u5c31\u5148\u521d\u59cb\u5316\uff1b\r\n\u7b2c\u4e8c\u6b65\uff0c\u4f7f\u7528 ReentrantLock \u8fdb\u884c\u52a0\u9501\uff0c\u5982\u679c\u52a0\u9501\u5931\u8d25\u5c31\u81ea\u65cb\uff0c\u81ea\u65cb\u8d85\u8fc7\u6b21\u6570\u5c31\u963b\u585e\uff0c\u4fdd\u8bc1\u4e00\u5b9a\u80fd\u83b7\u53d6\u5230\u9501\uff1b\r\n\u7b2c\u4e09\u6b65\uff0c\u904d\u5386\u6bb5\u4e2d\u7684\u952e\u503c\u5bf9 HashEntry\uff0ckey \u76f8\u540c\u76f4\u63a5\u66ff\u6362\uff0ckey \u4e0d\u5b58\u5728\u5c31\u63d2\u5165\u3002\r\n\u7b2c\u56db\u6b65\uff0c\u91ca\u653e\u9501\u3002\r\n",(0,t.jsx)(e.img,{alt:"JAVA7-ConcurrentHashMap\u7684put\u6d41\u7a0b",src:r(69826).A+"",width:"1045",height:"1667"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-jdk-7-\u4e2d-concurrenthashmap-\u7684-get-\u6d41\u7a0b",children:"\u8bf4\u4e00\u4e0b JDK 7 \u4e2d ConcurrentHashMap \u7684 get \u6d41\u7a0b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"get \u5c31\u66f4\u7b80\u5355\u4e86\uff0c\u5148\u8ba1\u7b97 key \u7684 hash \u627e\u5230\u6bb5\uff0c\u518d\u904d\u5386\u6bb5\u4e2d\u7684\u952e\u503c\u5bf9\uff0c\u627e\u5230\u5c31\u76f4\u63a5\u8fd4\u56de value\u3002\r\nget \u4e0d\u7528\u52a0\u9501\uff0c\u56e0\u4e3a\u662f value \u662f volatile \u7684\uff0c\u6240\u4ee5\u7ebf\u7a0b\u8bfb\u53d6 value \u65f6\u4e0d\u4f1a\u51fa\u73b0\u53ef\u89c1\u6027\u95ee\u9898\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-jdk-8-\u4e2d-concurrenthashmap-\u7684\u5b9e\u73b0\u539f\u7406",children:"\u8bf4\u4e00\u4e0b JDK 8 \u4e2d ConcurrentHashMap \u7684\u5b9e\u73b0\u539f\u7406\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"JDK 8 \u4e2d\u7684 ConcurrentHashMap \u53d6\u6d88\u4e86\u5206\u6bb5\u9501\uff0c\u91c7\u7528 CAS + synchronized \u6765\u5b9e\u73b0\u66f4\u7ec6\u7c92\u5ea6\u7684\u6876\u9501\uff0c\u5e76\u4e14\u4f7f\u7528\u7ea2\u9ed1\u6811\u6765\u4f18\u5316\u94fe\u8868\u4ee5\u63d0\u9ad8\u54c8\u5e0c\u51b2\u7a81\u65f6\u7684\u67e5\u8be2\u6548\u7387\uff0c\u6027\u80fd\u6bd4\r\nJDK 7 \u6709\u4e86\u5f88\u5927\u7684\u63d0\u5347\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-jdk-8-\u4e2d-concurrenthashmap-\u7684-put-\u6d41\u7a0b",children:"\u8bf4\u4e00\u4e0b JDK 8 \u4e2d ConcurrentHashMap \u7684 put \u6d41\u7a0b\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"JAVA8-ConcurrentHashMap\u7684put\u6d41\u7a0b",src:r(94721).A+"",width:"784",height:"734"}),"\r\n\u7b2c\u4e00\u6b65\uff0c\u8ba1\u7b97 key \u7684 hash\uff0c\u4ee5\u786e\u5b9a\u6876\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u6570\u7ec4\u4e3a\u7a7a\uff0c\u91c7\u7528 CAS \u7684\u65b9\u5f0f\u521d\u59cb\u5316\uff0c\u4ee5\u786e\u4fdd\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u5728\u521d\u59cb\u5316\u6570\u7ec4\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void put(value) {\r\n   // \u8ba1\u7b97 hash\r\n   int hash = spread(key.hashCode());\r\n   // \u521d\u59cb\u5316\u6570\u7ec4\r\n   if (tab == null || (n = tab.length) == 0)\r\n      tab = initTable();\r\n   // \u8ba1\u7b97\u6876\u7684\u4f4d\u7f6e\r\n   int i = (n - 1) & hash;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e8c\u6b65\uff0c\u5982\u679c\u6876\u4e3a\u7a7a\uff0c\u76f4\u63a5 CAS \u63d2\u5165\u8282\u70b9\u3002\u5982\u679c CAS \u64cd\u4f5c\u5931\u8d25\uff0c\u4f1a\u9000\u5316\u4e3a synchronized \u4ee3\u7801\u5757\u6765\u63d2\u5165\u8282\u70b9\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private void put(value) {\r\n   // CAS \u63d2\u5165\u8282\u70b9\r\n   if (tabAt(tab, i) == null) {\r\n      if (casTabAt(tab, i, null, new Node<K, V>(hash, key, value, null)))\r\n         break;\r\n   }\r\n\r\n   // \u5426\u5219\uff0c\u4f7f\u7528 synchronized \u4ee3\u7801\u5757\u63d2\u5165\u8282\u70b9\r\n   else {\r\n      synchronized (f) {  // **\u53ea\u9501\u5f53\u524d\u6876**\r\n         if (\r\n                 tabAt(tab, i) == f) { // \u786e\u4fdd\u672a\u88ab\u5176\u4ed6\u7ebf\u7a0b\u4fee\u6539\r\n            if (f.hash >= 0) { // \u94fe\u8868\u5904\u7406\r\n               for (Node<K, V> e = f;; ) {\r\n                  K ek;\r\n                  if (e.hash == hash && ((ek = e.key) == key || (key != null && key.equals(ek)))) {\r\n                     e.val = value;\r\n                     break;\r\n                  }\r\n                  e = e.next;\r\n               }\r\n            } else if (f instanceof TreeBin) { // **\u7ea2\u9ed1\u6811\u5904\u7406**\r\n               ((TreeBin<K, V>) f).\r\n                       putTreeVal(hash, key, value);\r\n            }\r\n         }\r\n      }\r\n   }\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u63d2\u5165\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u5224\u65ad\u6876\u7684\u54c8\u5e0c\u662f\u5426\u5c0f\u4e8e 0\uff08f.hash >= 0\uff09\uff0c\u5c0f\u4e8e 0 \u8bf4\u660e\u662f\u7ea2\u9ed1\u6811\uff0c\u5927\u4e8e\u7b49\u4e8e 0 \u8bf4\u660e\u662f\u94fe\u8868\u3002\r\n\u8fd9\u91cc\u8865\u5145\u4e00\u70b9\uff1a\u5728 ConcurrentHashMap \u7684\u5b9e\u73b0\u4e2d\uff0c\u7ea2\u9ed1\u6811\u8282\u70b9 TreeBin \u7684 hash \u503c\u56fa\u5b9a\u4e3a -2\u3002\r\n",(0,t.jsx)(e.img,{alt:"ConcurrentHashMap\u8282\u70b9\u8f6c\u7ea2\u9ed1\u6811",src:r(96586).A+"",width:"1102",height:"320"}),"\r\n\u7b2c\u4e09\u6b65\uff0c\u5982\u679c\u94fe\u8868\u957f\u5ea6\u8d85\u8fc7 8\uff0c\u8f6c\u6362\u4e3a\u7ea2\u9ed1\u6811\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"if(binCount >=TREEIFY_THRESHOLD)\r\n    treeifyBin(tab, i);\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u56db\u6b65\uff0c\u5728\u63d2\u5165\u65b0\u8282\u70b9\u540e\uff0c\u4f1a\u8c03\u7528 addCount() \u65b9\u6cd5\u68c0\u67e5\u662f\u5426\u9700\u8981\u6269\u5bb9\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"addCount(1L,binCount);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-jdk-8-\u4e2d-concurrenthashmap-\u7684-get-\u6d41\u7a0b",children:"\u8bf4\u4e00\u4e0b JDK 8 \u4e2d ConcurrentHashMap \u7684 get \u6d41\u7a0b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"get \u4e5f\u662f\u901a\u8fc7 key \u7684 hash \u8fdb\u884c\u5b9a\u4f4d\uff0c\u5982\u679c\u8be5\u4f4d\u7f6e\u8282\u70b9\u7684\u54c8\u5e0c\u5339\u914d\u4e14\u952e\u76f8\u7b49\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\u503c\u3002"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"ConcurrentHashMap\u7684get\u6d41\u7a0b",src:r(73097).A+"",width:"1274",height:"854"}),"\r\n\u5982\u679c\u8282\u70b9\u7684\u54c8\u5e0c\u4e3a\u8d1f\u6570\uff0c\u8bf4\u660e\u662f\u4e2a\u7279\u6b8a\u8282\u70b9\uff0c\u6bd4\u5982\u8bf4\u5982\u6811\u8282\u70b9\u6216\u8005\u6b63\u5728\u8fc1\u79fb\u7684\u8282\u70b9\uff0c\u5c31\u8c03\u7528find\u65b9\u6cd5\u67e5\u627e\u3002\r\n\u5426\u5219\u904d\u5386\u94fe\u8868\u67e5\u627e\u5339\u914d\u7684\u952e\u3002\u5982\u679c\u90fd\u6ca1\u627e\u5230\uff0c\u8fd4\u56de null\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-hashmap-\u548c-concurrenthashmap-\u7684\u533a\u522b",children:"\u8bf4\u4e00\u4e0b HashMap \u548c ConcurrentHashMap \u7684\u533a\u522b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"HashMap \u662f\u975e\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u591a\u7ebf\u7a0b\u73af\u5883\u4e0b\u5e94\u8be5\u4f7f\u7528 ConcurrentHashMap\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u4f60\u9879\u76ee\u4e2d\u600e\u4e48\u4f7f\u7528-concurrenthashmap-\u7684",children:"\u4f60\u9879\u76ee\u4e2d\u600e\u4e48\u4f7f\u7528 ConcurrentHashMap \u7684\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5728\u6280\u672f\u6d3e\u5b9e\u6218\u9879\u76ee\u4e2d\uff0c\u5f88\u591a\u5730\u65b9\u90fd\u7528\u5230\u4e86 ConcurrentHashMap\uff0c\u6bd4\u5982\u8bf4\u5728\u5f02\u6b65\u5de5\u5177\u7c7b AsyncUtil \u4e2d\uff0c\u5c31\u4f7f\u7528\u4e86 ConcurrentHashMap\r\n\u6765\u5b58\u50a8\u4efb\u52a1\u7684\u540d\u79f0\u548c\u5b83\u4eec\u7684\u8fd0\u884c\u65f6\u95f4\uff0c\u4ee5\u4fbf\u89c2\u5bdf\u548c\u5206\u6790\u4efb\u52a1\u7684\u6267\u884c\u60c5\u51b5\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b-concurrenthashmap-\u5bf9-hashmap-\u7684\u6539\u8fdb",children:"\u8bf4\u4e00\u4e0b ConcurrentHashMap \u5bf9 HashMap \u7684\u6539\u8fdb\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u9996\u5148\u662f hash \u7684\u8ba1\u7b97\u65b9\u6cd5\u4e0a\uff0cConcurrentHashMap \u7684 spread \u65b9\u6cd5\u63a5\u6536\u4e00\u4e2a\u5df2\u7ecf\u8ba1\u7b97\u597d\u7684 hashCode\uff0c\u7136\u540e\u5c06\u8fd9\u4e2a\u54c8\u5e0c\u7801\u7684\u9ad8 16\r\n\u4f4d\u4e0e\u81ea\u8eab\u8fdb\u884c\u5f02\u6216\u8fd0\u7b97\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static final int spread(int h) {\r\n    return (h ^ (h >>> 16)) & HASH_BITS;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u6bd4 HashMap \u7684 hash \u8ba1\u7b97\u591a\u4e86\u4e00\u4e2a & HASH_BITS \u7684\u64cd\u4f5c\u3002\u8fd9\u91cc\u7684 HASH_BITS \u662f\u4e00\u4e2a\u5e38\u6570\uff0c\u503c\u4e3a 0x7fffffff\uff0c\u5b83\u786e\u4fdd\u7ed3\u679c\u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static final int hash(Object key) {\r\n    int h;\r\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u53e6\u5916\uff0cConcurrentHashMap \u5bf9\u8282\u70b9 Node \u505a\u4e86\u8fdb\u4e00\u6b65\u7684\u5c01\u88c5\uff0c\u6bd4\u5982\u8bf4\u7528 Forwarding Node \u6765\u8868\u793a\u6b63\u5728\u8fdb\u884c\u6269\u5bb9\u7684\u8282\u70b9\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static final class ForwardingNode<K, V> extends Node<K, V> {\r\n    final Node<K, V>[] nextTable;\r\n\r\n    ForwardingNode(Node<K, V>[] tab) {\r\n        super(MOVED, null, null, null);\r\n        this.nextTable = tab;\r\n    }\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u6700\u540e\u5c31\u662f put \u65b9\u6cd5\uff0c\u901a\u8fc7 CAS + synchronized \u4ee3\u7801\u5757\u6765\u8fdb\u884c\u5e76\u53d1\u5199\u5165\u3002\r\n",(0,t.jsx)(e.img,{alt:"ConcurrentHashMap\u7684put\u6e90\u7801",src:r(55659).A+"",width:"1372",height:"1328"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u4e3a\u4ec0\u4e48-concurrenthashmap-\u5728-jdk-17-\u4e2d\u8981\u7528-reentrantlock\u800c\u5728-jdk-18-\u8981\u7528-synchronized",children:"\u4e3a\u4ec0\u4e48 ConcurrentHashMap \u5728 JDK 1.7 \u4e2d\u8981\u7528 ReentrantLock\uff0c\u800c\u5728 JDK 1.8 \u8981\u7528 synchronized"}),"\n",(0,t.jsx)(e.p,{children:"JDK 1.7 \u4e2d\u7684 ConcurrentHashMap \u4f7f\u7528\u4e86\u5206\u6bb5\u9501\u673a\u5236\uff0c\u6bcf\u4e2a Segment \u90fd\u7ee7\u627f\u4e86 ReentrantLock\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u6bcf\u4e2a Segment \u90fd\u53ef\u4ee5\u72ec\u7acb\u5730\u52a0\u9501\u3002\r\n\u800c\u5728 JDK 1.8 \u4e2d\uff0cConcurrentHashMap \u53d6\u6d88\u4e86 Segment \u5206\u6bb5\u9501\uff0c\u91c7\u7528\u4e86\u66f4\u52a0\u7cbe\u7ec6\u5316\u7684\u9501\u2014\u2014\u6876\u9501\uff0c\u4ee5\u53ca CAS \u65e0\u9501\u7b97\u6cd5\uff0c\u6bcf\u4e2a\u6876\u90fd\u53ef\u4ee5\u72ec\u7acb\u5730\u52a0\u9501\uff0c\u53ea\u6709"}),"\n",(0,t.jsx)(e.h3,{id:"concurrenthashmap-\u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\u8865\u5145",children:"ConcurrentHashMap \u600e\u4e48\u4fdd\u8bc1\u53ef\u89c1\u6027\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"ConcurrentHashMap \u4e2d\u7684 Node \u8282\u70b9\u4e2d\uff0cvalue \u548c next \u90fd\u662f volatile \u7684\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u5bf9 value \u6216 next \u7684\u66f4\u65b0\u4f1a\u88ab\u5176\u4ed6\u7ebf\u7a0b\u7acb\u5373\u770b\u5230\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"static class Node<K, V> implements Map.Entry<K, V> {\r\n    final int hash;\r\n    final K key;\r\n    volatile V value;\r\n    volatile Node<K, V> next;\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u4e3a\u4ec0\u4e48-concurrenthashmap-\u6bd4-hashtable-\u6548\u7387\u9ad8\u8865\u5145",children:"\u4e3a\u4ec0\u4e48 ConcurrentHashMap \u6bd4 Hashtable \u6548\u7387\u9ad8\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"Hashtable \u5728\u4efb\u4f55\u65f6\u523b\u53ea\u5141\u8bb8\u4e00\u4e2a\u7ebf\u7a0b\u8bbf\u95ee\u6574\u4e2a Map\uff0c\u662f\u901a\u8fc7\u5bf9\u6574\u4e2a Map \u52a0\u9501\u6765\u5b9e\u73b0\u7ebf\u7a0b\u5b89\u5168\u7684\u3002\u6bd4\u5982 get \u548c put \u65b9\u6cd5\uff0c\u662f\u76f4\u63a5\u5728\u65b9\u6cd5\u4e0a\u52a0\u7684\r\nsynchronized \u5173\u952e\u5b57\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public synchronized V put(K key, V value) {\r\n    if (value == null) throw new NullPointerException();\r\n    int hash = key.hashCode();\r\n    int index = (hash & 0x7FFFFFFF) % table.length;\r\n    ...\r\n    return oldValue;\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u800c ConcurrentHashMap \u5728 JDK 8 \u4e2d\u662f\u91c7\u7528 CAS + synchronized \u5b9e\u73b0\u7684\uff0c\u4ec5\u5728\u5fc5\u8981\u65f6\u52a0\u9501\u3002\r\n\u6bd4\u5982\u8bf4 put \u7684\u65f6\u5019\u4f18\u5148\u4f7f\u7528 CAS \u5c1d\u8bd5\u63d2\u5165\uff0c\u5982\u679c\u5931\u8d25\u518d\u4f7f\u7528 synchronized \u4ee3\u7801\u5757\u52a0\u9501\u3002\r\nget \u7684\u65f6\u5019\u662f\u5b8c\u5168\u65e0\u9501\u7684\uff0c\u56e0\u4e3a value \u662f volatile \u53d8\u91cf \u4fee\u9970\u7684\uff0c\u4fdd\u8bc1\u4e86\u5185\u5b58\u53ef\u89c1\u6027\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public V get(Object key) {\r\n    int hash = spread(key.hashCode());\r\n    Node<K, V>[] tab = table;\r\n    int index = (tab.length - 1) & hash;\r\n    Node<K, V> e = tabAt(tab, index);\r\n\r\n    if (e != null) {\r\n        do {\r\n            if (e.hash == hash && (e.key == key || (key != null && key.equals(e.key)))) {\r\n                return e.value;  // \u8bfb\u53d6 volatile \u53d8\u91cf\uff0c\u4fdd\u8bc1\u53ef\u89c1\u6027\r\n            }\r\n        } while ((e = e.next) != null);\r\n    }\r\n    return null;\r\n}\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u80fd\u8bf4\u4e00\u4e0b-copyonwritearraylist-\u7684\u5b9e\u73b0\u539f\u7406\u5417\u8865\u5145",children:"\u80fd\u8bf4\u4e00\u4e0b CopyOnWriteArrayList \u7684\u5b9e\u73b0\u539f\u7406\u5417\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsxs)(e.p,{children:["CopyOnWriteArrayList \u662f ArrayList \u7684\u7ebf\u7a0b\u5b89\u5168\u7248\u672c\uff0c\u9002\u7528\u4e8e\u8bfb\u591a\u5199\u5c11\u7684\u573a\u666f\u3002\u5b83\u7684\u6838\u5fc3\u601d\u60f3\u662f\u5199\u64cd\u4f5c\u65f6\u521b\u5efa\u4e00\u4e2a\u65b0\u6570\u7ec4\uff0c\u4fee\u6539\u540e\u518d\u66ff\u6362\u539f\u6570\u7ec4\uff0c\u8fd9\u6837\u5c31\u80fd\u591f\u786e\u4fdd\u8bfb\u64cd\u4f5c\u65e0\u9501\uff0c\u4ece\u800c\u63d0\u9ad8\u5e76\u53d1\u6027\u80fd\u3002\r\n",(0,t.jsx)(e.img,{alt:"CopyOnWriteArrayList\u539f\u7406",src:r(88255).A+"",width:"377",height:"445"}),"\r\n\u5185\u90e8\u4f7f\u7528 volatile \u53d8\u91cf\u6765\u4fee\u9970\u6570\u7ec4 array\uff0c\u4ee5\u8bfb\u64cd\u4f5c\u7684\u5185\u5b58\u53ef\u89c1\u6027\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"private transient volatile Object[] array;\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u5199\u64cd\u4f5c\u7684\u65f6\u5019\u4f7f\u7528 ReentrantLock \u6765\u4fdd\u8bc1\u7ebf\u7a0b\u5b89\u5168\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public boolean add(E e) {\r\n    final ReentrantLock lock = this.lock;\r\n    // \u52a0\u9501\r\n    lock.lock();\r\n    try {\r\n        Object[] elements = getArray();\r\n        int len = elements.length;\r\n        // \u521b\u5efa\u4e00\u4e2a\u65b0\u6570\u7ec4\r\n        Object[] newElements = Arrays.copyOf(elements, len + 1);\r\n        newElements[len] = e;\r\n        // \u66ff\u6362\u539f\u6570\u7ec4\r\n        setArray(newElements);\r\n        return true;\r\n    } finally {\r\n        // \u91ca\u653e\u9501\r\n        lock.unlock();\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7f3a\u70b9\u5c31\u662f\u5199\u64cd\u4f5c\u7684\u65f6\u5019\u4f1a\u590d\u5236\u4e00\u4e2a\u65b0\u6570\u7ec4\uff0c\u5982\u679c\u6570\u7ec4\u5f88\u5927\uff0c\u5199\u64cd\u4f5c\u7684\u6027\u80fd\u4f1a\u53d7\u5230\u5f71\u54cd\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u80fd\u8bf4\u4e00\u4e0b-blockingqueue-\u5417\u8865\u5145",children:"\u80fd\u8bf4\u4e00\u4e0b BlockingQueue \u5417\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"BlockingQueue \u662f JUC \u5305\u4e0b\u7684\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u961f\u5217\uff0c\u652f\u6301\u963b\u585e\u5f0f\u7684\u201c\u751f\u4ea7\u8005-\u6d88\u8d39\u8005\u201d\u6a21\u578b\u3002\r\n\u5f53\u961f\u5217\u5bb9\u5668\u5df2\u6ee1\uff0c\u751f\u4ea7\u8005\u7ebf\u7a0b\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u6d88\u8d39\u8005\u7ebf\u7a0b\u53d6\u8d70\u5143\u7d20\u540e\u4e3a\u6b62\uff1b\u5f53\u961f\u5217\u5bb9\u5668\u4e3a\u7a7a\u65f6\uff0c\u6d88\u8d39\u8005\u7ebf\u7a0b\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u81f3\u961f\u5217\u975e\u7a7a\u65f6\u4e3a\u6b62\u3002\r\nBlockingQueue \u7684\u5b9e\u73b0\u7c7b\u6709\u5f88\u591a\uff0c\u6bd4\u5982\u8bf4 ArrayBlockingQueue\u3001PriorityBlockingQueue \u7b49\u3002\r\n\u5b9e\u73b0\u7c7b \u6570\u636e\u7ed3\u6784 \u662f\u5426\u6709\u754c \u7279\u70b9"}),"\n",(0,t.jsxs)(e.table,{children:[(0,t.jsx)(e.thead,{children:(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.th,{style:{textAlign:"left"},children:"\u5b9e\u73b0\u7c7b"}),(0,t.jsx)(e.th,{style:{textAlign:"left"},children:"\u6570\u636e\u7ed3\u6784"}),(0,t.jsx)(e.th,{style:{textAlign:"left"},children:"\u662f\u5426\u6709\u754c"}),(0,t.jsx)(e.th,{style:{textAlign:"left"},children:"\u7279\u70b9"})]})}),(0,t.jsxs)(e.tbody,{children:[(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:(0,t.jsx)(e.strong,{children:"ArrayBlockingQueue"})}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u6570\u7ec4"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u2705 \u6709\u754c"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u57fa\u4e8e\u6570\u7ec4\uff0c\u56fa\u5b9a\u5bb9\u91cf\uff0cFIFO\uff08\u5148\u8fdb\u5148\u51fa\uff09"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:(0,t.jsx)(e.strong,{children:"LinkedBlockingQueue"})}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u94fe\u8868"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u2705 \u53ef\u6709\u754c"}),(0,t.jsxs)(e.td,{style:{textAlign:"left"},children:["\u57fa\u4e8e\u94fe\u8868\uff0c\u9ed8\u8ba4\u5bb9\u91cf\u4e3a ",(0,t.jsx)(e.code,{children:"Integer.MAX_VALUE"}),"\uff0c\u541e\u5410\u91cf\u901a\u5e38\u66f4\u9ad8"]})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:(0,t.jsx)(e.strong,{children:"PriorityBlockingQueue"})}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u5806\uff08\u4f18\u5148\u961f\u5217\uff09"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u274c \u65e0\u754c"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u5143\u7d20\u6309\u4f18\u5148\u7ea7\u6392\u5e8f\uff0c\u975e FIFO"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:(0,t.jsx)(e.strong,{children:"DelayQueue"})}),(0,t.jsxs)(e.td,{style:{textAlign:"left"},children:["\u4f18\u5148\u961f\u5217\uff08\u57fa\u4e8e ",(0,t.jsx)(e.code,{children:"Delayed"})," \u63a5\u53e3\uff09"]}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u274c \u65e0\u754c"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u5143\u7d20\u53ea\u6709\u5728\u5230\u671f\u540e\u624d\u80fd\u88ab\u53d6\u51fa"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:(0,t.jsx)(e.strong,{children:"SynchronousQueue"})}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u65e0\u7f13\u51b2"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u2705 \u5bb9\u91cf\u4e3a 0"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u5fc5\u987b\u4e00\u5bf9\u4e00\u4ea4\u6362\u6570\u636e\uff0c\u9002\u7528\u4e8e\u9ad8\u541e\u5410\u7684\u4efb\u52a1\u63d0\u4ea4\u573a\u666f"})]}),(0,t.jsxs)(e.tr,{children:[(0,t.jsx)(e.td,{style:{textAlign:"left"},children:(0,t.jsx)(e.strong,{children:"LinkedTransferQueue"})}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u94fe\u8868"}),(0,t.jsx)(e.td,{style:{textAlign:"left"},children:"\u274c \u65e0\u754c"}),(0,t.jsxs)(e.td,{style:{textAlign:"left"},children:["\u652f\u6301 ",(0,t.jsx)(e.code,{children:"tryTransfer()"})," \u7b49\u65b9\u6cd5\uff0c\u53ef\u5c1d\u8bd5\u5c06\u6570\u636e\u7acb\u5373\u4ea4\u7ed9\u6d88\u8d39\u8005"]})]})]})]}),"\n",(0,t.jsx)(e.h3,{id:"\u963b\u585e\u961f\u5217\u662f\u5982\u4f55\u5b9e\u73b0\u7684",children:"\u963b\u585e\u961f\u5217\u662f\u5982\u4f55\u5b9e\u73b0\u7684\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u963b\u585e\u961f\u5217\u4f7f\u7528 ReentrantLock + Condition \u6765\u786e\u4fdd\u5e76\u53d1\u5b89\u5168\u3002\r\n\u4ee5 ArrayBlockingQueue \u4e3a\u4f8b\uff0c\u5b83\u5185\u90e8\u7ef4\u62a4\u4e86\u4e00\u4e2a\u6570\u7ec4\uff0c\u4f7f\u7528\u4e24\u4e2a\u6307\u9488\u5206\u522b\u6307\u5411\u961f\u5934\u548c\u961f\u5c3e\u3002\r\nput \u7684\u65f6\u5019\u5148\u7528 ReentrantLock \u52a0\u9501\uff0c\u7136\u540e\u5224\u65ad\u961f\u5217\u662f\u5426\u5df2\u6ee1\uff0c\u5982\u679c\u5df2\u6ee1\u5c31\u963b\u585e\u7b49\u5f85\uff0c\u5426\u5219\u63d2\u5165\u5143\u7d20\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"final ReentrantLock lock;\r\nprivate final Condition notEmpty;\r\nprivate final Condition notFull;\r\n\r\npublic void put(E e) throws InterruptedException {\r\n    final ReentrantLock lock = this.lock;\r\n    lock.lockInterruptibly(); // \ud83d\udd39 \u52a0\u9501\uff0c\u786e\u4fdd\u7ebf\u7a0b\u5b89\u5168\r\n    try {\r\n        while (count == items.length) { // \ud83d\udd39 \u961f\u5217\u6ee1\uff0c\u963b\u585e\r\n            notFull.await();\r\n        }\r\n        enqueue(e); // \ud83d\udd39 \u63d2\u5165\u5143\u7d20\r\n    } finally {\r\n        lock.unlock(); // \ud83d\udd39 \u91ca\u653e\u9501\r\n    }\r\n}\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u7ebf\u7a0b\u6c60",children:"\u7ebf\u7a0b\u6c60"}),"\n",(0,t.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u7ebf\u7a0b\u6c60",children:"\ud83c\udf1f\u4ec0\u4e48\u662f\u7ebf\u7a0b\u6c60\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u6c60\u662f\u7528\u6765\u7ba1\u7406\u548c\u590d\u7528\u7ebf\u7a0b\u7684\u5de5\u5177\uff0c\u5b83\u53ef\u4ee5\u51cf\u5c11\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u9500\u6bc1\u5f00\u9500\u3002\r\n\u5728 Java \u4e2d\uff0cThreadPoolExecutor \u662f\u7ebf\u7a0b\u6c60\u7684\u6838\u5fc3\u5b9e\u73b0\uff0c\u5b83\u901a\u8fc7\u6838\u5fc3\u7ebf\u7a0b\u6570\u3001\u6700\u5927\u7ebf\u7a0b\u6570\u3001\u4efb\u52a1\u961f\u5217\u548c\u62d2\u7edd\u7b56\u7565\u6765\u63a7\u5236\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u6267\u884c\u3002\r\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u5c31\u50cf\u4f60\u5f00\u4e86\u4e00\u5bb6\u9910\u5385\uff0c\u7ebf\u7a0b\u6c60\u5c31\u76f8\u5f53\u4e8e\u56fa\u5b9a\u6570\u91cf\u7684\u670d\u52a1\u5458\uff0c\u987e\u5ba2\uff08\u4efb\u52a1\uff09\u6765\u4e86\u5c31\u5b89\u6392\u7a7a\u95f2\u7684\u670d\u52a1\u5458\uff08\u7ebf\u7a0b\uff09\u5904\u7406\uff0c\u907f\u514d\u4e86\u9891\u7e41\u62db\u4eba\u548c\u89e3\u96c7\u7684\u6210\u672c\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u4f60\u5728\u9879\u76ee\u4e2d\u6709\u7528\u5230\u7ebf\u7a0b\u6c60\u5417",children:"\u4f60\u5728\u9879\u76ee\u4e2d\u6709\u7528\u5230\u7ebf\u7a0b\u6c60\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u63a8\u8350\u9605\u8bfb\uff1a\u7ebf\u7a0b\u6c60\u5728\u7f8e\u56e2\u4e1a\u52a1\u4e2d\u7684\u5e94\u7528\r\n\u6709\uff0c\u7528\u5230\u8fc7\u5f88\u591a\u6b21\u3002\r\n\u6bd4\u5982\u8bf4\u5728\u6280\u672f\u6d3e\u5b9e\u6218\u9879\u76ee\u5f53\u4e2d\uff0c \u6211\u4eec\u5c31\u5c01\u88c5\u4e86\u4e00\u4e2a\u5f02\u6b65\u5de5\u5177\u7c7b AsyncUtil\uff0c\u5185\u7f6e\u4e86\u53ef\u914d\u7f6e\u7684\u7ebf\u7a0b\u6c60\uff0c\u57fa\u4e8e ThreadPoolExecutor\uff0c\u9002\u7528\u4e8e IO\r\n\u5bc6\u96c6\u578b\u4efb\u52a1\u3002\r\n\u5176\u4e2d corePoolSize \u4e3a CPU \u6838\u5fc3\u6570\u7684\u4e24\u500d\uff0c\u56e0\u4e3a\u6280\u672f\u6d3e\u4e2d\u7684\u5927\u591a\u6570\u4efb\u52a1\u90fd\u662f IO \u5bc6\u96c6\u578b\u7684\uff0cmaxPoolSize \u8bbe\u7f6e\u4e3a\r\n50\uff0c\u662f\u4e00\u4e2a\u6bd4\u8f83\u7406\u60f3\u7684\u503c\uff0c\u5c24\u5176\u662f\u5728\u672c\u5730\u73af\u5883\u4e2d\uff1b\u963b\u585e\u961f\u5217\u4e3a SynchronousQueue\uff0c\u610f\u5473\u7740\u4efb\u52a1\u88ab\u521b\u5efa\u540e\u53ef\u4ee5\u76f4\u63a5\u63d0\u4ea4\u7ed9\u7b49\u5f85\u7684\u7ebf\u7a0b\u5904\u7406\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u7684\u5de5\u4f5c\u6d41\u7a0b",children:"\ud83c\udf1f\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u7684\u5de5\u4f5c\u6d41\u7a0b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u7b80\u5355\u603b\u7ed3\u4e3a\uff1a\r\n\u4efb\u52a1\u63d0\u4ea4 \u2192 \u6838\u5fc3\u7ebf\u7a0b\u6267\u884c \u2192 \u4efb\u52a1\u961f\u5217\u7f13\u5b58 \u2192 \u975e\u6838\u5fc3\u7ebf\u7a0b\u6267\u884c \u2192 \u62d2\u7edd\u7b56\u7565\u5904\u7406\u3002\r\n\u7b2c\u4e00\u6b65\uff0c\u7ebf\u7a0b\u6c60\u901a\u8fc7 submit() \u63d0\u4ea4\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'private void test() {\r\n   ExecutorService threadPool = Executors.newFixedThreadPool(5);\r\n   threadPool.submit(() -> {\r\n      System.out.println(Thread.currentThread().getName() + "\\t" + "\u529e\u7406\u4e1a\u52a1");\r\n   });\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e8c\u6b65\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u5148\u521b\u5efa\u6838\u5fc3\u7ebf\u7a0b\u6765\u6267\u884c\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"    if(workerCountOf(c) <corePoolSize){\r\n        if(addWorker(command, true)){\r\n        return;\r\n        }\r\n    }\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e09\u6b65\uff0c\u5982\u679c\u6838\u5fc3\u7ebf\u7a0b\u90fd\u5728\u5fd9\uff0c\u4efb\u52a1\u4f1a\u88ab\u653e\u5165\u4efb\u52a1\u961f\u5217\u4e2d\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"if(!addWorker(command, false))\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u56db\u6b65\uff0c\u5982\u679c\u4efb\u52a1\u961f\u5217\u5df2\u6ee1\uff0c\u4e14\u5f53\u524d\u7ebf\u7a0b\u6570\u91cf\u5c0f\u4e8e\u6700\u5927\u7ebf\u7a0b\u6570\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u521b\u5efa\u65b0\u7684\u7ebf\u7a0b\u6765\u5904\u7406\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"if(!addWorker(command, false))\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e94\u6b65\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u4e2d\u7684\u7ebf\u7a0b\u6570\u91cf\u5df2\u7ecf\u8fbe\u5230\u6700\u5927\u7ebf\u7a0b\u6570\uff0c\u4e14\u4efb\u52a1\u961f\u5217\u5df2\u6ee1\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u6267\u884c\u62d2\u7edd\u7b56\u7565\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"handler.rejectedExecution(command, this);\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u53e6\u5916\u4e00\u7248\u56de\u7b54\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u7b2c\u4e00\u6b65\uff0c\u521b\u5efa\u7ebf\u7a0b\u6c60\u3002\r\n\u7b2c\u4e8c\u6b65\uff0c\u8c03\u7528\u7ebf\u7a0b\u6c60\u7684 execute()\u65b9\u6cd5\uff0c\u51c6\u5907\u6267\u884c\u4efb\u52a1\u3002\r\n\u5982\u679c\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u5c0f\u4e8e corePoolSize\uff0c\u90a3\u4e48\u7ebf\u7a0b\u6c60\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7ebf\u7a0b\u6765\u6267\u884c\u8fd9\u4e2a\u4efb\u52a1\uff1b\r\n\u5982\u679c\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u5927\u4e8e\u6216\u7b49\u4e8e corePoolSize\uff0c\u90a3\u4e48\u7ebf\u7a0b\u6c60\u4f1a\u5c06\u8fd9\u4e2a\u4efb\u52a1\u653e\u5165\u7b49\u5f85\u961f\u5217\uff1b\r\n\u5982\u679c\u7b49\u5f85\u961f\u5217\u6ee1\u4e86\uff0c\u800c\u4e14\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u5c0f\u4e8e maximumPoolSize\uff0c\u90a3\u4e48\u7ebf\u7a0b\u6c60\u4f1a\u521b\u5efa\u65b0\u7684\u7ebf\u7a0b\u6765\u6267\u884c\u8fd9\u4e2a\u4efb\u52a1\uff1b\r\n\u5982\u679c\u7b49\u5f85\u961f\u5217\u6ee1\u4e86\uff0c\u800c\u4e14\u6b63\u5728\u8fd0\u884c\u7684\u7ebf\u7a0b\u6570\u91cf\u5927\u4e8e\u6216\u7b49\u4e8e maximumPoolSize\uff0c\u90a3\u4e48\u7ebf\u7a0b\u6c60\u4f1a\u6267\u884c\u62d2\u7edd\u7b56\u7565\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u6c60\u6267\u884c\u6d41\u7a0b",src:r(51833).A+"",width:"715",height:"466"}),"\r\n\u7b2c\u4e09\u6b65\uff0c\u7ebf\u7a0b\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u7ebf\u7a0b\u5e76\u4e0d\u4f1a\u7acb\u5373\u9500\u6bc1\uff0c\u800c\u662f\u7ee7\u7eed\u4fdd\u6301\u5728\u6c60\u4e2d\u7b49\u5f85\u4e0b\u4e00\u4e2a\u4efb\u52a1\u3002\r\n\u7b2c\u56db\u6b65\uff0c\u5f53\u7ebf\u7a0b\u7a7a\u95f2\u65f6\u95f4\u8d85\u51fa\u6307\u5b9a\u65f6\u95f4\uff0c\u4e14\u5f53\u524d\u7ebf\u7a0b\u6570\u91cf\u5927\u4e8e\u6838\u5fc3\u7ebf\u7a0b\u6570\u65f6\uff0c\u7ebf\u7a0b\u4f1a\u88ab\u56de\u6536\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"56\u7ebf\u7a0b\u6c60\u7684\u4e3b\u8981\u53c2\u6570\u6709\u54ea\u4e9b",children:"\ud83c\udf1f56.\u7ebf\u7a0b\u6c60\u7684\u4e3b\u8981\u53c2\u6570\u6709\u54ea\u4e9b\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u7ebf\u7a0b\u6c60\u6709 7 \u4e2a\u53c2\u6570\uff0c\u9700\u8981\u91cd\u70b9\u5173\u6ce8\u7684\u6709\u6838\u5fc3\u7ebf\u7a0b\u6570\u3001\u6700\u5927\u7ebf\u7a0b\u6570\u3001\u7b49\u5f85\u961f\u5217\u3001\u62d2\u7edd\u7b56\u7565\u3002\r\n",(0,t.jsx)(e.img,{alt:"\u7ebf\u7a0b\u6c60\u53c2\u6570",src:r(61746).A+"",width:"782",height:"613"})]}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"corePoolSize\uff1a\u6838\u5fc3\u7ebf\u7a0b\u6570\uff0c\u957f\u671f\u5b58\u6d3b\uff0c\u6267\u884c\u4efb\u52a1\u7684\u4e3b\u529b\u3002"}),"\n",(0,t.jsx)(e.li,{children:"maximumPoolSize\uff1a\u7ebf\u7a0b\u6c60\u5141\u8bb8\u7684\u6700\u5927\u7ebf\u7a0b\u6570\u3002"}),"\n",(0,t.jsx)(e.li,{children:"workQueue\uff1a\u4efb\u52a1\u961f\u5217\uff0c\u5b58\u50a8\u7b49\u5f85\u6267\u884c\u7684\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.li,{children:"handler\uff1a\u62d2\u7edd\u7b56\u7565\uff0c\u4efb\u52a1\u8d85\u8f7d\u65f6\u7684\u5904\u7406\u65b9\u5f0f\u3002\u4e5f\u5c31\u662f\u7ebf\u7a0b\u6570\u8fbe\u5230 maximumPoolSiz\uff0c\u4efb\u52a1\u961f\u5217\u4e5f\u6ee1\u4e86\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u89e6\u53d1\u62d2\u7edd\u7b56\u7565\u3002"}),"\n",(0,t.jsx)(e.li,{children:"threadFactory\uff1a\u7ebf\u7a0b\u5de5\u5382\uff0c\u7528\u4e8e\u521b\u5efa\u7ebf\u7a0b\uff0c\u53ef\u81ea\u5b9a\u4e49\u7ebf\u7a0b\u540d\u3002"}),"\n",(0,t.jsx)(e.li,{children:"keepAliveTime\uff1a\u975e\u6838\u5fc3\u7ebf\u7a0b\u7684\u5b58\u6d3b\u65f6\u95f4\uff0c\u7a7a\u95f2\u65f6\u95f4\u8d85\u8fc7\u8be5\u503c\u5c31\u9500\u6bc1\u3002"}),"\n",(0,t.jsx)(e.li,{children:"unit\uff1akeepAliveTime \u53c2\u6570\u7684\u65f6\u95f4\u5355\u4f4d\uff1a\r\nTimeUnit.DAYS; \u5929\r\nTimeUnit.HOURS; \u5c0f\u65f6\r\nTimeUnit.MINUTES; \u5206\u949f\r\nTimeUnit.SECONDS; \u79d2\r\nTimeUnit.MILLISECONDS; \u6beb\u79d2\r\nTimeUnit.MICROSECONDS; \u5fae\u79d2\r\nTimeUnit.NANOSECONDS; \u7eb3\u79d2"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"\u80fd\u7b80\u5355\u8bf4\u4e00\u4e0b\u53c2\u6570\u4e4b\u95f4\u7684\u5173\u7cfb\u5417",children:"\u80fd\u7b80\u5355\u8bf4\u4e00\u4e0b\u53c2\u6570\u4e4b\u95f4\u7684\u5173\u7cfb\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e00\u53e5\u8bdd\uff1a\u4efb\u52a1\u4f18\u5148\u4f7f\u7528\u6838\u5fc3\u7ebf\u7a0b\u6267\u884c\uff0c\u6ee1\u4e86\u8fdb\u5165\u7b49\u5f85\u961f\u5217\uff0c\u961f\u5217\u6ee1\u4e86\u542f\u7528\u975e\u6838\u5fc3\u7ebf\u7a0b\u5907\u7528\uff0c\u7ebf\u7a0b\u6c60\u8fbe\u5230\u6700\u5927\u7ebf\u7a0b\u6570\u91cf\u540e\u89e6\u53d1\u62d2\u7edd\u7b56\u7565\uff0c\u975e\u6838\u5fc3\u7ebf\u7a0b\u7684\u7a7a\u95f2\u65f6\u95f4\u8d85\u8fc7\u5b58\u6d3b\u65f6\u95f4\u5c31\u88ab\u56de\u6536\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e0d\u591f\u4f1a\u600e\u4e48\u8fdb\u884c\u5904\u7406",children:"\u6838\u5fc3\u7ebf\u7a0b\u6570\u4e0d\u591f\u4f1a\u600e\u4e48\u8fdb\u884c\u5904\u7406\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u63d0\u4ea4\u7684\u4efb\u52a1\u6570\u8d85\u8fc7\u4e86 corePoolSize\uff0c\u4f46\u662f\u5c0f\u4e8e maximumPoolSize \u65f6\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u521b\u5efa\u65b0\u7684\u7ebf\u7a0b\u6765\u5904\u7406\u4efb\u52a1\u3002\r\n\u5f53\u63d0\u4ea4\u7684\u4efb\u52a1\u6570\u8d85\u8fc7\u4e86 maximumPoolSize \u65f6\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u6839\u636e\u62d2\u7edd\u7b56\u7565\u6765\u5904\u7406\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u4e3e\u4e2a\u4f8b\u5b50\u8bf4\u4e00\u4e0b\u8fd9\u4e9b\u53c2\u6570\u7684\u53d8\u5316",children:"\u4e3e\u4e2a\u4f8b\u5b50\u8bf4\u4e00\u4e0b\u8fd9\u4e9b\u53c2\u6570\u7684\u53d8\u5316\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5047\u8bbe\u4e00\u4e2a\u573a\u666f\uff0c\u7ebf\u7a0b\u6c60\u7684\u914d\u7f6e\u5982\u4e0b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"corePoolSize =5\r\nmaximumPoolSize =10\r\nkeepAliveTime =60\r\n\u79d2\r\nworkQueue = LinkedBlockingQueue\uff08\u5bb9\u91cf\u4e3a100\uff09\r\nhandler =ThreadPoolExecutor.\r\n\r\nAbortPolicy()\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u573a\u666f\u4e00\uff1a\u5f53\u7cfb\u7edf\u542f\u52a8\u540e\uff0c\u6709 10 \u4e2a\u4efb\u52a1\u63d0\u4ea4\u5230\u7ebf\u7a0b\u6c60\u3002\r\n\u524d 5 \u4e2a\u4efb\u52a1\u4f1a\u7acb\u5373\u6267\u884c\uff0c\u56e0\u4e3a\u6838\u5fc3\u7ebf\u7a0b\u6570\u8db3\u591f\u5bb9\u7eb3\u5b83\u4eec\u3002\r\n\u968f\u540e\u7684 5 \u4e2a\u4efb\u52a1\u4f1a\u88ab\u653e\u5165\u7b49\u5f85\u961f\u5217\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u573a\u666f\u4e8c\uff1a\u5982\u679c\u6b64\u65f6\u518d\u6709 100 \u4e2a\u4efb\u52a1\u63d0\u4ea4\u5230\u7ebf\u7a0b\u6c60\u3002\r\n\u5de5\u4f5c\u961f\u5217\u5df2\u6ee1\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u521b\u5efa\u989d\u5916\u7684\u7ebf\u7a0b\u6765\u6267\u884c\u8fd9\u4e9b\u4efb\u52a1\uff0c\u76f4\u5230\u7ebf\u7a0b\u603b\u6570\u8fbe\u5230 10\u3002\r\n\u5982\u679c\u4efb\u52a1\u7ee7\u7eed\u589e\u52a0\uff0c\u8d85\u8fc7\u4e86\u5de5\u4f5c\u961f\u5217+\u6700\u5927\u7ebf\u7a0b\u6570\u7684\u9650\u5236\uff0c\u65b0\u6765\u7684\u4efb\u52a1\u4f1a\u88ab AbortPolicy \u62d2\u7edd\uff0c\u629b\u51fa RejectedExecutionException \u5f02\u5e38\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u573a\u666f\u4e09\uff1a\u5982\u679c\u4efb\u52a1\u7a81\u7136\u51cf\u5c11\uff1a\r\n\u6838\u5fc3\u7ebf\u7a0b\u4f1a\u4e00\u76f4\u8fd0\u884c\uff0c\u800c\u8d85\u51fa\u6838\u5fc3\u7ebf\u7a0b\u6570\u7684\u7ebf\u7a0b\uff0c\u4f1a\u5728 60 \u79d2\u540e\u56de\u6536\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u7684\u62d2\u7edd\u7b56\u7565\u6709\u54ea\u4e9b",children:"\ud83c\udf1f\u7ebf\u7a0b\u6c60\u7684\u62d2\u7edd\u7b56\u7565\u6709\u54ea\u4e9b\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u6709\u56db\u79cd\uff1a\r\nAbortPolicy\uff1a\u9ed8\u8ba4\u7684\u62d2\u7edd\u7b56\u7565\uff0c\u4f1a\u629b RejectedExecutionException \u5f02\u5e38\u3002\r\nCallerRunsPolicy\uff1a\u8ba9\u63d0\u4ea4\u4efb\u52a1\u7684\u7ebf\u7a0b\u81ea\u5df1\u6765\u6267\u884c\u8fd9\u4e2a\u4efb\u52a1\uff0c\u4e5f\u5c31\u662f\u8c03\u7528 execute \u65b9\u6cd5\u7684\u7ebf\u7a0b\u3002\r\nDiscardOldestPolicy\uff1a\u7b49\u5f85\u961f\u5217\u4f1a\u4e22\u5f03\u961f\u5217\u4e2d\u6700\u8001\u7684\u4e00\u4e2a\u4efb\u52a1\uff0c\u4e5f\u5c31\u662f\u961f\u5217\u4e2d\u7b49\u5f85\u6700\u4e45\u7684\u4efb\u52a1\uff0c\u7136\u540e\u5c1d\u8bd5\u91cd\u65b0\u63d0\u4ea4\u88ab\u62d2\u7edd\u7684\u4efb\u52a1\u3002\r\nDiscardPolicy\uff1a\u4e22\u5f03\u88ab\u62d2\u7edd\u7684\u4efb\u52a1\uff0c\u4e0d\u505a\u4efb\u4f55\u5904\u7406\u4e5f\u4e0d\u629b\u51fa\u5f02\u5e38\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757508211789",src:r(15121).A+"",width:"649",height:"600"}),"\r\n\u5206\u522b\u5bf9\u5e94\u7740\u5c0f\u4e8c\u53bb\u94f6\u884c\u529e\u7406\u4e1a\u52a1\u88ab\u7ecf\u7406\u201c\u8584\u7eb1\u201d\u7684\u56db\u4e2a\u573a\u666f\uff1a\u201c\u6211\u4eec\u7cfb\u7edf\u762b\u75ea\u4e86\u201d\u3001\u201c\u8c01\u53eb\u4f60\u6765\u529e\u7684\u4f60\u627e\u8c01\u53bb\u201d\u3001\u201c\u770b\u4f60\u6bd4\u8f83\u6025\uff0c\u53bb\u961f\u91cc\u52a0\u4e2a\u585e\u201d\u3001\u201c\u4eca\u5929\u6ca1\u529e\u6cd5\uff0c\u4e0d\u884c\u4f60\u770b\u6539\u4e00\u5929\u201d\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u7ebf\u7a0b\u6c60\u65e0\u6cd5\u63a5\u53d7\u65b0\u7684\u4efb\u52a1\u65f6\uff0c\u4e5f\u5c31\u662f\u7ebf\u7a0b\u6570\u8fbe\u5230 maximumPoolSize\uff0c\u4efb\u52a1\u961f\u5217\u4e5f\u6ee1\u4e86\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u89e6\u53d1\u62d2\u7edd\u7b56\u7565\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u9ed8\u8ba4\u7b56\u7565\u4e0d\u80fd\u6ee1\u8db3\u9700\u6c42\uff0c\u53ef\u4ee5\u901a\u8fc7\u5b9e\u73b0 RejectedExecutionHandler \u63a5\u53e3\u6765\u5b9a\u4e49\u81ea\u5df1\u7684\u6dd8\u6c70\u7b56\u7565\u3002\u4f8b\u5982\uff1a\u8bb0\u5f55\u88ab\u62d2\u7edd\u4efb\u52a1\u7684\u65e5\u5fd7\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class CustomRejectedHandler {\r\n    public static void main(String[] args) {\r\n        // \u81ea\u5b9a\u4e49\u62d2\u7edd\u7b56\u7565\r\n        RejectedExecutionHandler rejectedHandler = (r, executor) -> {\r\n            System.out.println("Task " + r.toString() + " rejected. Queue size: "\r\n                    + executor.getQueue().size());\r\n        };\r\n\r\n        // \u81ea\u5b9a\u4e49\u7ebf\u7a0b\u6c60\r\n        ThreadPoolExecutor executor = new ThreadPoolExecutor(\r\n                2,                      // \u6838\u5fc3\u7ebf\u7a0b\u6570\r\n                4,                      // \u6700\u5927\u7ebf\u7a0b\u6570\r\n                10,                     // \u7a7a\u95f2\u7ebf\u7a0b\u5b58\u6d3b\u65f6\u95f4\r\n                TimeUnit.SECONDS,\r\n                new ArrayBlockingQueue<>(2),  // \u963b\u585e\u961f\u5217\u5bb9\u91cf\r\n                Executors.defaultThreadFactory(),\r\n                rejectedHandler          // \u81ea\u5b9a\u4e49\u62d2\u7edd\u7b56\u7565\r\n        );\r\n\r\n        for (int i = 0; i < 10; i++) {\r\n            final int taskNumber = i;\r\n            executor.execute(() -> {\r\n                System.out.println("Executing task " + taskNumber);\r\n                try {\r\n                    Thread.sleep(1000); // \u6a21\u62df\u4efb\u52a1\u8017\u65f6\r\n                } catch (InterruptedException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            });\r\n        }\r\n\r\n        executor.shutdown();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u6709\u54ea\u51e0\u79cd\u963b\u585e\u961f\u5217",children:"\u7ebf\u7a0b\u6c60\u6709\u54ea\u51e0\u79cd\u963b\u585e\u961f\u5217\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u5e38\u7528\u7684\u6709\u4e94\u79cd\uff0c\u6709\u754c\u961f\u5217 ArrayBlockingQueue\uff1b\u65e0\u754c\u961f\u5217 LinkedBlockingQueue\uff1b\u4f18\u5148\u7ea7\u961f\u5217 PriorityBlockingQueue\uff1b\u5ef6\u8fdf\u961f\u5217\r\nDelayQueue\uff1b\u540c\u6b65\u961f\u5217 SynchronousQueue\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757508244127",src:r(7441).A+"",width:"986",height:"474"}),"\r\n\u2460\u3001ArrayBlockingQueue\uff1a\u4e00\u4e2a\u6709\u754c\u7684\u5148\u8fdb\u5148\u51fa\u7684\u963b\u585e\u961f\u5217\uff0c\u5e95\u5c42\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u9002\u5408\u56fa\u5b9a\u5927\u5c0f\u7684\u7ebf\u7a0b\u6c60\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"ArrayBlockingQueue<Integer> blockingQueue = new ArrayBlockingQueue<Integer>(10, true);\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u2461\u3001LinkedBlockingQueue\uff1a\u5e95\u5c42\u662f\u94fe\u8868\uff0c\u5982\u679c\u4e0d\u6307\u5b9a\u5927\u5c0f\uff0c\u9ed8\u8ba4\u5927\u5c0f\u662f Integer.MAX_VALUE\uff0c\u51e0\u4e4e\u76f8\u5f53\u4e8e\u4e00\u4e2a\u65e0\u754c\u961f\u5217\u3002\r\n\u6280\u672f\u6d3e\u5b9e\u6218\u9879\u76ee\u4e2d\uff0c\u5c31\u4f7f\u7528\u4e86 LinkedBlockingQueue \u6765\u914d\u7f6e RabbitMQ \u7684\u6d88\u606f\u961f\u5217\u3002\r\n\u2462\u3001PriorityBlockingQueue\uff1a\u4e00\u4e2a\u652f\u6301\u4f18\u5148\u7ea7\u6392\u5e8f\u7684\u65e0\u754c\u963b\u585e\u961f\u5217\u3002\u4efb\u52a1\u6309\u7167\u5176\u81ea\u7136\u987a\u5e8f\u6216 Comparator \u6765\u6392\u5e8f\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u9002\u7528\u4e8e\u9700\u8981\u6309\u7167\u7ed9\u5b9a\u4f18\u5148\u7ea7\u5904\u7406\u4efb\u52a1\u7684\u573a\u666f\uff0c\u6bd4\u5982\u4f18\u5148\u5904\u7406\u7d27\u6025\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u2463\u3001DelayQueue\uff1a\u7c7b\u4f3c\u4e8e PriorityBlockingQueue\uff0c\u7531\u4e8c\u53c9\u5806\u5b9e\u73b0\u7684\u65e0\u754c\u4f18\u5148\u7ea7\u963b\u585e\u961f\u5217\u3002"}),"\n",(0,t.jsx)(e.p,{children:"Executors \u4e2d\u7684 newScheduledThreadPool() \u5c31\u4f7f\u7528\u4e86 DelayQueue \u6765\u5b9e\u73b0\u5ef6\u8fdf\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public ScheduledThreadPoolExecutor(int corePoolSize) {\r\n    super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS,\r\n            new DelayedWorkQueue());\r\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u2464\u3001SynchronousQueue\uff1a\u6bcf\u4e2a\u63d2\u5165\u64cd\u4f5c\u5fc5\u987b\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u7684\u79fb\u9664\u64cd\u4f5c\uff0c\u540c\u6837\uff0c\u4efb\u4f55\u4e00\u4e2a\u79fb\u9664\u64cd\u4f5c\u90fd\u5fc5\u987b\u7b49\u5f85\u53e6\u4e00\u4e2a\u7ebf\u7a0b\u7684\u63d2\u5165\u64cd\u4f5c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"Executors.newCachedThreadPool() \u5c31\u4f7f\u7528\u4e86 SynchronousQueue\uff0c\u8fd9\u4e2a\u7ebf\u7a0b\u6c60\u4f1a\u6839\u636e\u9700\u8981\u521b\u5efa\u65b0\u7ebf\u7a0b\uff0c\u5982\u679c\u6709\u7a7a\u95f2\u7ebf\u7a0b\u5219\u4f1a\u91cd\u590d\u4f7f\u7528\uff0c\u7ebf\u7a0b\u7a7a\u95f2\r\n60 \u79d2\u540e\u4f1a\u88ab\u56de\u6536\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public static ExecutorService newCachedThreadPool() {\r\n    return new ThreadPoolExecutor(0, Integer.MAX_VALUE,\r\n            60L, TimeUnit.SECONDS,\r\n            new SynchronousQueue<Runnable>());\r\n}   \n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u63d0\u4ea4-execute-\u548c-submit-\u6709\u4ec0\u4e48\u533a\u522b",children:"\u7ebf\u7a0b\u6c60\u63d0\u4ea4 execute \u548c submit \u6709\u4ec0\u4e48\u533a\u522b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"execute \u65b9\u6cd5\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u9002\u7528\u4e8e\u4e0d\u5173\u5fc3\u7ed3\u679c\u548c\u5f02\u5e38\u7684\u7b80\u5355\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'threadsPool.execute(new Runnable() {\r\n    @Override public void run () {\r\n        System.out.println("execute() \u65b9\u6cd5\u63d0\u4ea4\u7684\u4efb\u52a1");\r\n    }\r\n});\n'})}),"\n",(0,t.jsx)(e.p,{children:"submit \u6709\u8fd4\u56de\u503c\uff0c\u9002\u7528\u4e8e\u9700\u8981\u83b7\u53d6\u7ed3\u679c\u6216\u5904\u7406\u5f02\u5e38\u7684\u573a\u666f\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"Future<Object> future = executor.submit(harReturnValuetask);\r\ntry{\r\nObject s = future.get(); }\r\n        catch(\r\nInterruptedException e |\r\nExecutionException e){\r\n        // \u5904\u7406\u65e0\u6cd5\u6267\u884c\u4efb\u52a1\u5f02\u5e38\r\n        }finally{\r\n        // \u5173\u95ed\u7ebf\u7a0b\u6c60 executor.shutdown();\r\n        }\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u600e\u4e48\u5173\u95ed\u77e5\u9053\u5417",children:"\u7ebf\u7a0b\u6c60\u600e\u4e48\u5173\u95ed\u77e5\u9053\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u8c03\u7528\u7ebf\u7a0b\u6c60\u7684shutdown\u6216shutdownNow\u65b9\u6cd5\u6765\u5173\u95ed\u7ebf\u7a0b\u6c60\u3002"}),"\n",(0,t.jsx)(e.p,{children:"shutdown \u4e0d\u4f1a\u7acb\u5373\u505c\u6b62\u7ebf\u7a0b\u6c60\uff0c\u800c\u662f\u7b49\u5f85\u6240\u6709\u4efb\u52a1\u6267\u884c\u5b8c\u6bd5\u540e\u518d\u5173\u95ed\u7ebf\u7a0b\u6c60\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'ExecutorService executor = Executors.newFixedThreadPool(3);\r\nexecutor.\r\n\r\nexecute(() ->System.out.\r\n\r\nprintln("Task 1"));\r\n        executor.\r\n\r\nexecute(() ->System.out.\r\n\r\nprintln("Task 2"));\r\n\r\n        executor.\r\n\r\nshutdown(); // \u4e0d\u4f1a\u7acb\u523b\u5173\u95ed\uff0c\u800c\u662f\u7b49\u5f85\u6240\u6709\u4efb\u52a1\u6267\u884c\u5b8c\u6bd5\n'})}),"\n",(0,t.jsx)(e.p,{children:"shutdownNow \u4f1a\u5c1d\u8bd5\u901a\u8fc7\u4e00\u7cfb\u5217\u52a8\u4f5c\u6765\u505c\u6b62\u7ebf\u7a0b\u6c60\uff0c\u5305\u62ec\u505c\u6b62\u63a5\u6536\u5916\u90e8\u63d0\u4ea4\u7684\u4efb\u52a1\u3001\u5ffd\u7565\u961f\u5217\u91cc\u7b49\u5f85\u7684\u4efb\u52a1\u3001\u5c1d\u8bd5\u5c06\u6b63\u5728\u8dd1\u7684\u4efb\u52a1\r\ninterrupt \u4e2d\u65ad\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'ExecutorService executor = Executors.newFixedThreadPool(3);\r\nexecutor.\r\n\r\nexecute(() ->{\r\n        try{\r\n        Thread.\r\n\r\nsleep(5000); // \u6a21\u62df\u957f\u65f6\u95f4\u8fd0\u884c\u4efb\u52a1\r\n        System.out.\r\n\r\nprintln("Task executed");\r\n    }catch(\r\nInterruptedException e){\r\n        System.out.\r\n\r\nprintln("\u4efb\u52a1\u88ab\u4e2d\u65ad");\r\n    }\r\n            });\r\n\r\nList<Runnable> unexecutedTasks = executor.shutdownNow(); // \u7acb\u5373\u5173\u95ed\u7ebf\u7a0b\u6c60\r\nSystem.out.\r\n\r\nprintln("\u672a\u6267\u884c\u7684\u4efb\u52a1\u6570: "+unexecutedTasks.size());\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cshutdownNow \u4e0d\u4f1a\u771f\u6b63\u7ec8\u6b62\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\uff0c\u53ea\u662f\u7ed9\u4efb\u52a1\u7ebf\u7a0b\u53d1\u9001 interrupt \u4fe1\u53f7\uff0c\u4efb\u52a1\u662f\u5426\u80fd\u771f\u6b63\u7ec8\u6b62\u53d6\u51b3\u4e8e\u7ebf\u7a0b\u662f\u5426\u54cd\u5e94\r\nInterruptedException\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u6570\u5e94\u8be5\u600e\u4e48\u914d\u7f6e",children:"\u7ebf\u7a0b\u6c60\u7684\u7ebf\u7a0b\u6570\u5e94\u8be5\u600e\u4e48\u914d\u7f6e\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u9996\u5148\uff0c\u6211\u4f1a\u5206\u6790\u7ebf\u7a0b\u6c60\u4e2d\u6267\u884c\u7684\u4efb\u52a1\u7c7b\u578b\u662f CPU \u5bc6\u96c6\u578b\u8fd8\u662f IO \u5bc6\u96c6\u578b\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u2460\u3001\u5bf9\u4e8e CPU \u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u6211\u7684\u76ee\u6807\u662f\u5c3d\u91cf\u51cf\u5c11\u7ebf\u7a0b\u4e0a\u4e0b\u6587\u5207\u6362\uff0c\u4ee5\u4f18\u5316 CPU \u4f7f\u7528\u7387\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u6838\u5fc3\u7ebf\u7a0b\u6570\u8bbe\u7f6e\u4e3a\u5904\u7406\u5668\u7684\u6838\u5fc3\u6570\u6216\u6838\u5fc3\u6570\u52a0\u4e00\u662f\u8f83\u7406\u60f3\u7684\u9009\u62e9\u3002"}),"\n",(0,t.jsx)(e.p,{children:"+1 \u662f\u4e3a\u4e86\u4ee5\u5907\u4e0d\u65f6\u4e4b\u9700\uff0c\u5982\u679c\u67d0\u7ebf\u7a0b\u56e0\u7b49\u5f85\u7cfb\u7edf\u8d44\u6e90\u800c\u963b\u585e\u65f6\uff0c\u53ef\u4ee5\u6709\u591a\u4f59\u7684\u7ebf\u7a0b\u9876\u4e0a\u53bb\uff0c\u4e0d\u81f3\u4e8e\u5f71\u54cd\u6574\u4f53\u6027\u80fd\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u2461\u3001\u5bf9\u4e8e IO \u5bc6\u96c6\u578b\u4efb\u52a1\uff0c\u7531\u4e8e\u7ebf\u7a0b\u7ecf\u5e38\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\uff0c\u7b49\u5f85 IO \u64cd\u4f5c\u5b8c\u6210\uff0c\u6240\u4ee5\u53ef\u4ee5\u8bbe\u7f6e\u66f4\u591a\u7684\u7ebf\u7a0b\u6765\u63d0\u9ad8\u5e76\u53d1\uff0c\u6bd4\u5982\u8bf4 CPU \u6838\u5fc3\u6570\u7684\u4e24\u500d\u3002\r\n\u6700\u540e\uff0c\u6211\u4f1a\u6839\u636e\u4e1a\u52a1\u9700\u6c42\u548c\u7cfb\u7edf\u8d44\u6e90\u6765\u8c03\u6574\u7ebf\u7a0b\u6c60\u7684\u5176\u4ed6\u53c2\u6570\uff0c\u6bd4\u5982\u6700\u5927\u7ebf\u7a0b\u6570\u3001\u4efb\u52a1\u961f\u5217\u5bb9\u91cf\u3001\u975e\u6838\u5fc3\u7ebf\u7a0b\u7684\u7a7a\u95f2\u5b58\u6d3b\u65f6\u95f4\u7b49\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"ThreadPoolExecutor executor = new ThreadPoolExecutor(\r\n        cores, // \u6838\u5fc3\u7ebf\u7a0b\u6570\u8bbe\u7f6e\u4e3aCPU\u6838\u5fc3\u6570\r\n        cores * 2, // \u6700\u5927\u7ebf\u7a0b\u6570\u4e3a\u6838\u5fc3\u6570\u7684\u4e24\u500d\r\n        60L, TimeUnit.SECONDS, // \u975e\u6838\u5fc3\u7ebf\u7a0b\u7684\u7a7a\u95f2\u5b58\u6d3b\u65f6\u95f4\r\n        new LinkedBlockingQueue<>(100) // \u4efb\u52a1\u961f\u5217\u5bb9\u91cf\r\n);\n"})}),"\n",(0,t.jsx)(e.h3,{id:"\u5982\u4f55\u77e5\u9053\u4f60\u8bbe\u7f6e\u7684\u7ebf\u7a0b\u6570\u591a\u4e86\u8fd8\u662f\u5c11\u4e86",children:"\u5982\u4f55\u77e5\u9053\u4f60\u8bbe\u7f6e\u7684\u7ebf\u7a0b\u6570\u591a\u4e86\u8fd8\u662f\u5c11\u4e86\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u901a\u8fc7\u76d1\u63a7\u548c\u8c03\u8bd5\u6765\u5224\u65ad\u7ebf\u7a0b\u6570\u662f\u591a\u8fd8\u662f\u5c11\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u6bd4\u5982\u8bf4\u901a\u8fc7 top \u547d\u4ee4\u89c2\u5bdf CPU \u7684\u4f7f\u7528\u7387\uff0c\u5982\u679c CPU \u4f7f\u7528\u7387\u8f83\u4f4e\uff0c\u53ef\u80fd\u662f\u7ebf\u7a0b\u6570\u8fc7\u5c11\uff1b\u5982\u679c CPU \u4f7f\u7528\u7387\u63a5\u8fd1 100%\uff0c\u4f46\u541e\u5410\u91cf\u672a\u63d0\u5347\uff0c\u53ef\u80fd\u662f\u7ebf\u7a0b\u6570\u8fc7\u591a\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7136\u540e\u518d\u901a\u8fc7 VisualVM \u6216 Arthas \u5206\u6790\u7ebf\u7a0b\u8fd0\u884c\u60c5\u51b5\uff0c\u67e5\u770b\u7ebf\u7a0b\u7684\u72b6\u6001\u3001\u7b49\u5f85\u65f6\u95f4\u3001\u8fd0\u884c\u65f6\u95f4\u7b49\u4fe1\u606f\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u4e5f\u53ef\u4ee5\u4f7f\u7528 jstack \u547d\u4ee4\u67e5\u770b\u7ebf\u7a0b\u5806\u6808\u4fe1\u606f\uff0c\u67e5\u770b\u7ebf\u7a0b\u662f\u5426\u5904\u4e8e\u963b\u585e\u72b6\u6001\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'jstack<Java \u8fdb\u7a0b\r\nID>|grep -A 20"BLOCKED" // \u67e5\u770b\u963b\u585e\u7ebf\u7a0b\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u6709\u5927\u91cf\u7684 BLOCKED \u7ebf\u7a0b\uff0c\u8bf4\u660e\u7ebf\u7a0b\u6570\u53ef\u80fd\u8fc7\u591a\uff0c\u7ade\u4e89\u6bd4\u8f83\u6fc0\u70c8\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u6709\u54ea\u51e0\u79cd\u5e38\u89c1\u7684\u7ebf\u7a0b\u6c60",children:"\u6709\u54ea\u51e0\u79cd\u5e38\u89c1\u7684\u7ebf\u7a0b\u6c60\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e3b\u8981\u6709\u56db\u79cd\uff1a"}),"\n",(0,t.jsx)(e.p,{children:"\u56fa\u5b9a\u5927\u5c0f\u7684\u7ebf\u7a0b\u6c60 Executors.newFixedThreadPool(int nThreads);\uff0c\u9002\u5408\u7528\u4e8e\u4efb\u52a1\u6570\u91cf\u786e\u5b9a\uff0c\u4e14\u5bf9\u7ebf\u7a0b\u6570\u6709\u660e\u786e\u8981\u6c42\u7684\u573a\u666f\u3002\u4f8b\u5982\uff0cIO\r\n\u5bc6\u96c6\u578b\u4efb\u52a1\u3001\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7b49\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7f13\u5b58\u7ebf\u7a0b\u6c60 Executors.newCachedThreadPool();\uff0c\u9002\u7528\u4e8e\u77ed\u65f6\u95f4\u5185\u4efb\u52a1\u91cf\u6ce2\u52a8\u8f83\u5927\u7684\u573a\u666f\u3002\u4f8b\u5982\uff0c\u77ed\u65f6\u95f4\u5185\u6709\u5927\u91cf\u7684\u6587\u4ef6\u5904\u7406\u4efb\u52a1\u6216\u7f51\u7edc\u8bf7\u6c42\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5b9a\u65f6\u4efb\u52a1\u7ebf\u7a0b\u6c60 Executors.newScheduledThreadPool(int corePoolSize);\uff0c\u9002\u7528\u4e8e\u9700\u8981\u5b9a\u65f6\u6267\u884c\u4efb\u52a1\u7684\u573a\u666f\u3002\u4f8b\u5982\uff0c\u5b9a\u65f6\u53d1\u9001\u90ae\u4ef6\u3001\u5b9a\u65f6\u5907\u4efd\u6570\u636e\u7b49\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5355\u7ebf\u7a0b\u7ebf\u7a0b\u6c60 Executors.newSingleThreadExecutor();\uff0c\u9002\u7528\u4e8e\u9700\u8981\u6309\u987a\u5e8f\u6267\u884c\u4efb\u52a1\u7684\u573a\u666f\u3002\u4f8b\u5982\uff0c\u65e5\u5fd7\u8bb0\u5f55\u3001\u6587\u4ef6\u5904\u7406\u7b49\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u80fd\u8bf4\u4e00\u4e0b\u56db\u79cd\u5e38\u89c1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\u5417",children:"\u80fd\u8bf4\u4e00\u4e0b\u56db\u79cd\u5e38\u89c1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u4e0d\u7ba1\u662f FixedThreadPool\u3001CachedThreadPool\uff0c\u8fd8\u662f SingleThreadExecutor \u548c ScheduledThreadPoolExecutor\uff0c\u5b83\u4eec\u672c\u8d28\u4e0a\u90fd\u662f\r\nThreadPoolExecutor \u7684\u4e0d\u540c\u914d\u7f6e\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4\u56fa\u5b9a\u5927\u5c0f\u7ebf\u7a0b\u6c60\u7684\u539f\u7406",children:"\u8bf4\u8bf4\u56fa\u5b9a\u5927\u5c0f\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u6c60\u5927\u5c0f\u662f\u56fa\u5b9a\u7684\uff0ccorePoolSize == maximumPoolSize\uff0c\u9ed8\u8ba4\u4f7f\u7528 LinkedBlockingQueue \u4f5c\u4e3a\u963b\u585e\u961f\u5217\uff0c\u9002\u7528\u4e8e\u4efb\u52a1\u91cf\u7a33\u5b9a\u7684\u573a\u666f\uff0c\u5982\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3001RPC\r\n\u5904\u7406\u7b49\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"new ThreadPoolExecutor(4,4,0L,TimeUnit.MILLISECONDS,\r\n                       new LinkedBlockingQueue<>());\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u65b0\u4efb\u52a1\u63d0\u4ea4\u65f6\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u6709\u7a7a\u95f2\u7ebf\u7a0b\uff0c\u76f4\u63a5\u6267\u884c\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u4efb\u52a1\u8fdb\u5165 LinkedBlockingQueue \u7b49\u5f85\u3002\u7f3a\u70b9\u662f\u4efb\u52a1\u961f\u5217\u9ed8\u8ba4\u65e0\u754c\uff0c\u53ef\u80fd\u5bfc\u81f4\u4efb\u52a1\u5806\u79ef\uff0c\u751a\u81f3\r\nOOM\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757508709796",src:r(41647).A+"",width:"991",height:"524"})]}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4\u7f13\u5b58\u7ebf\u7a0b\u6c60\u7684\u539f\u7406",children:"\u8bf4\u8bf4\u7f13\u5b58\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u6c60\u5927\u5c0f\u4e0d\u56fa\u5b9a\uff0ccorePoolSize = 0\uff0cmaximumPoolSize = Integer.MAX_VALUE\u3002\u7a7a\u95f2\u7ebf\u7a0b\u8d85\u8fc7 60 \u79d2\u4f1a\u88ab\u9500\u6bc1\uff0c\u4f7f\u7528 SynchronousQueue\r\n\u4f5c\u4e3a\u963b\u585e\u961f\u5217\uff0c\u9002\u7528\u4e8e\u77ed\u65f6\u95f4\u5185\u6709\u5927\u91cf\u4efb\u52a1\u7684\u573a\u666f\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"new ThreadPoolExecutor(0,Integer.MAX_VALUE, 60L,TimeUnit.SECONDS,\r\n                       new SynchronousQueue<>());\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u63d0\u4ea4\u4efb\u52a1\u65f6\uff0c\u5982\u679c\u7ebf\u7a0b\u6c60\u6ca1\u6709\u7a7a\u95f2\u7ebf\u7a0b\uff0c\u76f4\u63a5\u65b0\u5efa\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1\uff1b\u5982\u679c\u6709\uff0c\u590d\u7528\u7ebf\u7a0b\u6267\u884c\u4efb\u52a1\u3002\u7ebf\u7a0b\u7a7a\u95f2 60\r\n\u79d2\u540e\u9500\u6bc1\uff0c\u51cf\u5c11\u8d44\u6e90\u5360\u7528\u3002\u7f3a\u70b9\u662f\u7ebf\u7a0b\u6570\u6ca1\u6709\u4e0a\u9650\uff0c\u5728\u9ad8\u5e76\u53d1\u60c5\u51b5\u4e0b\u53ef\u80fd\u5bfc\u81f4 OOM\u3002"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"1757508753691",src:r(30142).A+"",width:"921",height:"687"}),"\r\n\u7ebf\u7a0b\u6c60\u53ea\u6709 1 \u4e2a\u7ebf\u7a0b\uff0c\u4fdd\u8bc1\u4efb\u52a1\u6309\u63d0\u4ea4\u987a\u5e8f\u6267\u884c\uff0c\u4f7f\u7528 LinkedBlockingQueue \u4f5c\u4e3a\u963b\u585e\u961f\u5217\uff0c\u9002\u7528\u4e8e\u9700\u8981\u6309\u987a\u5e8f\u6267\u884c\u4efb\u52a1\u7684\u573a\u666f\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"new ThreadPoolExecutor(1,1,0L,TimeUnit.MILLISECONDS,\r\n                       new LinkedBlockingQueue<>());\n"})}),"\n",(0,t.jsx)(e.p,{children:"\u59cb\u7ec8\u53ea\u521b\u5efa 1 \u4e2a\u7ebf\u7a0b\uff0c\u65b0\u4efb\u52a1\u5fc5\u987b\u7b49\u5f85\u524d\u4e00\u4e2a\u4efb\u52a1\u5b8c\u6210\u540e\u624d\u80fd\u6267\u884c\uff0c\u5176\u4ed6\u4efb\u52a1\u90fd\u88ab\u653e\u5165 LinkedBlockingQueue \u6392\u961f\u6267\u884c\u3002\u7f3a\u70b9\u662f\u65e0\u6cd5\u5e76\u884c\u5904\u7406\u4efb\u52a1\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"1757508789454",src:r(57178).A+"",width:"916",height:"430"})}),"\n",(0,t.jsx)(e.h3,{id:"\u8bf4\u8bf4\u5b9a\u65f6\u4efb\u52a1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406",children:"\u8bf4\u8bf4\u5b9a\u65f6\u4efb\u52a1\u7ebf\u7a0b\u6c60\u7684\u539f\u7406\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5b9a\u65f6\u4efb\u52a1\u7ebf\u7a0b\u6c60\u7684\u5927\u5c0f\u53ef\u914d\u7f6e\uff0c\u652f\u6301\u5b9a\u65f6 & \u5468\u671f\u6027\u4efb\u52a1\u6267\u884c\uff0c\u4f7f\u7528 DelayedWorkQueue \u4f5c\u4e3a\u963b\u585e\u961f\u5217\uff0c\u9002\u7528\u4e8e\u5468\u671f\u6027\u6267\u884c\u4efb\u52a1\u7684\u573a\u666f\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:"public ScheduledThreadPoolExecutor(int corePoolSize) {\r\n    super(corePoolSize, Integer.MAX_VALUE, 0, NANOSECONDS,\r\n            new DelayedWorkQueue());\r\n}\n"})}),"\n",(0,t.jsxs)(e.p,{children:["\u6267\u884c\u5b9a\u65f6\u4efb\u52a1\u65f6\uff0cschedule() \u65b9\u6cd5\u53ef\u4ee5\u5c06\u4efb\u52a1\u5ef6\u8fdf\u4e00\u5b9a\u65f6\u95f4\u540e\u6267\u884c\u4e00\u6b21\uff1bscheduleAtFixedRate()\r\n\u65b9\u6cd5\u53ef\u4ee5\u5c06\u4efb\u52a1\u5ef6\u8fdf\u4e00\u5b9a\u65f6\u95f4\u540e\u4ee5\u56fa\u5b9a\u9891\u7387\u6267\u884c\uff1bscheduleWithFixedDelay() \u65b9\u6cd5\u53ef\u4ee5\u5c06\u4efb\u52a1\u5ef6\u8fdf\u4e00\u5b9a\u65f6\u95f4\u540e\u4ee5\u56fa\u5b9a\u5ef6\u8fdf\u6267\u884c\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757508821932",src:r(93780).A+"",width:"984",height:"535"}),"\r\n\u7f3a\u70b9\u662f\uff0c\u5982\u679c\u4efb\u52a1\u6267\u884c\u65f6\u95f4 > \u8bbe\u5b9a\u65f6\u95f4\u95f4\u9694\uff0cscheduleAtFixedRate \u53ef\u80fd\u4f1a\u5bfc\u81f4\u4efb\u52a1\u5806\u79ef\u3002"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"1757508903269",src:r(21716).A+"",width:"926",height:"488"})}),"\n",(0,t.jsx)(e.h3,{id:"\u4f7f\u7528\u65e0\u754c\u961f\u5217\u7684\u7ebf\u7a0b\u6c60\u4f1a\u51fa\u73b0\u4ec0\u4e48\u95ee\u9898",children:"\u4f7f\u7528\u65e0\u754c\u961f\u5217\u7684\u7ebf\u7a0b\u6c60\u4f1a\u51fa\u73b0\u4ec0\u4e48\u95ee\u9898\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u7ebf\u7a0b\u83b7\u53d6\u4e00\u4e2a\u4efb\u52a1\u540e\uff0c\u4efb\u52a1\u7684\u6267\u884c\u65f6\u95f4\u6bd4\u8f83\u957f\uff0c\u4f1a\u5bfc\u81f4\u961f\u5217\u7684\u4efb\u52a1\u8d8a\u79ef\u8d8a\u591a\uff0c\u5bfc\u81f4\u5185\u5b58\u4f7f\u7528\u4e0d\u65ad\u98d9\u5347\uff0c\u6700\u7ec8\u51fa\u73b0 OOM"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u5f02\u5e38\u600e\u4e48\u5904\u7406\u77e5\u9053\u5417",children:"\u7ebf\u7a0b\u6c60\u5f02\u5e38\u600e\u4e48\u5904\u7406\u77e5\u9053\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u5e38\u89c1\u7684\u5904\u7406\u65b9\u5f0f\u6709\uff0c\u4f7f\u7528 try-catch \u6355\u83b7\u3001\u4f7f\u7528 Future \u83b7\u53d6\u5f02\u5e38\u3001\u81ea\u5b9a\u4e49ThreadPoolExecutor \u91cd\u5199 afterExecute \u65b9\u6cd5\u3001\u4f7f\u7528\r\nUncaughtExceptionHandler \u6355\u83b7\u5f02\u5e38\u3002"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.img,{alt:"1757508933258",src:r(94839).A+"",width:"711",height:"502"})}),"\n",(0,t.jsx)(e.p,{children:"\u2460\u3001try-catch \u662f\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'executor.execute(() ->{\r\n        try{\r\n        System.out.\r\n\r\nprintln("\u4efb\u52a1\u5f00\u59cb");\r\n\r\nint result = 1 / 0; // \u9664\u96f6\u5f02\u5e38\r\n    }catch(\r\nException e){\r\n        System.err.\r\n\r\nprintln("\u6355\u83b7\u5f02\u5e38\uff1a"+e.getMessage());\r\n        }\r\n        });\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u2461\u3001\u4f7f\u7528 Future \u83b7\u53d6\u5f02\u5e38\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'Future<Object> future = executor.submit(() -> {\r\n    System.out.println("\u4efb\u52a1\u5f00\u59cb");\r\n    int result = 1 / 0; // \u9664\u96f6\u5f02\u5e38\r\n    return result;\r\n});\r\n\r\ntry{\r\n        future.\r\n\r\nget();\r\n}catch(InterruptedException |\r\nExecutionException e){\r\n        System.err.\r\n\r\nprintln("\u6355\u83b7\u5f02\u5e38\uff1a"+e.getMessage());\r\n        }\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u2462\u3001\u81ea\u5b9a\u4e49 ThreadPoolExecutor \u91cd\u5199 afterExecute \u65b9\u6cd5\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'ThreadPoolExecutor executor = new ThreadPoolExecutor(2, 2, 0L, TimeUnit.MILLISECONDS,\r\n        new LinkedBlockingQueue<Runnable>()) {\r\n    @Override\r\n    protected void afterExecute(Runnable r, Throwable t) {\r\n        super.afterExecute(r, t);\r\n        if (t != null) {\r\n            System.err.println("\u6355\u83b7\u5f02\u5e38\uff1a" + t.getMessage());\r\n        }\r\n    }\r\n};\r\n\r\nexecutor.\r\n\r\nexecute(() ->{\r\n        System.out.\r\n\r\nprintln("\u4efb\u52a1\u5f00\u59cb");\r\n\r\nint result = 1 / 0; // \u9664\u96f6\u5f02\u5e38\r\n});\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u2463\u3001\u4f7f\u7528 UncaughtExceptionHandler \u6355\u83b7\u5f02\u5e38\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'ThreadPoolExecutor executor = new ThreadPoolExecutor(2, 2, 0L, TimeUnit.MILLISECONDS,\r\n        new LinkedBlockingQueue<Runnable>());\r\nexecutor.\r\n\r\nsetRejectedExecutionHandler(new ThreadPoolExecutor.AbortPolicy());\r\n        executor.\r\n\r\nsetThreadFactory(new ThreadFactory() {\r\n    @Override\r\n    public Thread newThread (Runnable r){\r\n        Thread thread = new Thread(r);\r\n        thread.setUncaughtExceptionHandler(new Thread.UncaughtExceptionHandler() {\r\n            @Override\r\n            public void uncaughtException(Thread t, Throwable e) {\r\n                System.err.println("\u6355\u83b7\u5f02\u5e38\uff1a" + e.getMessage());\r\n            }\r\n        });\r\n        return thread;\r\n    }\r\n});\r\n\r\n        executor.\r\n\r\nexecute(() ->{\r\n        System.out.\r\n\r\nprintln("\u4efb\u52a1\u5f00\u59cb");\r\n\r\nint result = 1 / 0; // \u9664\u96f6\u5f02\u5e38\r\n});\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u9879\u76ee\u4f7f\u7528 execute()\uff0c\u4e0d\u5173\u5fc3\u4efb\u52a1\u8fd4\u56de\u503c\uff0c\u5efa\u8bae\u4f7f\u7528 UncaughtExceptionHandler\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'thread.setUncaughtExceptionHandler((t, e) ->\r\n        System.err.\r\n\r\nprintln("\u7ebf\u7a0b "+t.getName() +" \u6355\u83b7\u5230\u5f02\u5e38\uff1a"+e.\r\n\r\ngetMessage()));\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u9879\u76ee\u4f7f\u7528 submit()\uff0c\u5173\u5fc3\u4efb\u52a1\u8fd4\u56de\u503c\uff0c\u5efa\u8bae\u4f7f\u7528 Future\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'Future<?> future = executor.submit(task);\r\ntry{\r\n        future.\r\n\r\nget();\r\n}catch(\r\nExecutionException e){\r\n        System.err.\r\n\r\nprintln("\u6355\u83b7\u5f02\u5e38\uff1a"+e.getCause());\r\n        }\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u60f3\u8981\u5168\u5c40\u6355\u83b7\u6240\u6709\u4efb\u52a1\u5f02\u5e38\uff0c\u5efa\u8bae\u91cd\u5199 afterExecute \u65b9\u6cd5\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class MyThreadPoolExecutor extends ThreadPoolExecutor {\r\n    @Override\r\n    protected void afterExecute(Runnable r, Throwable t) {\r\n        if (t == null && r instanceof Future<?>) {\r\n            try {\r\n                ((Future<?>) r).get();\r\n            } catch (Exception e) {\r\n                System.err.println("\u4efb\u52a1\u5f02\u5e38\uff1a" + e.getCause());\r\n            }\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u80fd\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u6709\u51e0\u79cd\u72b6\u6001\u5417",children:"\u80fd\u8bf4\u4e00\u4e0b\u7ebf\u7a0b\u6c60\u6709\u51e0\u79cd\u72b6\u6001\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u6709 5 \u79cd\u72b6\u6001\uff0c\u5b83\u4eec\u7684\u8f6c\u6362\u9075\u5faa\u4e25\u683c\u7684\u72b6\u6001\u6d41\u8f6c\u89c4\u5219\uff0c\u4e0d\u540c\u72b6\u6001\u63a7\u5236\u7740\u7ebf\u7a0b\u6c60\u7684\u4efb\u52a1\u8c03\u5ea6\u548c\u5173\u95ed\u884c\u4e3a\u3002"}),"\n",(0,t.jsxs)(e.p,{children:["\u72b6\u6001\u7531 RUNNING \u2192 SHUTDOWN \u2192 STOP \u2192 TIDYING \u2192 TERMINATED \u4f9d\u6b21\u6d41\u8f6c\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757509064237",src:r(58460).A+"",width:"871",height:"254"}),"\r\nRUNNING \u72b6\u6001\u7684\u7ebf\u7a0b\u6c60\u53ef\u4ee5\u63a5\u6536\u65b0\u4efb\u52a1\uff0c\u5e76\u5904\u7406\u963b\u585e\u961f\u5217\u4e2d\u7684\u4efb\u52a1\uff1bSHUTDOWN \u72b6\u6001\u7684\u7ebf\u7a0b\u6c60\u4e0d\u4f1a\u63a5\u6536\u65b0\u4efb\u52a1\uff0c\u4f46\u4f1a\u5904\u7406\u963b\u585e\u961f\u5217\u4e2d\u7684\u4efb\u52a1\uff1bSTOP\r\n\u72b6\u6001\u7684\u7ebf\u7a0b\u6c60\u4e0d\u4f1a\u63a5\u6536\u65b0\u4efb\u52a1\uff0c\u4e5f\u4e0d\u4f1a\u5904\u7406\u963b\u585e\u961f\u5217\u4e2d\u7684\u4efb\u52a1\uff0c\u5e76\u4e14\u4f1a\u5c1d\u8bd5\u4e2d\u65ad\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1\uff1bTIDYING \u72b6\u6001\u8868\u793a\u6240\u6709\u4efb\u52a1\u5df2\u7ecf\u7ec8\u6b62\uff1bTERMINATED\r\n\u72b6\u6001\u8868\u793a\u7ebf\u7a0b\u6c60\u5b8c\u5168\u5173\u95ed\uff0c\u6240\u6709\u7ebf\u7a0b\u9500\u6bc1\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u72b6\u6001 \u72b6\u6001\u7801 \u662f\u5426\u63a5\u6536\u65b0\u4efb\u52a1 \u662f\u5426\u6267\u884c\u961f\u5217\u4e2d\u7684\u4efb\u52a1 \u662f\u5426\u4e2d\u65ad\u6b63\u5728\u6267\u884c\u7684\u4efb\u52a1\r\nRUNNING 111 \u2705 \u662f \u2705 \u662f \u274c \u5426\r\nSHUTDOWN 000 \u274c \u5426 \u2705 \u662f \u274c \u5426\r\nSTOP 001 \u274c \u5426 \u274c \u5426 \u2705 \u662f\r\nTIDYING 010 \u274c \u5426 \u274c \u5426 \u274c \u5426\r\nTERMINATED 011 \u274c \u5426 \u274c \u5426 \u274c \u5426"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u5982\u4f55\u5b9e\u73b0\u53c2\u6570\u7684\u52a8\u6001\u4fee\u6539",children:"\u7ebf\u7a0b\u6c60\u5982\u4f55\u5b9e\u73b0\u53c2\u6570\u7684\u52a8\u6001\u4fee\u6539\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u6c60\u63d0\u4f9b\u7684 setter \u65b9\u6cd5\u5c31\u53ef\u4ee5\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u4fee\u6539\u53c2\u6570\uff0c\u6bd4\u5982\u8bf4 setCorePoolSize \u53ef\u4ee5\u7528\u6765\u4fee\u6539\u6838\u5fc3\u7ebf\u7a0b\u6570\u3001setMaximumPoolSize\r\n\u53ef\u4ee5\u7528\u6765\u4fee\u6539\u6700\u5927\u7ebf\u7a0b\u6570\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8c03\u7528 setCorePoolSize() \u65f6\u5982\u679c\u65b0\u7684\u6838\u5fc3\u7ebf\u7a0b\u6570\u6bd4\u539f\u6765\u7684\u5927\uff0c\u7ebf\u7a0b\u6c60\u4f1a\u521b\u5efa\u65b0\u7684\u7ebf\u7a0b\uff1b\u5982\u679c\u66f4\u5c0f\uff0c\u7ebf\u7a0b\u6c60\u4e0d\u4f1a\u7acb\u5373\u9500\u6bc1\u591a\u4f59\u7684\u7ebf\u7a0b\uff0c\u9664\u975e\u6709\u7a7a\u95f2\u7ebf\u7a0b\u8d85\u8fc7\r\nkeepAliveTime\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u7136\u4e86\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528 Nacos \u914d\u7f6e\u4e2d\u5fc3\uff0c\u6216\u8005\u5b9e\u73b0\u81ea\u5b9a\u4e49\u7684\u7ebf\u7a0b\u6c60\uff0c\u76d1\u542c\u53c2\u6570\u53d8\u5316\u53bb\u52a8\u6001\u8c03\u6574\u53c2\u6570\u3002"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.img,{alt:"1757509103277",src:r(34488).A+"",width:"931",height:"510"}),"\r\n\u9996\u5148\u6211\u4f1a\u6839\u636e\u4efb\u52a1\u7c7b\u578b\u8bbe\u7f6e\u6838\u5fc3\u7ebf\u7a0b\u6570\u53c2\u6570\uff0c\u6bd4\u5982 IO \u5bc6\u96c6\u578b\u4efb\u52a1\u4f1a\u8bbe\u7f6e\u4e3a CPU \u6838\u5fc3\u6570*2 \u7684\u7ecf\u9a8c\u503c\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u5176\u6b21\u6211\u4f1a\u7ed3\u5408\u7ebf\u7a0b\u6c60\u52a8\u6001\u8c03\u6574\u7684\u80fd\u529b\uff0c\u5728\u6d41\u91cf\u6ce2\u52a8\u65f6\u901a\u8fc7 setCorePoolSize \u5e73\u6ed1\u6269\u5bb9\uff0c\u6216\u8005\u76f4\u63a5\u4f7f\u7528 DynamicTp \u5b9e\u73b0\u7ebf\u7a0b\u6c60\u53c2\u6570\u7684\u81ea\u52a8\u5316\u8c03\u6574\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u6700\u540e\uff0c\u6211\u4f1a\u901a\u8fc7\u5185\u7f6e\u7684\u76d1\u63a7\u6307\u6807\u5efa\u7acb\u5bb9\u91cf\u9884\u8b66\u673a\u5236\u3002\u6bd4\u5982\u901a\u8fc7 JMX \u76d1\u63a7\u7ebf\u7a0b\u6c60\u7684\u8fd0\u884c\u72b6\u6001\uff0c\u8bbe\u7f6e\u9608\u503c\uff0c\u5f53\u7ebf\u7a0b\u6c60\u7684\u4efb\u52a1\u961f\u5217\u957f\u5ea6\u8d85\u8fc7\u9608\u503c\u65f6\uff0c\u89e6\u53d1\u544a\u8b66\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u5728\u4f7f\u7528\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4ec0\u4e48\u8865\u5145",children:"\u7ebf\u7a0b\u6c60\u5728\u4f7f\u7528\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4ec0\u4e48\uff1f\uff08\u8865\u5145\uff09"}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u8ba4\u4e3a\u6709 3 \u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u5173\u6ce8\u70b9\uff1a"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e00\u4e2a\uff0c\u9009\u62e9\u5408\u9002\u7684\u7ebf\u7a0b\u6c60\u5927\u5c0f\u3002\u8fc7\u5c0f\u7684\u7ebf\u7a0b\u6c60\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4efb\u52a1\u4e00\u76f4\u5728\u6392\u961f\uff1b\u8fc7\u5927\u7684\u7ebf\u7a0b\u6c60\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u5bb6\u90fd\u5728\u7ade\u4e89 CPU \u8d44\u6e90\uff0c\u589e\u52a0\u4e0a\u4e0b\u6587\u5207\u6362\u7684\u5f00\u9500"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e8c\u4e2a\uff0c\u9009\u62e9\u5408\u9002\u7684\u4efb\u52a1\u961f\u5217\u3002\u4f7f\u7528\u6709\u754c\u961f\u5217\u53ef\u4ee5\u907f\u514d\u8d44\u6e90\u8017\u5c3d\u7684\u98ce\u9669\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4efb\u52a1\u88ab\u62d2\u7edd\uff1b\u4f7f\u7528\u65e0\u754c\u961f\u5217\u867d\u7136\u53ef\u4ee5\u907f\u514d\u4efb\u52a1\u88ab\u62d2\u7edd\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5185\u5b58\u8017\u5c3d"}),"\n",(0,t.jsx)(e.p,{children:"\u6bd4\u5982\u5728\u4f7f\u7528 LinkedBlockingQueue \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f20\u5165\u53c2\u6570\u6765\u9650\u5236\u961f\u5217\u4e2d\u4efb\u52a1\u7684\u6570\u91cf\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u51fa\u73b0 OOM\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e09\u4e2a\uff0c\u5c3d\u91cf\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u7ebf\u7a0b\u6c60\uff0c\u800c\u4e0d\u662f\u4f7f\u7528 Executors \u521b\u5efa\u7684\u7ebf\u7a0b\u6c60\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u56e0\u4e3a newFixedThreadPool \u7ebf\u7a0b\u6c60\u7531\u4e8e\u4f7f\u7528\u4e86 LinkedBlockingQueue\uff0c\u961f\u5217\u7684\u5bb9\u91cf\u9ed8\u8ba4\u65e0\u9650\u5927\uff0c\u4efb\u52a1\u8fc7\u591a\u65f6\u4f1a\u5bfc\u81f4\u5185\u5b58\u6ea2\u51fa\uff1bnewCachedThreadPool\r\n\u7ebf\u7a0b\u6c60\u7531\u4e8e\u6838\u5fc3\u7ebf\u7a0b\u6570\u65e0\u9650\u5927\uff0c\u5f53\u4efb\u52a1\u8fc7\u591a\u7684\u65f6\u5019\u4f1a\u5bfc\u81f4\u521b\u5efa\u5927\u91cf\u7684\u7ebf\u7a0b\uff0c\u5bfc\u81f4\u670d\u52a1\u5668\u8d1f\u8f7d\u8fc7\u9ad8\u5b95\u673a\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u4f60\u80fd\u8bbe\u8ba1\u5b9e\u73b0\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u5417",children:"\ud83c\udf1f\u4f60\u80fd\u8bbe\u8ba1\u5b9e\u73b0\u4e00\u4e2a\u7ebf\u7a0b\u6c60\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u63a8\u8350\u9605\u8bfb\uff1a\u4e09\u5206\u6076\u7ebf\u7a0b\u6c60\u539f\u7406\r\n\u7ebf\u7a0b\u6c60\u7684\u4e3b\u8981\u76ee\u7684\u662f\u4e3a\u4e86\u907f\u514d\u9891\u7e41\u5730\u521b\u5efa\u548c\u9500\u6bc1\u7ebf\u7a0b\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757509169258",src:r(98825).A+"",width:"802",height:"374"}),"\r\n\u6211\u4f1a\u628a\u7ebf\u7a0b\u6c60\u770b\u4f5c\u4e00\u4e2a\u5de5\u5382\uff0c\u91cc\u9762\u6709\u4e00\u7fa4\u201c\u5de5\u4eba\u201d\uff0c\u4e5f\u5c31\u662f\u7ebf\u7a0b\u4e86\uff0c\u4e13\u95e8\u7528\u6765\u505a\u4efb\u52a1\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u5f53\u4efb\u52a1\u6765\u4e86\uff0c\u9700\u8981\u5148\u5224\u65ad\u6709\u6ca1\u6709\u7a7a\u95f2\u7684\u5de5\u4eba\uff0c\u5982\u679c\u6709\u5c31\u628a\u4efb\u52a1\u4ea4\u7ed9\u4ed6\u4eec\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u5c31\u628a\u4efb\u52a1\u6682\u5b58\u5230\u4e00\u4e2a\u4efb\u52a1\u961f\u5217\u91cc\uff0c\u7b49\u5de5\u4eba\u5fd9\u5b8c\u4e86\u518d\u53bb\u5904\u7406\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u961f\u5217\u6ee1\u4e86\uff0c\u8fd8\u6ca1\u6709\u7a7a\u95f2\u7684\u5de5\u4eba\uff0c\u5c31\u8981\u8003\u8651\u6269\u5bb9\uff0c\u8ba9\u9884\u5907\u7684\u5de5\u4eba\u8fc7\u6765\u5e72\u6d3b\uff0c\u4f46\u4e0d\u80fd\u8d85\u8fc7\u9884\u5b9a\u7684\u6700\u5927\u503c\uff0c\u9632\u6b62\u5de5\u5382\u88ab\u6324\u7206\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5982\u679c\u8fde\u6269\u5bb9\u4e5f\u6ca1\u6cd5\u89e3\u51b3\uff0c\u5c31\u9700\u8981\u4e00\u4e2a\u62d2\u7edd\u7b56\u7565\uff0c\u53ef\u80fd\u76f4\u63a5\u62d2\u7edd\u4efb\u52a1\u6216\u8005\u62a5\u4e2a\u9519\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u6838\u5fc3\u7ebf\u7a0b\u6c60\u7c7b\uff08\u53ef\u53c2\u8003\uff09\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class CustomThreadPoolExecutor {\r\n\r\n    private final int corePoolSize;\r\n    private final int maximumPoolSize;\r\n    private final long keepAliveTime;\r\n    private final TimeUnit unit;\r\n    private final BlockingQueue<Runnable> workQueue;\r\n    private final RejectedExecutionHandler handler;\r\n\r\n    private volatile boolean isShutdown = false;\r\n    private int currentPoolSize = 0;\r\n\r\n    // \u6784\u9020\u65b9\u6cd5\r\n    public CustomThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit,\r\n                                    BlockingQueue<Runnable> workQueue, RejectedExecutionHandler handler) {\r\n        this.corePoolSize = corePoolSize;\r\n        this.maximumPoolSize = maximumPoolSize;\r\n        this.keepAliveTime = keepAliveTime;\r\n        this.unit = unit;\r\n        this.workQueue = workQueue;\r\n        this.handler = handler;\r\n    }\r\n\r\n    // \u63d0\u4ea4\u4efb\u52a1\r\n    public void execute(Runnable task) {\r\n        if (isShutdown) {\r\n            throw new IllegalStateException("ThreadPool is shutdown");\r\n        }\r\n\r\n        synchronized (this) {\r\n            // \u5982\u679c\u5f53\u524d\u7ebf\u7a0b\u6570\u5c0f\u4e8e\u6838\u5fc3\u7ebf\u7a0b\u6570\uff0c\u76f4\u63a5\u521b\u5efa\u65b0\u7ebf\u7a0b\r\n            if (currentPoolSize < corePoolSize) {\r\n                new Worker(task).start();\r\n                currentPoolSize++;\r\n                return;\r\n            }\r\n\r\n            // \u5c1d\u8bd5\u5c06\u4efb\u52a1\u6dfb\u52a0\u5230\u961f\u5217\u4e2d\r\n            if (!workQueue.offer(task)) {\r\n                if (currentPoolSize < maximumPoolSize) {\r\n                    new Worker(task).start();\r\n                    currentPoolSize++;\r\n                } else {\r\n                    // \u8c03\u7528\u62d2\u7edd\u7b56\u7565\r\n                    handler.rejectedExecution(task, null);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // \u5173\u95ed\u7ebf\u7a0b\u6c60\r\n    public void shutdown() {\r\n        isShutdown = true;\r\n    }\r\n\r\n    // \u5de5\u4f5c\u7ebf\u7a0b\r\n    private class Worker extends Thread {\r\n        private Runnable task;\r\n\r\n        Worker(Runnable task) {\r\n            this.task = task;\r\n        }\r\n\r\n        @Override\r\n        public void run() {\r\n            while (task != null || (task = getTask()) != null) {\r\n                try {\r\n                    task.run();\r\n                } finally {\r\n                    task = null;\r\n                }\r\n            }\r\n        }\r\n\r\n        // \u4ece\u961f\u5217\u4e2d\u83b7\u53d6\u4efb\u52a1\r\n        private Runnable getTask() {\r\n            try {\r\n                return workQueue.poll(keepAliveTime, unit);\r\n            } catch (InterruptedException e) {\r\n                return null;\r\n            }\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u62d2\u7edd\u7b56\u7565\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'/**\r\n * \u62d2\u7edd\u7b56\u7565\r\n */\r\nclass CustomRejectedExecutionHandler {\r\n\r\n    // AbortPolicy \u629b\u51fa\u5f02\u5e38\r\n    public static class AbortPolicy implements RejectedExecutionHandler {\r\n        public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\r\n            throw new RuntimeException("Task " + r.toString() + " rejected from " + e.toString());\r\n        }\r\n    }\r\n\r\n    // DiscardPolicy \u4ec0\u4e48\u90fd\u4e0d\u505a\r\n    public static class DiscardPolicy implements RejectedExecutionHandler {\r\n        public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\r\n            // Do nothing\r\n        }\r\n    }\r\n\r\n    // DiscardOldestPolicy \u4e22\u5f03\u961f\u5217\u4e2d\u6700\u65e7\u7684\u4efb\u52a1\r\n    public static class CallerRunsPolicy implements RejectedExecutionHandler {\r\n        public void rejectedExecution(Runnable r, ThreadPoolExecutor e) {\r\n            if (!e.isShutdown()) {\r\n                r.run();\r\n            }\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"\u4f7f\u7528\u793a\u4f8b\uff1a"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ThreadPoolTest {\r\n    public static void main(String[] args) {\r\n        // \u521b\u5efa\u7ebf\u7a0b\u6c60\r\n        CustomThreadPoolExecutor executor = new CustomThreadPoolExecutor(\r\n                2, 4, 10, TimeUnit.SECONDS,\r\n                new LinkedBlockingQueue<>(2),\r\n                new CustomRejectedExecutionHandler.AbortPolicy());\r\n\r\n        // \u63d0\u4ea4\u4efb\u52a1\r\n        for (int i = 0; i < 10; i++) {\r\n            final int index = i;\r\n            executor.execute(() -> {\r\n                System.out.println("Task " + index + " is running");\r\n                try {\r\n                    Thread.sleep(2000);\r\n                } catch (InterruptedException e) {\r\n                    e.printStackTrace();\r\n                }\r\n            });\r\n        }\r\n\r\n        // \u5173\u95ed\u7ebf\u7a0b\u6c60\r\n        executor.shutdown();\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u624b\u5199\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u53ef\u4ee5\u5417",children:"\u624b\u5199\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u53ef\u4ee5\u5417\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u53ef\u4ee5\u7684\uff0c\u6211\u7684\u601d\u8def\u662f\u8fd9\u6837\u7684\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4e3b\u8981\u662f\u4e3a\u4e86\u907f\u514d\u6bcf\u6b21\u64cd\u4f5c\u6570\u636e\u5e93\u65f6\u90fd\u53bb\u521b\u5efa\u8fde\u63a5\uff0c\u56e0\u4e3a\u90a3\u6837\u5f88\u6d6a\u8d39\u8d44\u6e90\u3002\u6240\u4ee5\u6211\u6253\u7b97\u5728\u521d\u59cb\u5316\u65f6\u9884\u5148\u521b\u5efa\u597d\u56fa\u5b9a\u6570\u91cf\u7684\u8fde\u63a5\uff0c\u7136\u540e\u628a\u5b83\u4eec\u653e\u5230\u4e00\u4e2a\u7ebf\u7a0b\u5b89\u5168\u7684\u5bb9\u5668\u91cc\uff0c\u540e\u7eed\u6709\u8bf7\u6c42\u7684\u65f6\u5019\u5c31\u4ece\u961f\u5217\u91cc\u62ff\uff0c\u4f7f\u7528\u5b8c\u540e\u518d\u5f52\u8fd8\u5230\u961f\u5217\u4e2d\u3002"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class SimpleConnectionPool {\r\n    // \u914d\u7f6e\r\n    private String jdbcUrl;\r\n    private String username;\r\n    private String password;\r\n    private int maxConnections;\r\n    private BlockingQueue<Connection> connectionPool;\r\n\r\n    // \u6784\u9020\u65b9\u6cd5\r\n    public SimpleConnectionPool(String jdbcUrl, String username, String password, int maxConnections) throws SQLException {\r\n        this.jdbcUrl = jdbcUrl;\r\n        this.username = username;\r\n        this.password = password;\r\n        this.maxConnections = maxConnections;\r\n        this.connectionPool = new LinkedBlockingQueue<>(maxConnections);\r\n\r\n        // \u521d\u59cb\u5316\u8fde\u63a5\u6c60\r\n        for (int i = 0; i < maxConnections; i++) {\r\n            connectionPool.add(createNewConnection());\r\n        }\r\n    }\r\n\r\n    // \u521b\u5efa\u65b0\u8fde\u63a5\r\n    private Connection createNewConnection() throws SQLException {\r\n        return DriverManager.getConnection(jdbcUrl, username, password);\r\n    }\r\n\r\n    // \u83b7\u53d6\u8fde\u63a5\r\n    public Connection getConnection(long timeout, TimeUnit unit) throws InterruptedException, SQLException {\r\n        Connection connection = connectionPool.poll(timeout, unit); // \u7b49\u5f85\u6307\u5b9a\u65f6\u95f4\u83b7\u53d6\u8fde\u63a5\r\n        if (connection == null) {\r\n            throw new SQLException("Timeout: Unable to acquire a connection.");\r\n        }\r\n        return connection;\r\n    }\r\n\r\n    // \u5f52\u8fd8\u8fde\u63a5\r\n    public void releaseConnection(Connection connection) throws SQLException {\r\n        if (connection != null) {\r\n            if (connection.isClosed()) {\r\n                // \u5982\u679c\u8fde\u63a5\u5df2\u5173\u95ed\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u8fde\u63a5\u8865\u5145\u5230\u6c60\u4e2d\r\n                connectionPool.add(createNewConnection());\r\n            } else {\r\n                // \u5c06\u8fde\u63a5\u5f52\u8fd8\u5230\u6c60\u4e2d\r\n                connectionPool.offer(connection);\r\n            }\r\n        }\r\n    }\r\n\r\n    // \u5173\u95ed\u6240\u6709\u8fde\u63a5\r\n    public void closeAllConnections() throws SQLException {\r\n        for (Connection connection : connectionPool) {\r\n            if (!connection.isClosed()) {\r\n                connection.close();\r\n            }\r\n        }\r\n    }\r\n\r\n    // \u6d4b\u8bd5\u7528\u4f8b\r\n    public static void main(String[] args) {\r\n        try {\r\n            SimpleConnectionPool pool = new SimpleConnectionPool(\r\n                    "jdbc:mysql://localhost:3306/pai_coding", "root", "", 5\r\n            );\r\n\r\n            // \u83b7\u53d6\u8fde\u63a5\r\n            Connection conn = pool.getConnection(5, TimeUnit.SECONDS);\r\n\r\n            // \u4f7f\u7528\u8fde\u63a5\uff08\u793a\u4f8b\u67e5\u8be2\uff09\r\n            System.out.println("Connection acquired: " + conn);\r\n            Thread.sleep(2000); // \u6a21\u62df\u67e5\u8be2\r\n\r\n            // \u5f52\u8fd8\u8fde\u63a5\r\n            pool.releaseConnection(conn);\r\n            System.out.println("Connection returned.");\r\n\r\n            // \u5173\u95ed\u6240\u6709\u8fde\u63a5\r\n            pool.closeAllConnections();\r\n        } catch (Exception e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n}\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u7ebf\u7a0b\u6c60\u6267\u884c\u4e2d\u65ad\u7535\u4e86\u5e94\u8be5\u600e\u4e48\u5904\u7406",children:"\u7ebf\u7a0b\u6c60\u6267\u884c\u4e2d\u65ad\u7535\u4e86\u5e94\u8be5\u600e\u4e48\u5904\u7406\uff1f"}),"\n",(0,t.jsx)(e.p,{children:"\u7ebf\u7a0b\u6c60\u672c\u8eab\u53ea\u80fd\u5728\u5185\u5b58\u4e2d\u8fdb\u884c\u4efb\u52a1\u8c03\u5ea6\uff0c\u5e76\u4e0d\u4f1a\u6301\u4e45\u5316\uff0c\u4e00\u65e6\u65ad\u7535\uff0c\u7ebf\u7a0b\u6c60\u91cc\u7684\u6240\u6709\u4efb\u52a1\u548c\u72b6\u6001\u90fd\u4f1a\u4e22\u5931\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u6211\u4f1a\u8003\u8651\u4ee5\u4e0b\u51e0\u4e2a\u65b9\u9762\uff1a"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e00\uff0c\u6301\u4e45\u5316\u4efb\u52a1\u3002\u53ef\u4ee5\u5c06\u4efb\u52a1\u6301\u4e45\u5316\u5230\u6570\u636e\u5e93\u6216\u8005\u6d88\u606f\u961f\u5217\u4e2d\uff0c\u7b49\u7535\u6062\u590d\u540e\u518d\u91cd\u65b0\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e8c\uff0c\u4efb\u52a1\u5e42\u7b49\u6027\uff0c\u9700\u8981\u4fdd\u8bc1\u4efb\u52a1\u662f\u5e42\u7b49\u7684\uff0c\u4e5f\u5c31\u662f\u65e0\u8bba\u6267\u884c\u591a\u5c11\u6b21\uff0c\u7ed3\u679c\u90fd\u4e00\u81f4\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u7b2c\u4e09\uff0c\u6062\u590d\u7b56\u7565\u3002\u5f53\u7cfb\u7edf\u91cd\u542f\u65f6\uff0c\u5e94\u8be5\u6709\u4e00\u4e2a\u6062\u590d\u6d41\u7a0b\uff1a\u68c0\u6d4b\u4e0a\u6b21\u662f\u5426\u6709\u672a\u5b8c\u6210\u7684\u4efb\u52a1\uff0c\u5c06\u8fd9\u4e9b\u4efb\u52a1\u91cd\u65b0\u52a0\u8f7d\u5230\u7ebf\u7a0b\u6c60\u4e2d\u6267\u884c\uff0c\u786e\u4fdd\u65ad\u7535\u524d\u7684\u5de5\u4f5c\u80fd\u591f\u6062\u590d\u3002"}),"\n",(0,t.jsx)(e.h2,{id:"\u5e76\u53d1\u5bb9\u5668\u548c\u6846\u67b6",children:"\u5e76\u53d1\u5bb9\u5668\u548c\u6846\u67b6"}),"\n",(0,t.jsx)(e.h3,{id:"forkjoin-\u6846\u67b6\u4e86\u89e3\u5417",children:"Fork/Join \u6846\u67b6\u4e86\u89e3\u5417\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:["\u5173\u4e8e Fork/Join \u6846\u67b6\uff0c\u6211\u4e86\u89e3\u4e00\u4e9b\uff0c\u5b83\u662f Java 7 \u5f15\u5165\u7684\u4e00\u4e2a\u5e76\u884c\u6846\u67b6\uff0c\u4e3b\u8981\u7528\u4e8e\u5206\u6cbb\u7b97\u6cd5\u7684\u5e76\u884c\u6267\u884c\u3002\u8fd9\u4e2a\u6846\u67b6\u901a\u8fc7\u5c06\u5927\u7684\u4efb\u52a1\u9012\u5f52\u5730\u5206\u89e3\u6210\u5c0f\u4efb\u52a1\uff0c\u7136\u540e\u5e76\u884c\u6267\u884c\uff0c\u6700\u540e\u518d\u5408\u5e76\u7ed3\u679c\uff0c\u4ee5\u8fbe\u5230\u6700\u9ad8\u6548\u7387\u5904\u7406\u5927\u91cf\u6570\u636e\u7684\u76ee\u7684\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757509270782",src:r(38370).A+"",width:"923",height:"764"}),"\r\nFork/Join \u6846\u67b6\u7684\u6838\u5fc3\u7406\u5ff5\u662f\u5206\u800c\u6cbb\u4e4b\uff0c\u5c06\u5927\u4efb\u52a1\u62c6\u5206\u4e3a\u591a\u4e2a\u5c0f\u4efb\u52a1\u5e76\u884c\u5904\u7406\uff0c\u6700\u540e\u518d\u5c06\u8fd9\u4e9b\u5c0f\u4efb\u52a1\u7684\u7ed3\u679c\u6c47\u603b\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u5c31\u50cf\u662f\u4e00\u4e2a\u6811\u5f62\u7ed3\u6784\uff0c\u6839\u8282\u70b9\u662f\u4e00\u4e2a\u5927\u7684\u4efb\u52a1\uff0c\u53f6\u5b50\u8282\u70b9\u662f\u6700\u5c0f\u7684\u5b50\u4efb\u52a1\uff0c\u6bcf\u4e2a\u4efb\u52a1\u90fd\u53ef\u80fd\u4f1a\u88ab\u5206\u88c2\u6210\u66f4\u5c0f\u7684\u5b50\u4efb\u52a1\uff0c\u76f4\u5230\u8fbe\u5230\u67d0\u4e2a\u4e34\u754c\u70b9\uff0c\u4efb\u52a1\u518d\u9010\u4e2a\u6267\u884c\u3002"}),"\n",(0,t.jsx)(e.p,{children:"\u5177\u4f53\u6765\u8bf4\uff0cFork/Join \u5305\u62ec\u4e24\u4e2a\u4e3b\u8981\u7684\u7c7b\uff1a"}),"\n",(0,t.jsxs)(e.p,{children:["ForkJoinPool\uff0c\u4e00\u4e2a\u7279\u6b8a\u7684\u7ebf\u7a0b\u6c60\uff0c\u5e95\u5c42\u4f7f\u7528\u4e86\u5de5\u4f5c\u7a83\u53d6\u7b97\u6cd5\uff0c\u4e5f\u5c31\u662f\u5f53\u4e00\u4e2a\u7ebf\u7a0b\u6267\u884c\u5b8c\u81ea\u5df1\u7684\u4efb\u52a1\u540e\uff0c\u5b83\u53ef\u4ee5\u7a83\u53d6\u5176\u4ed6\u7ebf\u7a0b\u7684\u4efb\u52a1\uff0c\u907f\u514d\u7ebf\u7a0b\u95f2\u7f6e\u3002\r\n",(0,t.jsx)(e.img,{alt:"1757509287711",src:r(73752).A+"",width:"753",height:"386"}),"\r\nRecursiveTask \u548c RecursiveAction\uff0c\u5206\u522b\u7528\u4e8e\u6709\u8fd4\u56de\u503c\u548c\u65e0\u8fd4\u56de\u503c\u7684\u4efb\u52a1\uff0c\u8fd9\u4e24\u4e2a\u7c7b\u90fd\u7ee7\u627f\u81ea ForkJoinTask\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-java",children:'class ForkJoinExample {\r\n    public static void main(String[] args) {\r\n        int[] arr = new int[100];\r\n        for (int i = 0; i < 100; i++) {\r\n            arr[i] = i + 1; // \u586b\u5145\u6570\u636e 1 \u5230 100\r\n        }\r\n\r\n        // \u521b\u5efa ForkJoinPool\uff0c\u9ed8\u8ba4\u4f7f\u7528\u53ef\u7528\u7684\u5904\u7406\u5668\u6838\u5fc3\u6570\r\n        ForkJoinPool pool = new ForkJoinPool();\r\n\r\n        // \u521b\u5efa ForkJoin \u4efb\u52a1\r\n        SumTask task = new SumTask(arr, 0, arr.length);\r\n\r\n        // \u6267\u884c\u4efb\u52a1\r\n        Integer result = pool.invoke(task);\r\n\r\n        System.out.println("\u6570\u7ec4\u7684\u548c\u662f: " + result);\r\n    }\r\n\r\n    // \u81ea\u5b9a\u4e49\u4efb\u52a1\uff0c\u7ee7\u627f RecursiveTask\r\n    static class SumTask extends RecursiveTask<Integer> {\r\n        private int[] arr;\r\n        private int start;\r\n        private int end;\r\n\r\n        public SumTask(int[] arr, int start, int end) {\r\n            this.arr = arr;\r\n            this.start = start;\r\n            this.end = end;\r\n        }\r\n\r\n        @Override\r\n        protected Integer compute() {\r\n            if (end - start <= 10) {  // \u5982\u679c\u4efb\u52a1\u8db3\u591f\u5c0f\uff0c\u5c31\u76f4\u63a5\u8ba1\u7b97\r\n                int sum = 0;\r\n                for (int i = start; i < end; i++) {\r\n                    sum += arr[i];\r\n                }\r\n                return sum;\r\n            } else {\r\n                // \u5426\u5219\u62c6\u5206\u4efb\u52a1\r\n                int mid = (start + end) / 2;\r\n                SumTask left = new SumTask(arr, start, mid);\r\n                SumTask right = new SumTask(arr, mid, end);\r\n\r\n                // \u5206\u522b\u6267\u884c\u5b50\u4efb\u52a1\r\n                left.fork();\r\n                right.fork();\r\n\r\n                // \u5408\u5e76\u7ed3\u679c\r\n                int leftResult = left.join();\r\n                int rightResult = right.join();\r\n\r\n                return leftResult + rightResult;  // \u6c47\u603b\u7ed3\u679c\r\n            }\r\n        }\r\n    }\r\n}\n'})})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(o,{...n})}):o(n)}},3489:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/img_7-9f973d5df0dea48e99487623793442be.png"},4503:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/img_1-537cb7198f2d4929095428496a1d59ae.png"},4926:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/AQS\u7684hasQueuedPredecessors-81782203ef763b7a60f40d1e7b2e92e4.png"},5181:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u72b6\u6001-85493ffcb151a9831453644a4285f694.png"},5575:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/CAS\u4e09\u5927\u95ee\u9898-9c549859e2a192844914eab99c9fa70a.png"},7441:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508244127-34f50b57f14324aa041b934ef8f765f9.png"},8378:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/CAS\u539f\u7406-9cf17f1efbe4034f6225b1a34732d4c6.png"},12485:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/Exchanger-8cc15ff3c17943400be727b86e4bed38.png"},14546:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u6b7b\u9501-fe03af14261a22cf7adad9e4fc8056be.png"},15121:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508211789-c68ec93ddf035de1f1319f52f9f0a216.png"},15787:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/JAVA7\u7684ConcurrentHashMap\u5b89\u5168\u5b9e\u73b0-16d43cf6d3bc0830271b849e99ea8f4b.png"},18699:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u542f\u52a8\u7ebf\u7a0b-d6093790d1bf49c67e89618c1120a550.png"},19890:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u548c\u8fdb\u7a0b-39faec3e36f8e547e402d25576e45c76.png"},21716:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508903269-1819a226d59956ab088e05a5042396ac.png"},23067:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocal-191479ff3e6e7b81fd2713d2298aea69.png"},24375:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocalMap\u6269\u5bb9-be5b4b0516be296811c32c362191609e.png"},24980:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/JAVA8\u7684ConcurrentHashMap\u5b89\u5168\u5b9e\u73b0-02fb5bc6f5e4126630ef5db8771ffc5a.png"},25878:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/AQS\u7684\u62bd\u8c61\u540c\u6b65\u961f\u5217-f40829bf919d3888c3a418765c3233e0.png"},26255:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/volatile\u4fdd\u8bc1\u53ef\u89c1\u6027-c14d58c68e9c7ba11db2d3af83757918.png"},26712:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u539f\u5b50\u6027-22462c8134d95b26f1112fa153b67478.png"},26898:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocal\u5bf9\u8c61\u5f15\u7528-539f99a2fd5f0c2f32a9d51d964a425c.png"},27523:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u53ef\u89c1\u6027-ffe78e6b69d8982bf46b0850ff454ce8.png"},28453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>c});var a=r(96540);const t={},i=a.createContext(t);function l(n){const e=a.useContext(i);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:l(n.components),a.createElement(i.Provider,{value:e},n.children)}},30142:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508753691-a47811b9878adec1f4a53dd02c183870.png"},31901:(n,e,r)=>{r.d(e,{A:()=>a});const a="data:image/png;base64,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"},32065:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/CAS\u6d41\u7a0b-df450a4600529a4031f79ca1e0f92edc.png"},32328:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocal\u539f\u7406-eec8dff33ffae48592769c1a1f8362dd.png"},32837:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/img_3-cf985eebd54a654b7fdbb6034451b476.png"},34488:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757509103277-beca0db2bb21e1f20f6bbe314de83df7.png"},35227:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/CountDownLatch\u7b49\u5f85-9936ea072d73aeb691b272f37708bb55.png"},36633:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u4fe1\u53f7\u91cf-246d804f38e1ab828a282ad80e239288.png"},37021:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ReentrantLock\u81ea\u65cb-890b0ff3925f458e40886160113b741a.png"},38370:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757509270782-2dd1319072ae7d0020960edd844cbdc5.png"},40659:(n,e,r)=>{r.d(e,{A:()=>a});const a="data:image/png;base64,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"},41647:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508709796-7388288c92f001818f99309c3525544c.png"},43088:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocalMap\u7ed3\u6784-c83bc6609105c0c47b5344e499069009.png"},47461:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ConcurrentHashMap\u5206\u6bb5\u9501-307733badc8eb239df85b0abe6f4d1bc.png"},51833:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u6c60\u6267\u884c\u6d41\u7a0b-032bb1a523d0c5b400801c0260fe4924.png"},55659:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ConcurrentHashMap\u7684put\u6e90\u7801-e462be284f1c49224d8ab16cf4bb1c5a.png"},56928:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u5b9e\u73b0\u540c\u6b65\u548c\u4e92\u65a5-f681ddd79c8d2c554973f4c91f238fb1.png"},57178:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508789454-b43c6a929b23b58864dde4486b04bfa1.png"},58460:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757509064237-999235f73a5043712550b2dfc88a8887.png"},61205:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/volatile\u52a0\u5165\u5c4f\u969c\u6307\u4ee4-fb02ff1e8cc9c16cbffa2e68e2043caa.png"},61746:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u6c60\u53c2\u6570-d81bffdae099c3cdf0bcd2b4d10f1eca.png"},62558:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocal\u7ed3\u6784-762d09a544dc33de43d2cfcd472c2bc8.png"},62840:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u5171\u4eab\u5185\u5b58\u901a\u4fe1-941c15c9a0f467f8e5232fb366bf1d54.png"},65849:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/java\u4e2d\u8fd0\u884c\u7684\u7ebf\u7a0b-1f605bc38eaa8d78151572694347e369.png"},69826:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/JAVA7-ConcurrentHashMap\u7684put\u6d41\u7a0b-d960bd9af7bb4af8cd1d80c2f791cb5d.png"},70172:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/CyclicBarrier\u6d41\u7a0b-077e39524694f8bed12e210ff880264c.png"},73094:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/AQS\u7ed3\u6784-c7138e63792975fd0efaad907d4a9599.png"},73097:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ConcurrentHashMap\u7684get\u6d41\u7a0b-3d727c3cc5ff6e067026f23f9b032f91.png"},73752:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757509287711-548efc6b77257517b1a924c37e36169b.png"},74154:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u539f\u5b50\u6027\u7684\u65b9\u6cd5-a661315f85817a91d126a6f534aca115.png"},76663:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/JAVA\u5185\u5b58\u6a21\u578b-711ff811ebb73ec816748c3476c3a602.png"},77052:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u6307\u4ee4\u91cd\u6392-978bd555543a68ccf2ce9c8bfefbb57d.png"},77767:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u5355\u4f8b\u6076\u6c49\u6307\u5b9a\u91cd\u6392\u53ef\u80fd\u5b58\u5728\u95ee\u9898-87dfa5c0aaecc772537085d93d63fffc.png"},80572:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/img_2-caf2ce0f1c5405124c69f2369c2f078e.png"},81914:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/volatile\u4fee\u9970\u53d8\u91cf\u591a\u7ebf\u7a0b\u4fee\u6539-55447d7a7d019ba2e041a459ce39eaa5.png"},82137:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u5f00\u653e\u5730\u5740\u6cd5-36eabe92de0c29523deffd2cb1629ce6.png"},84881:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/AQS\u7684\u62bd\u8c61\u540c\u6b65\u961f\u5217\u5c3e\u90e8\u81ea\u65cb-572919830bfc251ec31824df2e8b9a1e.png"},87694:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u539f\u5b50\u7c7b-a4f6b48e9c9b6c324955718419747420.png"},88255:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/CopyOnWriteArrayList\u539f\u7406-86e747b2e1ee42b8cd0234b68a9b7ac8.png"},90121:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocalMap-6b4e3231106482132b5cdaa9e7be4627.png"},91974:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/img_8-d63c32e2c1ae2825d1a3597199ee49e8.png"},93780:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508821932-f6bd6cff84557a2b3f47733b36037afb.png"},93850:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ThreadLocalMap\u5783\u573e\u56de\u6536-e635f83faa9626687e8426158dfc3660.png"},94329:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/\u7ebf\u7a0b\u901a\u4fe1-7dfcde8ccba7ea5623ca9b54bcd6d9a7.png"},94721:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/JAVA8-ConcurrentHashMap\u7684put\u6d41\u7a0b-3791fac23d09e6961184bdb01e2afa08.png"},94839:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757508933258-d4028aea6836367b1750b549a131cc6d.png"},95534:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/expungeStaleEntry\u4ee3\u7801\u89e3\u6790-5d0bac9505f540bceb438113b20b7364.png"},95802:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/jvm\u6808\u5185\u5b58\u5927\u5c0f\u8bbe\u7f6e-dd0d764a3d1589398539be91b286e8d6.png"},96586:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ConcurrentHashMap\u8282\u70b9\u8f6c\u7ea2\u9ed1\u6811-cc65e960ef2dd4c1d4af6fde43aa76eb.png"},98203:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/ReentrantLock\u539f\u7406-5fbe7e8181be6399df2720ae6e918294.png"},98825:(n,e,r)=>{r.d(e,{A:()=>a});const a=r.p+"assets/images/1757509169258-7ed1b77b4168a1ea43270ce899fc8c8a.png"}}]);